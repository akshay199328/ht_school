!function(e){var t={};function a(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(s,n,function(t){return e[t]}.bind(null,n));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=21)}([function(e,t,a){e.exports=function(){"use strict";(function(){for(var e=0,t=["ms","moz","webkit","o"],a=0;a<t.length&&!window.requestAnimationFrame;++a)window.requestAnimationFrame=window[t[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[a]+"CancelAnimationFrame"]||window[t[a]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,a){var s=(new Date).getTime(),n=Math.max(0,16-(s-e)),i=window.setTimeout((function(){t(s+n)}),n);return e=s+n,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})})(),function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),a}e.prototype=window.Event.prototype,window.CustomEvent=e}(),function(e){try{return new CustomEvent("test"),!1}catch(e){}function t(t,a){a=a||{bubbles:!1,cancelable:!1};var s=document.createEvent("MouseEvent");return s.initMouseEvent(t,a.bubbles,a.cancelable,e,0,0,0,0,0,!1,!1,!1,!1,0,null),s}t.prototype=Event.prototype,e.MouseEvent=t}(window);var e=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),a=function e(t,a,s){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,a);if(void 0===n){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,a,s)}if("value"in n)return n.value;var o=n.get;return void 0!==o?o.call(s):void 0},s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],s=!0,n=!1,i=void 0;try{for(var o,r=e[Symbol.iterator]();!(s=(o=r.next()).done)&&(a.push(o.value),!t||a.length!==t);s=!0);}catch(e){n=!0,i=e}finally{try{!s&&r.return&&r.return()}finally{if(n)throw i}}return a}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function t(a,s,n,i){e(this,t);var o=this;function r(e){e.stopPropagation(),document.removeEventListener("mouseup",r),document.removeEventListener("mousemove",l),o.eventBus.dispatchEvent(new CustomEvent("handleend",{detail:{handle:o}}))}function l(e){e.stopPropagation(),o.eventBus.dispatchEvent(new CustomEvent("handlemove",{detail:{mouseX:e.clientX,mouseY:e.clientY}}))}this.position=a,this.constraints=s,this.cursor=n,this.eventBus=i,this.el=document.createElement("div"),this.el.className="croppr-handle",this.el.style.cursor=n,this.el.addEventListener("mousedown",(function(e){e.stopPropagation(),document.addEventListener("mouseup",r),document.addEventListener("mousemove",l),o.eventBus.dispatchEvent(new CustomEvent("handlestart",{detail:{handle:o}}))}))},o=function(){function a(t,s,n,i){e(this,a),this.x1=t,this.y1=s,this.x2=n,this.y2=i}return t(a,[{key:"set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return this.x1=null==e?this.x1:e,this.y1=null==t?this.y1:t,this.x2=null==a?this.x2:a,this.y2=null==s?this.y2:s,this}},{key:"width",value:function(){return Math.abs(this.x2-this.x1)}},{key:"height",value:function(){return Math.abs(this.y2-this.y1)}},{key:"resize",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],s=this.x1+this.width()*a[0],n=this.y1+this.height()*a[1];return this.x1=s-e*a[0],this.y1=n-t*a[1],this.x2=this.x1+e,this.y2=this.y1+t,this}},{key:"scale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],a=this.width()*e,s=this.height()*e;return this.resize(a,s,t),this}},{key:"move",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this.width(),s=this.height();return e=null===e?this.x1:e,t=null===t?this.y1:t,this.x1=e,this.y1=t,this.x2=e+a,this.y2=t+s,this}},{key:"getRelativePoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0],t=this.width()*e[0],a=this.height()*e[1];return[t,a]}},{key:"getAbsolutePoint",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0],t=this.x1+this.width()*e[0],a=this.y1+this.height()*e[1];return[t,a]}},{key:"constrainToRatio",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"height";if(null!==e){switch(this.width(),this.height(),a){case"height":this.resize(this.width(),this.width()*e,t);break;case"width":this.resize(1*this.height()/e,this.height(),t);break;default:this.resize(this.width(),this.width()*e,t)}return this}}},{key:"constrainToBoundary",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],s=this.getAbsolutePoint(a),i=n(s,2),o=i[0],r=i[1],l=o,c=r,d=e-o,u=t-r,m=-2*a[0]+1,p=-2*a[1]+1,_=null,v=null;switch(m){case-1:_=l;break;case 0:_=2*Math.min(l,d);break;case 1:_=d}switch(p){case-1:v=c;break;case 0:v=2*Math.min(c,u);break;case 1:v=u}if(this.width()>_){var h=_/this.width();this.scale(h,a)}if(this.height()>v){var w=v/this.height();this.scale(w,a)}return this}},{key:"constrainToSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[0,0],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(i&&(i>1?(e=1*t/i,s*=i):i<1&&(t=e*i,a=1*s/i)),e&&this.width()>e){var o=e,r=null===i?this.height():t;this.resize(o,r,n)}if(t&&this.height()>t){var l=null===i?this.width():e,c=t;this.resize(l,c,n)}if(a&&this.width()<a){var d=a,u=null===i?this.height():s;this.resize(d,u,n)}if(s&&this.height()<s){var m=null===i?this.width():a,p=s;this.resize(m,p,n)}return this}}]),a}();function r(e){e.preventDefault();var t=e.changedTouches[0];t.target.dispatchEvent(new MouseEvent({touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"}[e.type],{bubbles:!0,cancelable:!0,view:window,clientX:t.clientX,clientY:t.clientY,screenX:t.screenX,screenY:t.screenY}))}var l=[{position:[0,0],constraints:[1,0,0,1],cursor:"nw-resize"},{position:[.5,0],constraints:[1,0,0,0],cursor:"n-resize"},{position:[1,0],constraints:[1,1,0,0],cursor:"ne-resize"},{position:[1,.5],constraints:[0,1,0,0],cursor:"e-resize"},{position:[1,1],constraints:[0,1,1,0],cursor:"se-resize"},{position:[.5,1],constraints:[0,0,1,0],cursor:"s-resize"},{position:[0,1],constraints:[0,0,1,1],cursor:"sw-resize"},{position:[0,.5],constraints:[0,0,0,1],cursor:"w-resize"}];function c(e,t){return Number(Math.round(e+"e"+t)+"e-"+t)}return function(n){function i(t,a){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e(this,i),s(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,t,a,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,n),t(i,[{key:"getValue",value:function(e){return a(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"getValue",this).call(this,e)}},{key:"setImage",value:function(e){return a(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"setImage",this).call(this,e)}},{key:"destroy",value:function(){return a(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"destroy",this).call(this)}},{key:"moveTo",value:function(e,t){return this.box.move(e,t),this.redraw(),null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue()),this}},{key:"resizeTo",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[.5,.5];return this.box.resize(e,t,a),this.redraw(),null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue()),this}},{key:"scaleBy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[.5,.5];return this.box.scale(e,t),this.redraw(),null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue()),this}},{key:"reset",value:function(){return this.box=this.initializeBox(this.options),this.redraw(),null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue()),this}}]),i}(function(){function a(t,s){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e(this,a),this.options=a.parseOptions(s||{}),!t.nodeName&&null==(t=document.querySelector(t)))throw"Unable to find element.";if(!t.getAttribute("src"))throw"Image src not provided.";this._initialized=!1,this._restore={parent:t.parentNode,element:t},i||(0===t.width||0===t.height?t.onload=function(){n.initialize(t)}:this.initialize(t))}return t(a,[{key:"initialize",value:function(e){this.createDOM(e),this.options.convertToPixels(this.cropperEl),this.attachHandlerEvents(),this.attachRegionEvents(),this.attachOverlayEvents(),this.box=this.initializeBox(this.options),this.redraw(),this._initialized=!0,null!==this.options.onInitialize&&this.options.onInitialize(this)}},{key:"createDOM",value:function(e){var t;this.containerEl=document.createElement("div"),this.containerEl.className="croppr-container",this.eventBus=this.containerEl,(t=this.containerEl).addEventListener("touchstart",r),t.addEventListener("touchend",r),t.addEventListener("touchmove",r),this.cropperEl=document.createElement("div"),this.cropperEl.className="croppr",this.imageEl=document.createElement("img"),this.imageEl.setAttribute("src",e.getAttribute("src")),this.imageEl.setAttribute("alt",e.getAttribute("alt")),this.imageEl.className="croppr-image",this.imageClippedEl=this.imageEl.cloneNode(),this.imageClippedEl.className="croppr-imageClipped",this.regionEl=document.createElement("div"),this.regionEl.className="croppr-region",this.overlayEl=document.createElement("div"),this.overlayEl.className="croppr-overlay";var a=document.createElement("div");a.className="croppr-handleContainer",this.handles=[];for(var s=0;s<l.length;s++){var n=new i(l[s].position,l[s].constraints,l[s].cursor,this.eventBus);this.handles.push(n),a.appendChild(n.el)}this.cropperEl.appendChild(this.imageEl),this.cropperEl.appendChild(this.imageClippedEl),this.cropperEl.appendChild(this.regionEl),this.cropperEl.appendChild(this.overlayEl),this.cropperEl.appendChild(a),this.containerEl.appendChild(this.cropperEl),e.parentElement.replaceChild(this.containerEl,e)}},{key:"setImage",value:function(e){var t=this;return this.imageEl.onload=function(){t.box=t.initializeBox(t.options),t.redraw()},this.imageEl.src=e,this.imageClippedEl.src=e,this}},{key:"destroy",value:function(){this._restore.parent.replaceChild(this._restore.element,this.containerEl)}},{key:"initializeBox",value:function(e){var t=e.startSize.width,a=e.startSize.height,s=new o(0,0,t,a);s.constrainToRatio(e.aspectRatio,[.5,.5]);var n=e.minSize,i=e.maxSize;s.constrainToSize(i.width,i.height,n.width,n.height,[.5,.5],e.aspectRatio);var r=this.cropperEl.offsetWidth,l=this.cropperEl.offsetHeight;s.constrainToBoundary(r,l,[.5,.5]);var c=this.cropperEl.offsetWidth/2-s.width()/2,d=this.cropperEl.offsetHeight/2-s.height()/2;return s.move(c,d),s}},{key:"redraw",value:function(){var e=this,t=Math.round(this.box.width()),a=Math.round(this.box.height()),s=Math.round(this.box.x1),n=Math.round(this.box.y1),i=Math.round(this.box.x2),o=Math.round(this.box.y2);window.requestAnimationFrame((function(){e.regionEl.style.transform="translate("+s+"px, "+n+"px)",e.regionEl.style.width=t+"px",e.regionEl.style.height=a+"px",e.imageClippedEl.style.clip="rect("+n+"px, "+i+"px, "+o+"px, "+s+"px)";for(var r=e.box.getAbsolutePoint([.5,.5]),l=r[0]-e.cropperEl.offsetWidth/2>>31,c=r[1]-e.cropperEl.offsetHeight/2>>31,d=-2*((l^c)+c+c+4)+8,u=0;u<e.handles.length;u++){var m=e.handles[u],p=m.el.offsetWidth,_=m.el.offsetHeight,v=s+t*m.position[0]-p/2,h=n+a*m.position[1]-_/2;m.el.style.transform="translate("+Math.round(v)+"px, "+Math.round(h)+"px)",m.el.style.zIndex=d==u?5:4}}))}},{key:"attachHandlerEvents",value:function(){var e=this.eventBus;e.addEventListener("handlestart",this.onHandleMoveStart.bind(this)),e.addEventListener("handlemove",this.onHandleMoveMoving.bind(this)),e.addEventListener("handleend",this.onHandleMoveEnd.bind(this))}},{key:"attachRegionEvents",value:function(){var e=this.eventBus;function t(t){t.stopPropagation(),e.dispatchEvent(new CustomEvent("regionmove",{detail:{mouseX:t.clientX,mouseY:t.clientY}}))}function a(s){s.stopPropagation(),document.removeEventListener("mouseup",a),document.removeEventListener("mousemove",t),e.dispatchEvent(new CustomEvent("regionend",{detail:{mouseX:s.clientX,mouseY:s.clientY}}))}this.regionEl.addEventListener("mousedown",(function(s){s.stopPropagation(),document.addEventListener("mouseup",a),document.addEventListener("mousemove",t),e.dispatchEvent(new CustomEvent("regionstart",{detail:{mouseX:s.clientX,mouseY:s.clientY}}))})),e.addEventListener("regionstart",this.onRegionMoveStart.bind(this)),e.addEventListener("regionmove",this.onRegionMoveMoving.bind(this)),e.addEventListener("regionend",this.onRegionMoveEnd.bind(this))}},{key:"attachOverlayEvents",value:function(){var e=this,t=null;function a(t){t.stopPropagation(),e.eventBus.dispatchEvent(new CustomEvent("handlemove",{detail:{mouseX:t.clientX,mouseY:t.clientY}}))}function s(n){n.stopPropagation(),document.removeEventListener("mouseup",s),document.removeEventListener("mousemove",a),1!==e.box.width()||1!==e.box.height()?e.eventBus.dispatchEvent(new CustomEvent("handleend",{detail:{mouseX:n.clientX,mouseY:n.clientY}})):e.box=t}this.overlayEl.addEventListener("mousedown",(function(n){n.stopPropagation(),document.addEventListener("mouseup",s),document.addEventListener("mousemove",a);var i=e.cropperEl.getBoundingClientRect(),r=n.clientX-i.left,l=n.clientY-i.top;t=e.box,e.box=new o(r,l,r+1,l+1),e.eventBus.dispatchEvent(new CustomEvent("handlestart",{detail:{handle:e.handles[4]}}))}))}},{key:"onHandleMoveStart",value:function(e){var t=e.detail.handle,a=[1-t.position[0],1-t.position[1]],s=this.box.getAbsolutePoint(a),i=n(s,2),o=i[0],r=i[1];this.activeHandle={handle:t,originPoint:a,originX:o,originY:r},null!==this.options.onCropStart&&this.options.onCropStart(this.getValue())}},{key:"onHandleMoveMoving",value:function(e){var t=e.detail,a=t.mouseX,s=t.mouseY,n=this.cropperEl.getBoundingClientRect();a-=n.left,s-=n.top,a<0?a=0:a>n.width&&(a=n.width),s<0?s=0:s>n.height&&(s=n.height);var i=this.activeHandle.originPoint.slice(),r=this.activeHandle.originX,l=this.activeHandle.originY,c=this.activeHandle.handle,d=1===c.constraints[0],u=1===c.constraints[1],m=1===c.constraints[2],p=1===c.constraints[3],_=(p||u)&&(d||m),v=p||u?r:this.box.x1,h=p||u?r:this.box.x2,w=d||m?l:this.box.y1,f=d||m?l:this.box.y2;v=p?a:v,h=u?a:h,w=d?s:w,f=m?s:f;var g=!1,y=!1;if((p||u)&&(g=p?a>r:a<r),(d||m)&&(y=d?s>l:s<l),g){var b=v;v=h,h=b,i[0]=1-i[0]}if(y){var k=w;w=f,f=k,i[1]=1-i[1]}var x=new o(v,w,h,f);if(this.options.aspectRatio){var N=this.options.aspectRatio,I=!1;_?I=s>x.y1+N*x.width()||s<x.y2-N*x.width():(d||m)&&(I=!0);var C=I?"width":"height";x.constrainToRatio(N,i,C)}var O=this.options.minSize,S=this.options.maxSize;x.constrainToSize(S.width,S.height,O.width,O.height,i,this.options.aspectRatio);var q=this.cropperEl.offsetWidth,P=this.cropperEl.offsetHeight;x.constrainToBoundary(q,P,i),this.box=x,this.redraw(),null!==this.options.onCropMove&&this.options.onCropMove(this.getValue())}},{key:"onHandleMoveEnd",value:function(e){null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue())}},{key:"onRegionMoveStart",value:function(e){var t=e.detail,a=t.mouseX,s=t.mouseY,n=this.cropperEl.getBoundingClientRect();a-=n.left,s-=n.top,this.currentMove={offsetX:a-this.box.x1,offsetY:s-this.box.y1},null!==this.options.onCropStart&&this.options.onCropStart(this.getValue())}},{key:"onRegionMoveMoving",value:function(e){var t=e.detail,a=t.mouseX,s=t.mouseY,n=this.currentMove,i=n.offsetX,o=n.offsetY,r=this.cropperEl.getBoundingClientRect();a-=r.left,s-=r.top,this.box.move(a-i,s-o),this.box.x1<0&&this.box.move(0,null),this.box.x2>r.width&&this.box.move(r.width-this.box.width(),null),this.box.y1<0&&this.box.move(null,0),this.box.y2>r.height&&this.box.move(null,r.height-this.box.height()),this.redraw(),null!==this.options.onCropMove&&this.options.onCropMove(this.getValue())}},{key:"onRegionMoveEnd",value:function(e){null!==this.options.onCropEnd&&this.options.onCropEnd(this.getValue())}},{key:"getValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===e&&(e=this.options.returnMode),"real"==e){var t=this.imageEl.naturalWidth,a=this.imageEl.naturalHeight,s=this.imageEl.getBoundingClientRect(),n=s.width,i=s.height,o=t/n,r=a/i;return{x:Math.round(this.box.x1*o),y:Math.round(this.box.y1*r),width:Math.round(this.box.width()*o),height:Math.round(this.box.height()*r)}}if("ratio"==e){var l=this.imageEl.getBoundingClientRect(),d=l.width,u=l.height;return{x:c(this.box.x1/d,3),y:c(this.box.y1/u,3),width:c(this.box.width()/d,3),height:c(this.box.height()/u,3)}}if("raw"==e)return{x:Math.round(this.box.x1),y:Math.round(this.box.y1),width:Math.round(this.box.width()),height:Math.round(this.box.height())}}}],[{key:"parseOptions",value:function(e){var t=null,a={width:null,height:null},s={width:null,height:null},n={width:100,height:100,unit:"%"},i="real",o=null,r=null,l=null,c=null,d=null;void 0!==e.aspectRatio&&("number"==typeof e.aspectRatio?d=e.aspectRatio:e.aspectRatio instanceof Array&&(d=e.aspectRatio[1]/e.aspectRatio[0]));var u=null;void 0!==e.maxSize&&null!==e.maxSize&&(u={width:e.maxSize[0]||null,height:e.maxSize[1]||null,unit:e.maxSize[2]||"px"});var m=null;void 0!==e.minSize&&null!==e.minSize&&(m={width:e.minSize[0]||null,height:e.minSize[1]||null,unit:e.minSize[2]||"px"});var p=null;void 0!==e.startSize&&null!==e.startSize&&(p={width:e.startSize[0]||null,height:e.startSize[1]||null,unit:e.startSize[2]||"%"});var _=null;"function"==typeof e.onInitialize&&(_=e.onInitialize);var v=null;"function"==typeof e.onCropStart&&(v=e.onCropStart);var h=null;"function"==typeof e.onCropEnd&&(h=e.onCropEnd);var w=null;"function"==typeof e.onUpdate&&(console.warn("Croppr.js: `onUpdate` is deprecated and will be removed in the next major release. Please use `onCropMove` or `onCropEnd` instead."),w=e.onUpdate),"function"==typeof e.onCropMove&&(w=e.onCropMove);var f=null;if(void 0!==e.returnMode){var g=e.returnMode.toLowerCase();if(-1===["real","ratio","raw"].indexOf(g))throw"Invalid return mode.";f=g}var y=function(e,t){return null!==e?e:t};return{aspectRatio:y(d,t),maxSize:y(u,a),minSize:y(m,s),startSize:y(p,n),returnMode:y(f,i),onInitialize:y(_,o),onCropStart:y(v,r),onCropMove:y(w,l),onCropEnd:y(h,c),convertToPixels:function(e){for(var t=e.offsetWidth,a=e.offsetHeight,s=["maxSize","minSize","startSize"],n=0;n<s.length;n++){var i=s[n];null!==this[i]&&("%"==this[i].unit&&(null!==this[i].width&&(this[i].width=this[i].width/100*t),null!==this[i].height&&(this[i].height=this[i].height/100*a)),delete this[i].unit)}}}}}]),a}())}()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(8);Object.defineProperty(t,"AllSubstringsIndexStrategy",{enumerable:!0,get:function(){return s.AllSubstringsIndexStrategy}});var n=a(9);Object.defineProperty(t,"ExactWordIndexStrategy",{enumerable:!0,get:function(){return n.ExactWordIndexStrategy}});var i=a(10);Object.defineProperty(t,"PrefixIndexStrategy",{enumerable:!0,get:function(){return i.PrefixIndexStrategy}})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(11);Object.defineProperty(t,"CaseSensitiveSanitizer",{enumerable:!0,get:function(){return s.CaseSensitiveSanitizer}});var n=a(12);Object.defineProperty(t,"LowerCaseSanitizer",{enumerable:!0,get:function(){return n.LowerCaseSanitizer}})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(13);Object.defineProperty(t,"TfIdfSearchIndex",{enumerable:!0,get:function(){return s.TfIdfSearchIndex}});var n=a(14);Object.defineProperty(t,"UnorderedSearchIndex",{enumerable:!0,get:function(){return n.UnorderedSearchIndex}})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){t=t||[];for(var a=e=e||{},s=0;s<t.length;s++)if(null==(a=a[t[s]]))return null;return a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(15);Object.defineProperty(t,"SimpleTokenizer",{enumerable:!0,get:function(){return s.SimpleTokenizer}});var n=a(16);Object.defineProperty(t,"StemmingTokenizer",{enumerable:!0,get:function(){return n.StemmingTokenizer}});var i=a(17);Object.defineProperty(t,"StopWordsTokenizer",{enumerable:!0,get:function(){return i.StopWordsTokenizer}})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=t.StopWordsMap={a:!0,able:!0,about:!0,across:!0,after:!0,all:!0,almost:!0,also:!0,am:!0,among:!0,an:!0,and:!0,any:!0,are:!0,as:!0,at:!0,be:!0,because:!0,been:!0,but:!0,by:!0,can:!0,cannot:!0,could:!0,dear:!0,did:!0,do:!0,does:!0,either:!0,else:!0,ever:!0,every:!0,for:!0,from:!0,get:!0,got:!0,had:!0,has:!0,have:!0,he:!0,her:!0,hers:!0,him:!0,his:!0,how:!0,however:!0,i:!0,if:!0,in:!0,into:!0,is:!0,it:!0,its:!0,just:!0,least:!0,let:!0,like:!0,likely:!0,may:!0,me:!0,might:!0,most:!0,must:!0,my:!0,neither:!0,no:!0,nor:!0,not:!0,of:!0,off:!0,often:!0,on:!0,only:!0,or:!0,other:!0,our:!0,own:!0,rather:!0,said:!0,say:!0,says:!0,she:!0,should:!0,since:!0,so:!0,some:!0,than:!0,that:!0,the:!0,their:!0,them:!0,then:!0,there:!0,these:!0,they:!0,this:!0,tis:!0,to:!0,too:!0,twas:!0,us:!0,wants:!0,was:!0,we:!0,were:!0,what:!0,when:!0,where:!0,which:!0,while:!0,who:!0,whom:!0,why:!0,will:!0,with:!0,would:!0,yet:!0,you:!0,your:!0};s.constructor=!1,s.hasOwnProperty=!1,s.isPrototypeOf=!1,s.propertyIsEnumerable=!1,s.toLocaleString=!1,s.toString=!1,s.valueOf=!1},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1);Object.defineProperty(t,"AllSubstringsIndexStrategy",{enumerable:!0,get:function(){return s.AllSubstringsIndexStrategy}}),Object.defineProperty(t,"ExactWordIndexStrategy",{enumerable:!0,get:function(){return s.ExactWordIndexStrategy}}),Object.defineProperty(t,"PrefixIndexStrategy",{enumerable:!0,get:function(){return s.PrefixIndexStrategy}});var n=a(2);Object.defineProperty(t,"CaseSensitiveSanitizer",{enumerable:!0,get:function(){return n.CaseSensitiveSanitizer}}),Object.defineProperty(t,"LowerCaseSanitizer",{enumerable:!0,get:function(){return n.LowerCaseSanitizer}});var i=a(3);Object.defineProperty(t,"TfIdfSearchIndex",{enumerable:!0,get:function(){return i.TfIdfSearchIndex}}),Object.defineProperty(t,"UnorderedSearchIndex",{enumerable:!0,get:function(){return i.UnorderedSearchIndex}});var o=a(5);Object.defineProperty(t,"SimpleTokenizer",{enumerable:!0,get:function(){return o.SimpleTokenizer}}),Object.defineProperty(t,"StemmingTokenizer",{enumerable:!0,get:function(){return o.StemmingTokenizer}}),Object.defineProperty(t,"StopWordsTokenizer",{enumerable:!0,get:function(){return o.StopWordsTokenizer}});var r=a(18);Object.defineProperty(t,"Search",{enumerable:!0,get:function(){return r.Search}});var l=a(6);Object.defineProperty(t,"StopWordsMap",{enumerable:!0,get:function(){return l.StopWordsMap}});var c=a(19);Object.defineProperty(t,"TokenHighlighter",{enumerable:!0,get:function(){return c.TokenHighlighter}})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}();t.AllSubstringsIndexStrategy=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,[{key:"expandToken",value:function(e){for(var t,a=[],s=0,n=e.length;s<n;++s){t="";for(var i=s;i<n;++i)t+=e.charAt(i),a.push(t)}return a}}]),e}()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}();t.ExactWordIndexStrategy=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,[{key:"expandToken",value:function(e){return e?[e]:[]}}]),e}()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}();t.PrefixIndexStrategy=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,[{key:"expandToken",value:function(e){for(var t=[],a="",s=0,n=e.length;s<n;++s)a+=e.charAt(s),t.push(a);return t}}]),e}()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}();t.CaseSensitiveSanitizer=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,[{key:"sanitize",value:function(e){return e?e.trim():""}}]),e}()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}();t.LowerCaseSanitizer=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,[{key:"sanitize",value:function(e){return e?e.toLocaleLowerCase().trim():""}}]),e}()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TfIdfSearchIndex=void 0;var s,n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),o=a(4),r=(s=o)&&s.__esModule?s:{default:s};t.TfIdfSearchIndex=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._uidFieldName=t,this._tokenToIdfCache={},this._tokenMap={}}return i(e,[{key:"indexDocument",value:function(e,t,a){this._tokenToIdfCache={};var s,i=this._tokenMap;"object"!==n(i[e])?i[e]=s={$numDocumentOccurrences:0,$totalNumOccurrences:1,$uidMap:{}}:(s=i[e]).$totalNumOccurrences++;var o=s.$uidMap;"object"!==n(o[t])?(s.$numDocumentOccurrences++,o[t]={$document:a,$numTokenOccurrences:1}):o[t].$numTokenOccurrences++}},{key:"search",value:function(e,t){for(var a={},s=0,i=e.length;s<i;s++){var o=e[s],r=this._tokenMap[o];if(!r)return[];if(0===s)for(var l=0,c=(d=Object.keys(r.$uidMap)).length;l<c;l++){a[u=d[l]]=r.$uidMap[u].$document}else{var d;for(l=0,c=(d=Object.keys(a)).length;l<c;l++){var u=d[l];"object"!==n(r.$uidMap[u])&&delete a[u]}}}var m=[];for(var u in a)m.push(a[u]);var p=this._createCalculateTfIdf();return m.sort((function(a,s){return p(e,s,t)-p(e,a,t)}))}},{key:"_createCalculateIdf",value:function(){var e=this._tokenMap,t=this._tokenToIdfCache;return function(a,s){if(!t[a]){var n=void 0!==e[a]?e[a].$numDocumentOccurrences:0;t[a]=1+Math.log(s.length/(1+n))}return t[a]}}},{key:"_createCalculateTfIdf",value:function(){var e=this._tokenMap,t=this._uidFieldName,a=this._createCalculateIdf();return function(s,n,i){for(var o=0,l=0,c=s.length;l<c;++l){var d,u=s[l],m=a(u,i);m===1/0&&(m=0),d=t instanceof Array?n&&(0,r.default)(n,t):n&&n[t],o+=(void 0!==e[u]&&void 0!==e[u].$uidMap[d]?e[u].$uidMap[d].$numTokenOccurrences:0)*m}return o}}}]),e}()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}();t.UnorderedSearchIndex=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._tokenToUidToDocumentMap={}}return n(e,[{key:"indexDocument",value:function(e,t,a){"object"!==s(this._tokenToUidToDocumentMap[e])&&(this._tokenToUidToDocumentMap[e]={}),this._tokenToUidToDocumentMap[e][t]=a}},{key:"search",value:function(e,t){for(var a={},n=this._tokenToUidToDocumentMap,i=0,o=e.length;i<o;i++){var r=n[e[i]];if(!r)return[];if(0===i)for(var l=0,c=(u=Object.keys(r)).length;l<c;l++){a[d=u[l]]=r[d]}else for(l=0,c=(u=Object.keys(a)).length;l<c;l++){var d=u[l];"object"!==s(r[d])&&delete a[d]}}var u,m=[];for(i=0,c=(u=Object.keys(a)).length;i<c;i++){d=u[i];m.push(a[d])}return m}}]),e}()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}();var n=/[^a-zа-яё0-9\-']+/i;t.SimpleTokenizer=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,[{key:"tokenize",value:function(e){return e.split(n).filter((function(e){return e}))}}]),e}()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}();t.StemmingTokenizer=function(){function e(t,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._stemmingFunction=t,this._tokenizer=a}return s(e,[{key:"tokenize",value:function(e){return this._tokenizer.tokenize(e).map(this._stemmingFunction)}}]),e}()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StopWordsTokenizer=void 0;var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),n=a(6);t.StopWordsTokenizer=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._tokenizer=t}return s(e,[{key:"tokenize",value:function(e){return this._tokenizer.tokenize(e).filter((function(e){return!n.StopWordsMap[e]}))}}]),e}()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Search=void 0;var s,n=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),i=a(4),o=(s=i)&&s.__esModule?s:{default:s},r=a(1),l=a(2),c=a(3),d=a(5);t.Search=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!t)throw Error("js-search requires a uid field name constructor parameter");this._uidFieldName=t,this._indexStrategy=new r.PrefixIndexStrategy,this._searchIndex=new c.TfIdfSearchIndex(t),this._sanitizer=new l.LowerCaseSanitizer,this._tokenizer=new d.SimpleTokenizer,this._documents=[],this._searchableFields=[]}return n(e,[{key:"addDocument",value:function(e){this.addDocuments([e])}},{key:"addDocuments",value:function(e){this._documents=this._documents.concat(e),this.indexDocuments_(e,this._searchableFields)}},{key:"addIndex",value:function(e){this._searchableFields.push(e),this.indexDocuments_(this._documents,[e])}},{key:"search",value:function(e){var t=this._tokenizer.tokenize(this._sanitizer.sanitize(e));return this._searchIndex.search(t,this._documents)}},{key:"indexDocuments_",value:function(e,t){this._initialized=!0;for(var a=this._indexStrategy,s=this._sanitizer,n=this._searchIndex,i=this._tokenizer,r=this._uidFieldName,l=0,c=e.length;l<c;l++){var d,u=e[l];d=r instanceof Array?(0,o.default)(u,r):u[r];for(var m=0,p=t.length;m<p;m++){var _,v=t[m];if(null!=(_=v instanceof Array?(0,o.default)(u,v):u[v])&&"string"!=typeof _&&_.toString&&(_=_.toString()),"string"==typeof _)for(var h=i.tokenize(s.sanitize(_)),w=0,f=h.length;w<f;w++)for(var g=h[w],y=a.expandToken(g),b=0,k=y.length;b<k;b++){var x=y[b];n.indexDocument(x,d,u)}}}}},{key:"indexStrategy",set:function(e){if(this._initialized)throw Error("IIndexStrategy cannot be set after initialization");this._indexStrategy=e},get:function(){return this._indexStrategy}},{key:"sanitizer",set:function(e){if(this._initialized)throw Error("ISanitizer cannot be set after initialization");this._sanitizer=e},get:function(){return this._sanitizer}},{key:"searchIndex",set:function(e){if(this._initialized)throw Error("ISearchIndex cannot be set after initialization");this._searchIndex=e},get:function(){return this._searchIndex}},{key:"tokenizer",set:function(e){if(this._initialized)throw Error("ITokenizer cannot be set after initialization");this._tokenizer=e},get:function(){return this._tokenizer}}]),e}()},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenHighlighter=void 0;var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),n=a(1),i=a(2);t.TokenHighlighter=function(){function e(t,a,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._indexStrategy=t||new n.PrefixIndexStrategy,this._sanitizer=a||new i.LowerCaseSanitizer,this._wrapperTagName=s||"mark"}return s(e,[{key:"highlight",value:function(e,t){for(var a=this._wrapText("").length,s=Object.create(null),n=0,i=t.length;n<i;n++)for(var o=this._sanitizer.sanitize(t[n]),r=this._indexStrategy.expandToken(o),l=0,c=r.length;l<c;l++){var d=r[l];s[d]?s[d].push(o):s[d]=[o]}for(var u="",m="",p=0,_=(n=0,e.length);n<_;n++){var v=e.charAt(n);" "===v?(u="",m="",p=n+1):(u+=v,m+=this._sanitizer.sanitize(v)),s[m]&&s[m].indexOf(m)>=0&&(u=this._wrapText(u),e=e.substring(0,p)+u+e.substring(n+1),n+=a,_+=a)}return e}},{key:"_wrapText",value:function(e){var t=this._wrapperTagName;return"<"+t+">"+e+"</"+t+">"}}]),e}()},function(e,t,a){},function(e,t,a){"use strict";a.r(t);const{createElement:s,useState:n,useEffect:o,Fragment:r,render:l,useRef:c}=wp.element,{dispatch:d,select:u}=wp.data;function m(e){if(void 0===e)return!0;if("undefined"===e)return!0;if(null==e)return!0;if("number"==typeof e)return!1;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}const p=()=>{let e=u("vibebp").getUser();return!(m(e)||!e.hasOwnProperty("caps")||!e.caps.hasOwnProperty("manage_options")||!e.caps.manage_options)},_=(e,t,a=[])=>{const s=c(Date.now());o(()=>{const a=setTimeout((function(){Date.now()-s.current>=t&&(e(),s.current=Date.now())}),t-(Date.now()-s.current));return()=>{clearTimeout(a)}},[t,...a])};function v(e){if(void 0===e)return!0;if("undefined"===e)return!0;if(null==e)return!0;if("number"==typeof e)return!0;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function h(e,t,a=null){if(Array.isArray(t))if(a){for(let s=0;s<t.length;s++)if(t[s][a]===e[a])return s}else for(let a=0;a<t.length;a++)if(t[a].id===e.id)return a;return-1}const w=e=>{const[t,a]=n("");return o(()=>{let t="",s="";switch(e.type){case"friends":s="user",t=e.id.item_id;break;case"group":s="group",t=e.id.item_id;break;case"activity":s="user",t=e.id.secondary_item_id;break;case"user":s="user",t=e.id.user_id;break;default:s=e.type,t=e.id.item_id}localforage.getItem(s+"_"+t).then(t=>{null!==t?a(JSON.parse(t)):fetch(window.vibebp.api.url+"/avatar",{method:"post",body:JSON.stringify({type:e.type,ids:e.id,token:u("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.status&&(localforage.setItem(e.key,JSON.stringify(e.value)),a(e.value))})})},[]),s("img",{src:t.avatar,className:"vibebp_avatar",onClick:e.click,alt:t.name,title:t.name})};var f=m;const{createContext:g}=wp.element;var y=g({course:{},activeTab:"create_course",update:e=>{}});const{createElement:b,render:k,useState:x,useEffect:N,useContext:I,Fragment:C,RawHTML:O}=wp.element;var S=e=>{I(y);const[t,a]=x({});N(()=>{a(e.field)},[e.field]);const s=s=>{let n={...t};n.value=s,a(n),e.update(n,e.fieldIndex,"fieldvaluechanged")};return b("div",{className:"switch"},"S"==t.value?b("input",{type:"checkbox",id:t.id,checked:!0,onClick:()=>s("H")}):b("input",{type:"checkbox",id:t.id,onClick:()=>s("S")}),b("label",{for:t.id,className:"slider"}))};const{createElement:q,render:P,useState:E,useEffect:z,useContext:T,Fragment:M,RawHTML:j}=wp.element;var L=e=>{const[t,a]=E(e.field);T(y);z(()=>{a(e.field)},[e.field]);return q("div",{className:"textarea_field"},q("textarea",{id:t.id,value:t.value,onChange:s=>(s=>{let n={...t};n.value=s.target.value,a(n),console.log(e.fieldIndex),a(n),e.update(n,e.fieldIndex,"fieldvaluechanged")})(s),placeholder:t.default},t.value))};const{createElement:H,render:A,useState:F,useEffect:D,useContext:R,Fragment:J,RawHTML:B}=wp.element;var $=e=>{R(y);const[t,a]=F(!1),[s,n]=F({});D(()=>{let t={...e.field};m(e.field.value)&&!m(e.field.default)&&(t.value=e.field.default),n(t)},[e.field]);return H("div",{className:"number"},t||9999!==s.value?H("input",{type:"number",id:s.id,value:s.value,onChange:t=>(t=>{let a={...s};a.value=t.target.value,n(a),e.update(a,e.fieldIndex,"fieldvaluechanged")})(t),placeholder:s.default}):H("span",{onClick:()=>a(!t)},window.wplms_create_course_data.translations.unlimited))};const{createElement:U,render:V,useState:W,useEffect:Y,useContext:X,Fragment:Q,RawHTML:K}=wp.element;var G=e=>{X(y);const[t,a]=W({});Y(()=>{a(e.field)},[e.field]);return U("div",{className:"number"},U("input",{type:"number",id:t.id,value:t.value,onChange:s=>(s=>{let n={...t};n.value=s.target.value,a(n),e.update(n,e.fieldIndex,"fieldvaluechanged")})(s),placeholder:t.default}))};const{createElement:Z,render:ee,useState:te,useEffect:ae,useContext:se,Fragment:ne,RawHTML:ie}=wp.element;var oe=e=>{const[t,a]=te({});se(y);ae(()=>{a(e.field)},[e.field]);return Z("div",{className:"vibe_form_field "+t.id},Z("input",{type:"text",id:t.id,value:t.value,onChange:s=>(s=>{let n={...t};n.value=s.target.value,a(n),e.update(n,e.fieldIndex,"fieldvaluechanged")})(s),placeholder:t.default}))};const{createElement:re,render:le,useState:ce,useEffect:de,useContext:ue,useRef:me,Fragment:pe,RawHTML:_e}=wp.element;var ve=e=>{const t=me(null),[a,s]=ce(e.field),[n,i]=ce("vibe_form_field "+e.field.id);ue(y);de(()=>{s(e.field)},[e.field]),de(()=>{if(a.hasOwnProperty("isEmpty")&&a.isEmpty){let e=n;e=n+" erroremptyvalue",i(e);var s=window.scrollX,o=window.scrollY;window.scrollTo(s,o),t.current.focus()}else{let t="vibe_form_field "+e.field.id;i(t)}},[a,a.isEmpty,a.random]);return re("div",{className:n},re("input",{ref:t,type:"text",className:"text_field",onChange:t=>{(t=>{let n={...a};n.value=t,t.length&&(n.isEmpty=!1),s(n),e.update(n,e.fieldIndex,"fieldvaluechanged")})(t.target.value)},placeholder:a.default,value:a.value}))};const{createElement:he,render:we,useState:fe,useEffect:ge,useContext:ye,Fragment:be,RawHTML:ke}=wp.element;var xe=e=>{ye(y);const[t,a]=fe({});ge(()=>{a(e.field)},[e.field]);return he("div",{className:"select"},he("select",{id:t.id,onChange:s=>(s=>{let n={...t};n.value=s.target.value,a(n),e.update(n,e.fieldIndex,"fieldvaluechanged")})(s)},t.options&&t.options.length?t.options.map((e,a)=>{let s=!1;return e.value==t.value&&(s=!0),he("option",{value:e.value,selected:s},e.label)}):""))};const{createElement:Ne,render:Ie,useState:Ce,useEffect:Oe,useContext:Se,Fragment:qe,RawHTML:Pe,useRef:Ee}=wp.element;var ze=e=>{const[t,a]=Ce(e.field),s=Ee(null);Oe(()=>{a(e.field)},[e.field]),Oe(()=>{if(s.current){console.log(e.field);let t={altInput:!0,dateFormat:"Y-m-d",defaultDate:e.field.hasOwnProperty("value")&&e.field.value.length?e.field.value:[],onChange:n};flatpickr(s.current,t)}},[]);const n=s=>{let n={...t};if(s&&s.length){var i=s[0].getDate();(i=i.toString()).length<2&&(i="0"+i);var o=s[0].getMonth()+1;(o=o.toString()).length<2&&(o="0"+o);var r=s[0].getFullYear()+"-"+o+"-"+i;n.value=r}else n.value="";a(n),e.update(n,e.fieldIndex,"fieldvaluechanged")};return Ne("div",{className:"date"},Ne("input",{type:"text",ref:s}))};const{createElement:Te,render:Me,useState:je,useEffect:Le,useContext:He,Fragment:Ae,RawHTML:Fe}=wp.element;var De=e=>{const[t,a]=je({}),[s,n]=je(!1);He(y);Le(()=>{a(e.field)},[e.field]);for(var i=[],o=["AM","PM"],r=0;r<o.length;r++)for(var l=1;l<=12;l++)for(var c=0;c<=3;c++){let e=15*(4===c?0:c),t=l.toString(),a=e.toString();t.length<2&&(t="0"+t),a.length<2&&(a="0"+a),"PM"==o[r]&&"00"==t||i.push(t+":"+a+" "+o[r])}return Te("div",{className:t.type+" time_field"},Te("input",{type:"text",id:t.id,value:t.value,onClick:()=>{n(!0)},placeholder:t.default,readonly:!0}),s?Te("ul",{className:"time_options"},i.length?i.map(s=>Te("li",{onClick:()=>{(s=>{let n={...t};n.value=s,a(n),e.update(n,e.fieldIndex,"fieldvaluechanged")})(s),n(!1)}},s)):""):"")};const{createElement:Re,render:Je,useState:Be,useEffect:$e,useContext:Ue,Fragment:Ve,RawHTML:We}=wp.element,{dispatch:Ye,select:Xe}=wp.data;var Qe=e=>{const t=Ue(y),[a,s]=Be(!1),[n,i]=Be({}),[o,r]=Be(-1),{dispatch:l,select:c}=wp.data;let d=c("vibebp").getUser();d.token=c("vibebp").getToken(),$e(()=>{i(e.field),s(!0)},[e.field]);const u=(t,a)=>{if("fieldvaluechanged"==a){let a={...n};a.settings[t.index]=t.field,e.update({field:a,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex,index:e.index,child_index:t.index},"fieldvaluechanged")}};return a?Re(Ve,null,Re("strong",{className:"title"},Re("i",{className:"icon-attachment"}),n.data.text),Re("ul",{className:"data_links"},Re("li",null,Re("a",{className:"edit",title:"Edit Assignment",onClick:a=>{var s;s=n.data.id,f(n.settings)?fetch(`${window.wplms_create_course_data.api_url}/curriculum/${s}`,{method:"post",body:JSON.stringify({type:n.type,token:d.token})}).then(e=>e.json()).then(t=>{if(console.log(t),t.status){let a={...n};a.settings=t.data,i(a),e.update({field:a,fieldIndex:e.fieldIndex,cindex:e.cindex,index:e.index},"assignmentsettingsadded"),r(e.index)}}):r(e.cindex),t.update({field:e.index,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex},"currentEditingassignmentIndex")}},Re("span",{className:"dashicons dashicons-edit"}))),Re("li",null,Re("a",{className:"preview",title:"Preview",target:"_blank"},Re("span",{className:"dashicons dashicons-visibility"}))),Re("li",null,Re("a",{className:"remove",title:"Remove",onClick:a=>{t.course[e.tabIndex].fields[e.fieldIndex].curriculum[e.cindex].settings[e.ufieldIndex].value&&t.course[e.tabIndex].fields[e.fieldIndex].curriculum[e.cindex].settings[e.ufieldIndex].value.length&&t.update({fieldIndex:e.fieldIndex,cindex:e.cindex,index:e.index,ufieldIndex:e.ufieldIndex},"removeassigmentfromunit")}},Re("span",{className:"dashicons dashicons-no-alt"}))),Re("li",null,Re("a",{className:"delete",title:"Delete"},Re("span",{className:"dashicons dashicons-trash"})))),n.settings&&n.settings.length&&!f(t.course[e.tabIndex].fields[e.fieldIndex].curriculum[e.cindex].settings[e.ufieldIndex].currentEditingassignmentIndex)&&t.course[e.tabIndex].fields[e.fieldIndex].curriculum[e.cindex].settings[e.ufieldIndex].currentEditingassignmentIndex===e.index?Re("div",{className:"element_overlay overlay"},Re("span",{class:"close-pop dashicons dashicons-no-alt",onClick:()=>{r(-1),t.update({field:-1,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex},"currentEditingassignmentIndex")}}),Re("div",{className:"list-group"},n.settings&&n.settings.length?n.settings.map((t,a)=>Re("div",{className:"list-group-item"},Re(Zd,{field:t,fieldIndex:a,tabIndex:e.fieldIndex,update:u,cindex:e.cindex,aindex:e.index,index:a}))):"")):""):""};const{createElement:Ke,render:Ge}=wp.element;var Ze=e=>Ke("div",{class:"lds-ellipsis"},Ke("div",null),Ke("div",null),Ke("div",null),Ke("div",null));const{createElement:et,render:tt,useState:at,useEffect:st,useContext:nt,Fragment:it,RawHTML:ot}=wp.element;var rt=e=>{const[t,a]=at(e.field),[s,n]=at(""),[i,o]=at([]),[r,l]=at({}),[c,d]=at(!1),{dispatch:u,select:m}=wp.data;let p=m("vibebp").getUser();return p.token=m("vibebp").getToken(),st(()=>{let s={...t};r.id&&(s.value=r.id,s.show_value=r,a(s),e.update(s,"fieldvaluechanged"))},[r]),st(()=>{if(s.length>3){d(!0);let t="",a="";e.field.cpt&&(t=e.field.cpt,a="selectcpt"),e.field.taxonomy&&(t=e.field.taxonomy,a="taxonomy"),fetch(`${window.wplms_create_course_data.api_url}/${a}/${t}`,{method:"post",body:JSON.stringify({search:s,token:p.token})}).then(e=>e.json()).then(e=>{console.log(e),e.status&&Array.isArray(e.posts)&&(e.posts.map(e=>{localStorage.setItem("post_"+e.id,JSON.stringify(e))}),o(e.posts)),d(!1)})}},[s]),et("div",{className:"selectcptfield"},et("div",{className:"selectcptfield_list"},r&&r.text?et("div",{className:"selectcptfield_items"},et("span",{type:t.cpt,onClick:()=>{l({})},dangerouslySetInnerHTML:{__html:r.text}})):et("div",{className:c?"control is-loading":"control"},et("input",{type:"text",value:s,placeholder:window.wplms_create_course_data.translations.type_keyword,onChange:e=>{n(e.target.value)}}))),i.length?et("div",{className:"search_results"},i.map((e,t)=>et("div",{className:"search_result selectcpt",onClick:()=>{n("");let a={...r};a=e,i.splice(t,1),l(a),o([])}},et("span",{dangerouslySetInnerHTML:{__html:e.text}})))):"")};const{createElement:lt,render:ct,useState:dt,useEffect:ut,useContext:mt,Fragment:pt}=wp.element,{dispatch:_t,select:vt}=wp.data;var ht=e=>{const t=mt(y),[a,s]=dt({}),[n,i]=dt(!1),[o,r]=dt(""),[l,c]=dt({}),[d,u]=dt(!1),[m,p]=dt(!1),[_,v]=dt("");let h=vt("vibebp").getUser();h.token=vt("vibebp").getToken(),ut(()=>{s(e.field),i(!0),r("assignment")},[e.field]);const w=(s,n)=>{if(console.log(s,n),"fieldvaluechanged"==n){let n={...a};n&&n.value&&n.value[s.index]&&(n.value[s.index]=s.field,t.update({field:n,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex,child_index:s.child_index,value_index:s.index},"curriculumchangedunitdata"))}if(n="assignmentsettingsadded"){let n={...a};n.value[s.index].settings||(n.value[s.index].settings=[]),n&&n.value&&n.value[s.index]&&s.field.settings&&(n.value[s.index].settings=s.field.settings,t.update({field:n,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex},"curriculumchangedunitdata"))}},f=(s,n=null)=>{let i={};l&&l.id&&(n=l),i={type:s,data:n};let o={...a};o.value||(o.value=[]),o.value.push(i),console.log(o),t.update({field:o,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex},"curriculumchangedunitdata")};return n?lt("div",{className:"unitassignments unit_field"},a&&a.value&&a.value.length?a.value.map((t,a)=>lt("div",{className:"list-group-item assignment_block"},lt(Qe,{field:t,fieldIndex:e.fieldIndex,cindex:e.cindex,index:a,update:w,tabIndex:e.tabIndex,ufieldIndex:e.ufieldIndex}))):"",lt("div",{className:"add_cpt_wrapper"},lt("div",{className:"select_cpt_wrapper"},lt("a",{className:"more",onClick:()=>{u(!d),p(!1)}},lt("i",{className:"icon-users"})," Select existing ",o),d?lt("div",{className:"select_existing_cpt"},lt(rt,{field:{cpt:o},update:(e,t)=>{"fieldvaluechanged"==t&&c(e.show_value)}}),lt("div",null,lt("a",{class:"use_selected_curriculum button",onClick:()=>{f(o)}},"Set ",o))):""),lt("div",{className:"create_cpt_wrapper"},lt("a",{class:"more",onClick:()=>{p(!m),u(!1)}},lt("i",{class:"icon-user"})," Create new ",o),m?lt("div",{className:"new_cpt"},lt("input",{type:"text",className:"form_field vibe_curriculum_title",value:_,placeholder:o+" title",onChange:e=>{v(e.target.value)}}),lt("a",{className:"button small create_new_curriculum",onClick:()=>{var e;e=o,_.length&&fetch(`${window.wplms_create_course_data.api_url}/create/${e}`,{method:"post",body:JSON.stringify({name:_,token:h.token})}).then(e=>e.json()).then(t=>{console.log(t),t.status&&(c(t.data),f(e,t.data))}),v("")}},"Create ",o)):""))):""};const{createElement:wt,render:ft,useState:gt,useEffect:yt,useContext:bt,Fragment:kt,RawHTML:xt}=wp.element,{dispatch:Nt,select:It}=wp.data;var Ct=e=>{const[t,a]=gt(e.timestamp),[s,n]=gt(0);let i=Math.floor(Date.now()/1e3);yt(()=>{if(a(parseInt(e.timestamp)),e.timestamp)if(e.hasOwnProperty("notimediff"))n(parseInt(e.timestamp));else{let t=e.timestamp;e.timestamp.toString().includes("-")&&(t=new Date(t).getTime()/1e3),parseInt(t)>i?n(parseInt(t)-i):n(i-parseInt(t))}},[e.timestamp]);return wt("span",{className:"friendly_time"},(()=>{if(s<0)return window.wplms_course_data.translations.expired;let t,a,n,i=0,o=0,r=0,l=[{label:window.wplms_course_data.time_labels.year.single,multi:window.wplms_course_data.time_labels.year.multi,value:31536e3},{label:window.wplms_course_data.time_labels.month.single,multi:window.wplms_course_data.time_labels.month.multi,value:2592e3,max:12},{label:window.wplms_course_data.time_labels.week.single,multi:window.wplms_course_data.time_labels.week.multi,value:604800,max:7},{label:window.wplms_course_data.time_labels.day.single,multi:window.wplms_course_data.time_labels.day.multi,value:86400,max:31},{label:window.wplms_course_data.time_labels.hour.single,multi:window.wplms_course_data.time_labels.hour.multi,value:3600,max:24},{label:window.wplms_course_data.time_labels.minute.single,multi:window.wplms_course_data.time_labels.minute.multi,value:60,max:60},{label:window.wplms_course_data.time_labels.second.single,multi:window.wplms_course_data.time_labels.second.multi,value:1,max:60}];if(s>=776736e3)return window.wplms_course_data.translations.unlimited_time;if(s<=0)return e.hasOwnProperty("notimediff")?s+" "+window.wplms_course_data.time_labels.second.multi:window.wplms_course_data.translations.just_now;for(let e=0;e<l.length;e++)if(a=l[e],o=e,a.value<s){i=Math.floor(s/a.value),i>a.max&&(i=a.max);break}return t=i+" "+(i>1?a.multi:a.label),a.value>1&&(n=l[o+1],r=Math.floor(s%a.value/n.value),r&&(t+=", "+r+" "+(r>1?n.multi:n.label))),t})())};const{createElement:Ot,render:St,useState:qt,useEffect:Pt,useContext:Et,Fragment:zt}=wp.element,{dispatch:Tt,select:Mt}=wp.data;var jt=e=>{const t=Et(y),[a,s]=qt(!1),[n,i]=qt(e.field),[o,r]=qt(!1),[l,c]=qt(""),[d,u]=qt({}),[m,p]=qt(!1),[_,v]=qt(!1),[h,w]=qt({}),[g,b]=qt({}),[k,x]=qt(!1),N=(Mt("vibebp").getUser(),Mt("vibebp").getToken());Pt(()=>{e.field&&e.field.hasOwnProperty("show_value")&&u(e.field.show_value),i(e.field),c("groups")},[e.field]),Pt(()=>{if(n.hasOwnProperty("value")&&n.value){x(!0);let e=n.value;"object"==typeof n.value&&(e=n.value.id),fetch(window.wplms_create_course_data.api_url+"/component/get_group/",{method:"post",body:JSON.stringify({token:N,id:e})}).then(e=>e.json()).then(e=>{x(!1),s(!1),e.status?b(e.group):Tt("vibebp").addNotification({text:e.message})})}},[n.value]);const I=(a=null)=>{d&&d.id&&f(a)&&(a=d);let s={...n};s.value||(s.value={}),s.value=a,t.update({field:s,index:e.fieldIndex},"fieldvaluechanged")},C=(e,t)=>{let a={...h};a[e]=t,w(a)};return Ot("div",{className:"coursegroups unit_field"},a?Ot("div",{className:"add_cpt"},m?Ot("span",null,Ot("span",{className:"vicon vicon-arrow-left",onClick:()=>p(!1)}),Ot("span",{className:"vicon vicon-close",onClick:()=>s(!1)})):"","select"==m?Ot("div",{className:"select_existing_cpt"},Ot(rt,{field:{cpt:l},update:(e,t)=>{"fieldvaluechanged"==t&&u(e.show_value)}}),Ot("div",null,Ot("a",{class:"use_selected_curriculum button is-primary",onClick:()=>{I()}},window.wplms_create_course_data.translations.select_group))):"create"==m?Ot("div",{className:"new_cpt"},Ot("input",{type:"text",className:"form_field vibe_curriculum_title",value:h.name,placeholder:l+" title",onChange:e=>{C("name",e.target.value)}}),Ot("select",{onChange:e=>{C("privacy",e.target.value)}},n.privacy_options&&n.privacy_options.length?n.privacy_options.map((e,t)=>{let a=!1;return e.value===h.privacy&&(a=!0),Ot("option",{value:e.value,selected:a},e.label)}):""),Ot("textarea",{value:h.description,onChange:e=>{C("description",e.target.value)},placeholder:window.wplms_create_course_data.translations.description},h.description),Ot("a",{className:_?"is-loading button is-primary":"button is-primary",onClick:()=>{var e;e=l,h&&h.name.length?(v(!0),fetch(`${window.wplms_create_course_data.api_url}/create/component/${e}`,{method:"post",body:JSON.stringify({token:N,name:h.name,privacy:h.privacy,description:h.description})}).then(e=>e.json()).then(e=>{v(!1),e.status&&(u(e.data),I(e.data))})):Tt("vibebp").addNotification({text:window.wplms_course_data.translations.missing_data})}},window.wplms_create_course_data.translations.create_group)):Ot(zt,null,Ot("div",null,Ot("a",{className:"link",onClick:()=>{p("select")}},Ot("i",{className:"vicon vicon-user"})," ",window.wplms_create_course_data.translations.select_group),Ot("a",{class:"link",onClick:()=>{p("create")}},Ot("i",{class:"vicon vicon-user"})," ",window.wplms_create_course_data.translations.create_group)))):n.value?Ot("div",{className:"course_group"},k?Ot(Ze,null):Ot(zt,null,Ot("span",{className:"vicon vicon-pencil-alt",onClick:()=>{s(!0)}}),Ot("img",{src:g.image}),Ot("strong",null,Ot("span",null,window.wplms_create_course_data.translations[g.status]),g.title),Ot("p",null,g.description),Ot("div",{className:"group_meta"},Ot("span",null,Ot("span",{className:"vicon vicon-users"}),g.member_count),Ot("span",null,Ot("span",{className:"vicon vicon-time"}),Ot(Ct,{timestamp:g.last_activity}))))):Ot("span",{onClick:()=>{s(!0)}},Ot("span",{className:"vicon vicon-user"}),Ot("strong",null,n.label)))};const{createElement:Lt,render:Ht,useState:At,useEffect:Ft,useContext:Dt,Fragment:Rt}=wp.element,{select:Jt,dispatch:Bt}=wp.data;var $t=e=>{const{dispatch:t,select:a}=wp.data;let s=a("vibebp").getUser();s.token=a("vibebp").getToken();const n=Dt(y),[i,o]=At(!1),[r,l]=At(e.field),[c,d]=At(!1),[u,m]=At(""),[p,_]=At({}),[v,h]=At(!1),[w,g]=At({}),[b,k]=At({}),[x,N]=At(!1),I=a("vibebp").getToken();Ft(()=>{e.field&&e.field.hasOwnProperty("show_value")&&_(e.field.show_value),l(e.field),m("forum")},[e.field]),Ft(()=>{if(r.hasOwnProperty("value")&&r.value){d(!0);let e=r.value;"object"==typeof r.value&&(e=r.value.id),fetch(window.wplms_create_course_data.api_url+"/component/get_forum/",{method:"post",body:JSON.stringify({token:I,id:e})}).then(e=>e.json()).then(e=>{d(!1),o(!1),e.status?k(e.forum):t("vibebp").addNotification({text:e.message})})}},[r.value]);const C=(t=null)=>{p&&p.id&&f(t)&&(t=p);let a={...r};a.value||(a.value={}),a.value=t,n.update({field:a,index:e.fieldIndex},"fieldvaluechanged")},O=(e,t)=>{let a={...w};a[e]=t,console.log(a),g(a)};return Lt("div",{className:"courseforums unit_field"},i?Lt(Rt,null,Lt("div",{className:"add_cpt"},v?Lt("span",null,Lt("span",{className:"vicon vicon-arrow-left",onClick:()=>h(!1)}),Lt("span",{className:"vicon vicon-close",onClick:()=>o(!1)})):"","select"==v?Lt("div",{className:"select_existing_cpt"},Lt(rt,{field:{cpt:u},update:(e,t)=>{"fieldvaluechanged"==t&&_(e.show_value)}}),Lt("div",null,Lt("a",{class:"use_selected_curriculum is-primary  button",onClick:()=>{C()}},"Set ",u))):"create"==v?Lt("div",{className:"new_cpt"},Lt("input",{type:"text",className:"form_field vibe_curriculum_title",value:w.name,placeholder:u+" title",onChange:e=>{O("name",e.target.value)}}),Lt("select",{onChange:e=>{O("privacy",e.target.value)}},r.privacy_options&&r.privacy_options.length?r.privacy_options.map((e,t)=>{let a=!1;return e.value===w.privacy&&(a=!0),Lt("option",{value:e.value,selected:a},e.label)}):""),Lt("textarea",{value:w.description,onChange:e=>{O("description",e.target.value)},placeholder:window.wplms_create_course_data.translations.description},w.description),Lt("a",{className:x?"is-loading button is-primary create_new_curriculum":"button  is-primary create_new_curriculum",onClick:()=>{var e;e=u,w&&w.name.length&&(N(!0),fetch(`${window.wplms_create_course_data.api_url}/create/component/${e}`,{method:"post",body:JSON.stringify({token:s.token,...w})}).then(e=>e.json()).then(e=>{N(!1),e.status&&(_(e.data),o(!1),C(e.data))}))}},window.wplms_create_course_data.translations.create_forum)):Lt(Rt,null,Lt("div",null,Lt("a",{className:"link",onClick:()=>{h("select")}},Lt("i",{className:"vicon vicon-comments"})," ",window.wplms_create_course_data.translations.select_forum),Lt("a",{class:"link",onClick:()=>{h("create")}},Lt("i",{class:"vicon vicon-comment"})," ",window.wplms_create_course_data.translations.create_forum))))):r.value?Lt("div",{className:"course_forum"},c?Lt(Ze,null):Lt(Rt,null,Lt("div",null,Lt("span",{className:"vicon vicon-pencil-alt",onClick:()=>{o(!0)}}),Lt("strong",null,Lt("span",null,b.private?window.wplms_create_course_data.translations.private:window.wplms_create_course_data.translations.public),b.title),Lt("p",null,b.description)),Lt("div",{className:"forum_meta"},Lt("span",null,Lt("span",{className:"vicon vicon-comments"})," ",b.topic_count),Lt("span",null,Lt("span",{className:"vicon vicon-time"}),"  ",b.last_active)))):Lt("span",{onClick:()=>{o(!0)}},Lt("span",{className:"vicon vicon-comments"}),Lt("strong",null,r.label)))};const{createElement:Ut,render:Vt,useState:Wt,useEffect:Yt,useContext:Xt,Fragment:Qt}=wp.element,{dispatch:Kt,select:Gt}=wp.data;var Zt=e=>{let t=Gt("vibebp").getUser();t.token=Gt("vibebp").getToken();const a=Xt(y),[s,n]=Wt(e.field),[i,o]=Wt(!1),[r,l]=Wt(!1),[c,d]=Wt(!1),[u,m]=Wt(!1),[p,_]=Wt(!1),[v,h]=Wt({});Yt(()=>{let t={...e.field};!f(e.field.value)&&f(e.field.show_value)?s.value!==e.field.value&&(l(!0),fetch(`${window.wplms_create_course_data.api_url}/selectcpt/${t.cpt}`,{method:"post",body:JSON.stringify({field:e.field,token:Gt("vibebp").getToken()})}).then(e=>e.json()).then(e=>{l(!1),e.status?(t.show_value=e.posts.show_value,n(t)):(t.value=0,e.hasOwnProperty("message")&&Kt("vibebp").setNotification({text:e.message}),n(t))})):(t.hasOwnProperty("is_bundle")&&t.is_bundle&&_(!0),n(t))},[e.field]);const w=(t,i)=>{let r={...s};"fieldvaluechanged"==i&&(r.value=t.show_value.id,r.show_value=t.show_value,"bundle"==c?(_(!0),r.is_bundle=!0):(_(!1),r.is_bundle=!1),Object.keys(t.show_value.fields).map((e,a)=>{if("meta"==e)t.show_value.fields.meta.map(e=>{r.fields.findIndex(t=>t.id==e.meta_key)>-1&&(r.fields[r.fields.findIndex(t=>t.id==e.meta_key)].value=e.meta_value)});else{let a=r.fields.findIndex(t=>t.id==e);a>-1?r.fields[a].value=t.show_value.fields[e]:r.fields.push({id:e,value:t.show_value.fields[e]})}})),a.update({field:r,index:e.fieldIndex},"fieldvaluechanged"),n(r),o(!1)},g=e=>{console.log(s.fields.findIndex(t=>t.id==e.field.id),s,e);let t={...s};t.fields[s.fields.findIndex(t=>t.id==e.field.id)]=e.field,n(t)};return Ut("div",{className:"course_product_price"},i?Ut(Qt,null,Ut("span",{className:"vicon vicon-arrow-left",onClick:()=>{o(!1)}}),Ut("div",{className:"add_cpt"},"create"!=c&&"bundle"!=c?Ut("div",{className:"select_cpt_wrapper"},"select"==c?Ut("div",{className:"select_existing_cpt"},Ut(rt,{field:{cpt:s.cpt},update:e=>{h(e)}}),Ut("div",{className:"selectcptactions"},Ut("a",{className:"button is-primary",onClick:()=>{w(v,"fieldvaluechanged")}},Ut("i",{class:"vicon vicon-plus"})," ",window.wplms_create_course_data.translations.add_cpt.product.add),Ut("a",{className:"link",onClick:()=>{d(!1)}},window.wplms_create_course_data.translations.cancel))):Ut("a",{onClick:()=>{d("select")}},Ut("i",{className:"vicon vicon-search"})," ",window.wplms_create_course_data.translations.add_cpt.product.search)):"","select"!=c&&"bundle"!=c?Ut("div",{className:"create_cpt_wrapper"},"create"==c?Ut("div",{className:"new_cpt_wrapper"},Ut("div",{className:"new_cpt_wrapper"},s.fields.map((e,t)=>{if(!e.hasOwnProperty("is_child")||!e.is_child)return Ut(Qt,null,Ut(Zd,{field:e,fieldIndex:t,update:g}),e.hasOwnProperty("children")&&e.children.length&&!f(e.value)&&"H"!=e.value?e.children.map(e=>{let t=s.fields.findIndex(t=>t&&t.hasOwnProperty("id")&&t.id==e);return Ut(Zd,{field:s.fields[t],fieldIndex:t,update:g})}):"")})),Ut("div",null,Ut("a",{className:u?"button is-primary is-loading":"button is-primary",onClick:()=>{(()=>{let n={...s};m(!0);let i={post_title:"",meta:[]};if(n.hasOwnProperty("show_value")&&!f(n.show_value)&&n.show_value.hasOwnProperty("id"))i={id:n.show_value.id,meta:[]};else{let e=a.course[0].fields;void 0===e[e.findIndex(e=>"post_title"==e.id)].value&&(m(!1),Kt("vibebp").addNotification({text:window.wplms_create_course_data.translations.missing_title})),i={post_title:e[e.findIndex(e=>"post_title"==e.id)].value,post_content:e[e.findIndex(e=>"post_content"==e.id)].value,meta:[]}}s.fields.map(e=>{"meta"==e.from&&i.meta.push({meta_key:e.id,meta_value:e.value})}),fetch(`${window.wplms_create_course_data.api_url}/createElement/${n.cpt}`,{method:"post",body:JSON.stringify({...i,token:t.token})}).then(e=>e.json()).then(t=>{m(!1),t.status?(n.value=t.data.id,n.hasOwnProperty("show_value")||(n.show_value={}),n.show_value=t.data,_(!1),n.is_bundle=!1,a.update({field:n,index:e.fieldIndex},"fieldvaluechanged"),o(!1)):t.hasOwnProperty("message")&&Kt("vibebp").addNotification({text:t.message})})})()}},window.wplms_create_course_data.translations.add_cpt.product.create),Ut("a",{className:"link",onClick:()=>{d(!1)}},window.wplms_create_course_data.translations.cancel))):Ut("a",{class:"more",onClick:()=>{d("create")}},Ut("i",{class:"vicon vicon-plus"}),window.wplms_create_course_data.translations.add_cpt.product.create)):"","create"!=c&&"select"!=c&&t.hasOwnProperty("caps")&&!f(t.caps)&&t.caps.hasOwnProperty("manage_options")&&t.caps.manage_options?Ut("div",{className:"select_cpt_wrapper"},"bundle"==c?Ut("div",{className:"select_existing_cpt"},Ut(rt,{field:{cpt:"product"},update:e=>{h(e)}}),Ut("div",{className:"selectcptactions"},Ut("a",{className:"button is-primary",onClick:()=>{w(v,"fieldvaluechanged")}},Ut("i",{class:"vicon vicon-plus"})," ",window.wplms_create_course_data.translations.add_cpt.product.add),Ut("a",{className:"link",onClick:()=>{d(!1)}},window.wplms_create_course_data.translations.cancel))):Ut("a",{onClick:()=>{d("bundle")}},Ut("i",{className:"vicon vicon-bag"})," ",window.wplms_create_course_data.translations.add_cpt.product.add_bundle)):"")):f(s.value)?Ut("span",null,window.wplms_create_course_data.translations.no_price,Ut("span",{onClick:()=>{o(!0)},className:"vicon vicon-pencil"})):Ut("div",{className:"product_price_wrapper"},r?Ut(Ze,null):s.hasOwnProperty("show_value")?Ut("div",null,Ut("div",null,Ut("div",{className:"product_price",dangerouslySetInnerHTML:{__html:s.show_value.text}}),p?Ut("a",{class:"tag link",target:"_blank",href:s.hasOwnProperty("show_value")&&s.show_value.hasOwnProperty("link")?s.show_value.link:"#"},window.wplms_create_course_data.translations.add_cpt.product.bundle):""),Ut("span",null,Ut("span",{onClick:()=>{o(!0),d("create")},className:"vicon vicon-pencil"}),Ut("span",{onClick:()=>{let t={...s};t.value=null,t.show_value=null,_(!1),t.is_bundle=!1,d(!0),a.update({field:t,index:e.fieldIndex},"fieldvaluechanged")},className:"vicon vicon-trash"}))):Ut("span",null,window.wplms_create_course_data.translations.no_price,Ut("span",{onClick:()=>{o(!0)},className:"vicon vicon-pencil"}))))};const{createElement:ea,render:ta,useState:aa,useEffect:sa,useContext:na,Fragment:ia}=wp.element;var oa=(e,t="#0b0000",a="#fff")=>"truefalse"==e?ea("svg",{xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:"2",clipRule:"evenodd",viewBox:"0 0 100 100"},ea("path",{fill:t,d:"M95.833 27.083c0-12.648-10.268-22.916-22.916-22.916H27.083c-12.648 0-22.916 10.268-22.916 22.916v45.834c0 12.648 10.268 22.916 22.916 22.916h45.834c12.648 0 22.916-10.268 22.916-22.916V27.083z"}),ea("path",{fill:a,fillRule:"nonzero",d:"M10.863 48.264c4.794.998 10.959 2.93 15.625 5.969 5.481-7.344 15.327-14.214 26.042-19.858-10.175 10.026-18.595 21.403-24.305 32.842-4.603-6.538-9.631-12.623-17.362-18.953z"}),ea("clipPath",{id:"a"},ea("path",{d:"M52.522 33.333H85.85499999999999V66.666H52.522z"})),ea("g",{"clip-path":"url(#a)"},ea("path",{fill:a,fillRule:"nonzero",d:"M85.856 61.372L74.307 49.971l11.389-11.503-5.135-5.135-11.405 11.553-11.542-11.393-5.092 5.092 11.557 11.444-11.397 11.546 5.092 5.092 11.44-11.553 11.507 11.393 5.135-5.135z"}))):"single"==e?ea("svg",{xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:"2",clipRule:"evenodd",viewBox:"0 0 100 100"},ea("path",{fill:t,d:"M95.833 27.083c0-12.648-10.268-22.916-22.916-22.916H27.083c-12.648 0-22.916 10.268-22.916 22.916v45.834c0 12.648 10.268 22.916 22.916 22.916h45.834c12.648 0 22.916-10.268 22.916-22.916V27.083z"}),ea("g",{fill:a},ea("path",{d:"M18.75 22.917H31.25V35.417H18.75z"}),ea("path",{d:"M39.583 22.917H81.25V35.417H39.583z"}),ea("path",{d:"M39.583 43.75H81.25V56.25H39.583z"}),ea("path",{d:"M18.75 64.583H31.25V77.083H18.75z"}),ea("path",{d:"M39.583 64.583H81.25V77.083H39.583z"})),ea("path",{fill:a,fillRule:"nonzero",d:"M19.197 48.031c1.438.299 3.287.879 4.687 1.79 1.645-2.203 4.598-4.264 7.813-5.957-3.053 3.008-5.579 6.421-7.292 9.853-1.381-1.962-2.889-3.787-5.208-5.686z"})):"multiple"==e?ea("svg",{xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:"2",clipRule:"evenodd",viewBox:"0 0 100 100"},ea("path",{fill:t,d:"M95.833 27.083c0-12.648-10.268-22.916-22.916-22.916H27.083c-12.648 0-22.916 10.268-22.916 22.916v45.834c0 12.648 10.268 22.916 22.916 22.916h45.834c12.648 0 22.916-10.268 22.916-22.916V27.083z"}),ea("g",{fill:a},ea("path",{d:"M39.583 22.917H81.25V35.417H39.583z"}),ea("path",{d:"M39.583 43.75H81.25V56.25H39.583z"}),ea("path",{d:"M18.75 64.583H31.25V77.083H18.75z"}),ea("path",{d:"M39.583 64.583H81.25V77.083H39.583z"})),ea("path",{fill:a,fillRule:"nonzero",d:"M19.197 48.031c1.438.299 3.287.879 4.687 1.79 1.645-2.203 4.598-4.264 7.813-5.957-3.053 3.008-5.579 6.421-7.292 9.853-1.381-1.962-2.889-3.787-5.208-5.686zM19.197 27.197c1.438.3 3.287.88 4.687 1.791 1.645-2.203 4.598-4.264 7.813-5.957-3.053 3.008-5.579 6.421-7.292 9.852-1.381-1.961-2.889-3.787-5.208-5.686z"})):"match"==e?ea("svg",{xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:"2",clipRule:"evenodd",viewBox:"0 0 100 100"},ea("path",{fill:t,d:"M95.833 27.083c0-12.648-10.268-22.916-22.916-22.916H27.083c-12.648 0-22.916 10.268-22.916 22.916v45.834c0 12.648 10.268 22.916 22.916 22.916h45.834c12.648 0 22.916-10.268 22.916-22.916V27.083z"}),ea("g",{fill:a},ea("path",{d:"M56.25 22.917H81.25V35.417H56.25z"}),ea("path",{d:"M18.75 22.917H43.75V35.417H18.75z"}),ea("path",{d:"M56.25 43.75H81.25V56.25H56.25z"}),ea("path",{d:"M18.75 43.75H43.75V56.25H18.75z"}),ea("path",{d:"M56.25 64.583H81.25V77.083H56.25z"}),ea("path",{d:"M18.75 64.583H43.75V77.083H18.75z"})),ea("path",{fill:"#ddddd7",d:"M45.833 51.458v2.709L41.667 50l4.166-4.167v2.709h8.334v-2.709L58.333 50l-4.166 4.167v-2.709h-8.334zM45.833 30.625v2.708l-4.166-4.166L45.833 25v2.708h8.334V25l4.166 4.167-4.166 4.166v-2.708h-8.334zM45.833 72.292V75l-4.166-4.167 4.166-4.166v2.708h8.334v-2.708l4.166 4.166L54.167 75v-2.708h-8.334z"})):"fillblank"==e?ea("svg",{xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"1.5",clipRule:"evenodd",viewBox:"0 0 100 100"},ea("path",{fill:t,d:"M95.833 27.083c0-12.648-10.268-22.916-22.916-22.916H27.083c-12.648 0-22.916 10.268-22.916 22.916v45.834c0 12.648 10.268 22.916 22.916 22.916h45.834c12.648 0 22.916-10.268 22.916-22.916V27.083z"}),ea("path",{d:"M72.912 37.502l-6.243-8.34 12.505.014-6.262 8.326z"}),ea("path",{fill:a,stroke:a,strokeWidth:"0.21",d:"M16.667 66.667H87.5V70.834H16.667z"}),ea("text",{x:"13.936",y:"55.838",fill:a,fontFamily:"'VentiCF-Black', 'Venti CF'",fontSize:"41.667",fontWeight:"900"},"FILL")):"select"==e?ea("svg",{xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"1.5",clipRule:"evenodd",viewBox:"0 0 100 100"},ea("path",{fill:t,d:"M95.833 27.083c0-12.648-10.268-22.916-22.916-22.916H27.083c-12.648 0-22.916 10.268-22.916 22.916v45.834c0 12.648 10.268 22.916 22.916 22.916h45.834c12.648 0 22.916-10.268 22.916-22.916V27.083z"}),ea("path",{fill:"#ddddd7",d:"M20.833 25H83.333V41.667H20.833z"}),ea("path",{d:"M72.912 37.502l-6.243-8.34 12.505.014-6.262 8.326z"}),ea("path",{fill:a,stroke:a,strokeWidth:"0.21",d:"M20.833 41.667H83.333V54.167H20.833z"}),ea("path",{fill:a,stroke:a,strokeWidth:"0.21",d:"M20.833 54.167H83.333V66.667H20.833z"})):"sort"==e?ea("svg",{xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:"2",clipRule:"evenodd",viewBox:"0 0 100 100"},ea("path",{fill:t,d:"M95.833 27.083c0-12.648-10.268-22.916-22.916-22.916H27.083c-12.648 0-22.916 10.268-22.916 22.916v45.834c0 12.648 10.268 22.916 22.916 22.916h45.834c12.648 0 22.916-10.268 22.916-22.916V27.083z"}),ea("g",{fill:a},ea("path",{d:"M39.583 22.917H81.25V35.417H39.583z"}),ea("path",{fillOpacity:"0.72",d:"M39.583 43.75H81.25V56.25H39.583z"}),ea("path",{d:"M35.417 39.583H77.084V52.083H35.417z"}),ea("path",{d:"M39.583 64.583H81.25V77.083H39.583z"})),ea("g",{fill:a},ea("path",{d:"M22.917 39.583l6.25 8.334h-12.5l6.25-8.334zM22.949 60.417l-6.314-8.286 12.5-.095-6.186 8.381z"}))):"smalltext"==e?ea("svg",{xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:"2",clipRule:"evenodd",viewBox:"0 0 100 100"},ea("path",{fill:t,d:"M95.833 27.083c0-12.648-10.268-22.916-22.916-22.916H27.083c-12.648 0-22.916 10.268-22.916 22.916v45.834c0 12.648 10.268 22.916 22.916 22.916h45.834c12.648 0 22.916-10.268 22.916-22.916V27.083z"}),ea("path",{d:"M72.912 37.502l-6.243-8.34 12.505.014-6.262 8.326z"}),ea("path",{d:"M12.5 29.167H87.5V66.667H12.5z"}),ea("path",{fill:a,d:"M87.5 66.667h-75v-37.5h75v37.5zm-72.5-35v32.5h70v-32.5H15z"}),ea("text",{x:"17.547",y:"57.204",fill:a,fontFamily:"'VentiCF-Black', 'Venti CF'",fontSize:"29.167",fontWeight:"900"},"TEXT")):"largetext"==e?ea("svg",{xmlns:"http://www.w3.org/2000/svg",fillRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:"2",clipRule:"evenodd",viewBox:"0 0 100 100"},ea("path",{fill:t,d:"M95.833 27.083c0-12.648-10.268-22.916-22.916-22.916H27.083c-12.648 0-22.916 10.268-22.916 22.916v45.834c0 12.648 10.268 22.916 22.916 22.916h45.834c12.648 0 22.916-10.268 22.916-22.916V27.083z"}),ea("path",{d:"M72.912 37.502l-6.243-8.34 12.505.014-6.262 8.326z"}),ea("path",{d:"M12.5 25H87.5V79.167H12.5z"}),ea("path",{fill:a,d:"M87.5 79.167h-75V25h75v54.167zm-72.5-2.5h70V27.5H15v49.167z"}),ea("g",{fill:a,fontFamily:"'VentiCF-Black', 'Venti CF'",fontSize:"7",fontWeight:"900"},ea("text",{x:"8.211",y:"11.729",transform:"translate(-16.667 -4.843) scale(4.16667)"},"...."),ea("text",{x:"8.211",y:"13.729",transform:"translate(-16.667 -4.843) scale(4.16667)"},"....."),ea("text",{x:"8.211",y:"15.729",transform:"translate(-16.667 -4.843) scale(4.16667)"},"......."))):ea("div",{className:e});const{createElement:ra,render:la,useState:ca,useEffect:da,useContext:ua,Fragment:ma,RawHTML:pa}=wp.element,{dispatch:_a,select:va}=wp.data;var ha=e=>{let t=va("vibebp").getUser();t.token=va("vibebp").getToken();ua(y);const[a,s]=ca(!1),[n,i]=ca(e.field),[o,r]=ca({}),[l,c]=ca(-1),[d,u]=ca(!1);da(()=>{i(e.field),s(!0),e.field.hasOwnProperty("data")&&e.field.data&&r(e.question.buttons.question_types[e.question.buttons.question_types.findIndex(t=>t.value==e.field.data.type)].fields)},[e.field]);const m=(e,t)=>{if(console.log(e,t),"fieldvaluechanged"==t){let t=[...o];t[t.findIndex(t=>t.id==e.field.id)]=e.field,r(t)}};return a?ra(ma,null,ra("div",{className:"question_block"},ra("div",{className:"question_heading"},ra("strong",{className:"title"},ra("span",null,oa(n.data.type))," ",n.data.text),ra("ul",{className:"data_links"},ra("li",null,ra("a",{className:"edit",title:"Edit Question",onClick:a=>{var s;s=n.data.id,fetch(window.wplms_create_course_data.api_url+"/curriculum/getElementFields/",{method:"post",body:JSON.stringify({type:n.type,id:s,fields:o,token:t.token})}).then(e=>e.json()).then(t=>{t.status&&(r(t.fields),c(e.index))})}},ra("span",{className:"vicon vicon-pencil-alt"}))),ra("li",null,ra("a",{className:"remove",title:"Remove",onClick:t=>{e.update({index:e.index,question:n},"questionremoved")}},ra("span",{className:"vicon vicon-close"}))))),ra("div",{className:"question_marks"},ra("input",{type:"number",className:"small_box question_marks",onChange:t=>{let a={...n};a.marks=parseInt(t.target.value),e.update({field:a,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex,index:e.index},"fieldvaluechanged")},value:n.marks?n.marks:"",placeholder:window.wplms_create_course_data.translations.enter_question_marks}))),o.length&&l>-1?ra("div",{className:"question_wrapper"},ra("div",{className:"list-group"},o.map((t,a)=>ra("div",{className:"list-group-item"},ra(Zd,{question:e.question,field:t,fieldIndex:a,tabIndex:e.fieldIndex,update:m,cindex:e.cindex,aindex:e.index,index:a})))),ra("div",{className:"question_actions"},ra("a",{className:d?"button is-primary is-loading":"button is-primary",onClick:()=>{let t={post_title:"",post_content:"",meta:[],taxonomy:[]};o.map(e=>{if("post"==e.from)if("post_content"==e.id){if(t[e.id]=e.value,e.hasOwnProperty("raw")&&e.raw){let a=t.meta.findIndex(e=>"raw"==e.meta_key);a>-1?t.meta[a].meta_value=e.raw:t.meta.push({meta_key:"raw",meta_value:e.raw})}}else t[e.id]=e.value;if("meta"==e.from){let a=t.meta.findIndex(t=>t.meta_key==e.id);if(a>-1?t.meta[a].meta_value=e.value:t.meta.push({meta_key:e.id,meta_value:e.value}),"editor"==e.type&&e.hasOwnProperty("raw")){let a=t.meta.findIndex(t=>t.meta_key==e.id+"_raw");a>-1?t.meta[a].meta_value=e.raw:t.meta.push({meta_key:e.id+"_raw",meta_value:e.raw})}}if("taxonomy"==e.from){let a=t.taxonomy.findIndex(t=>t.taxonomy==e.id);a>-1?t.taxonomy[a].value=e.value:t.taxonomy.push({taxonomy:e.id,value:e.value})}}),fetch(`${window.wplms_create_course_data.api_url}/createElement/${n.type}`,{method:"post",body:JSON.stringify({type:n.type,id:n.data.id,...t,token:va("vibebp").getToken()})}).then(e=>e.json()).then(a=>{if(u(!1),a.status){_a("vibebp").addNotification({text:a.text});let s={...n};s.data.text=t.post_title,e.update({field:s,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex,index:e.index},"fieldvaluechanged"),c(-1)}})}},window.wplms_create_course_data.translations.save),ra("a",{className:"link",onClick:()=>{c(-1)}},window.wplms_create_course_data.translations.cancel))):""):""};const{createElement:wa,render:fa,useState:ga,useEffect:ya,useContext:ba,Fragment:ka,RawHTML:xa}=wp.element,{dispatch:Na,select:Ia}=wp.data;var Ca=e=>{const[t,a]=ga(e.field),[s,n]=ga(""),[i,o]=ga([]),[r,l]=ga([]),[c,d]=ga(!1),[u,m]=ga(!1),[p,_]=ga(!1);let v=Ia("vibebp").getUser();v.token=Ia("vibebp").getToken(),ya(()=>{a(e.field),_(!0)},[e.field]),ya(()=>{let s={...t},n=[];r&&r.length?(r.map(e=>{n.push(e.id)}),s.value=n,a(s),e.update(s,e.fieldIndex,"fieldvaluechanged")):(s.value=n,a(s),e.update(s,e.fieldIndex,"fieldvaluechanged"))},[r]),ya(()=>{d(!0);let a="",s="";t.taxonomy&&(a=t.taxonomy,s="taxonomy"),fetch(window.wplms_create_course_data.api_url+"/taxonomy/",{method:"post",body:JSON.stringify({taxonomy:t.taxonomy,token:v.token})}).then(e=>e.json()).then(t=>{t.status&&Array.isArray(t.posts)&&(t.posts.map(e=>{localStorage.setItem("post_"+e.id,JSON.stringify(e))}),e.field.hasOwnProperty("value")&&t.posts.length&&e.field.value.length&&l(t.posts.filter(t=>(e.field.value.indexOf(t.id)>-1||e.field.value.indexOf(t.id.toString())>-1)&&-1===r.findIndex(e=>e.id==t.id))),o(t.posts)),d(!1)})},[p]);let w=[...i];return s.length&&(w=i.filter(e=>e.text.indexOf(s)>-1)),wa("div",{className:"taxonomy_field"},r.length?wa("div",{className:"selected_term_list_wrapper"},wa("div",{className:"selected_term_list"},r.map((e,a)=>{let s=t.cpt?t.taxonomy:"";return"number"==typeof e.id?wa("div",{className:"term_select"},wa("span",{type:s,onClick:()=>{let t=[...r],s=[...i];t.splice(a,1),s.push(e),o(s),l(t)}},e.text)):wa("div",{className:"term_select"},wa("input",{type:"text",value:r[a].id.split("new_")[1],placeholder:window.wplms_create_course_data.translations.type_here,onChange:e=>{let t=[...r];t[a]={id:"new_"+e.target.value},l(t)}}),wa("span",{className:"vicon vicon-close",onClick:()=>{let e=[...r];a>-1&&e.splice(a,1),l(e)}}))}))):"",wa("div",{className:"term_select"},wa("div",{class:"term_select_label",onClick:()=>{m(!u)}},t.label,wa("i",u?{class:"vicon vicon-angle-down","aria-hidden":"true"}:{class:"vicon vicon-plus","aria-hidden":"true"})),u?wa("div",{className:"search_term_list"},wa("div",{className:"search_term",onClick:()=>{let e=[...r];e.push({id:"new_"}),l(e),m(!1)}},wa("span",null,window.wplms_create_course_data.translations.add_new)),i.length>8?wa("div",{className:"searchbox"},wa("input",{type:"text",value:s,onChange:e=>n(e.target.value)}),wa("span",{className:"vicon vicon-search"})):"",w.length?wa(ka,null,w.map((e,t)=>{if(-1===h(e,r))return wa("div",{className:"search_term",onClick:()=>{n("");let a=[...r];-1===h(e,a)&&(a.push(e),i.splice(t,1),l(a),m(!1))}},wa("span",null,e.text))})):""):""))};const{createElement:Oa,render:Sa,useState:qa,useEffect:Pa,useContext:Ea,Fragment:za,useRef:Ta}=wp.element,{dispatch:Ma,select:ja}=wp.data;var La=e=>{const t=Ea(y),[a,s]=qa({}),[n,i]=qa(!1),[o,r]=qa(!1),[l,c]=qa("question"),[d,u]=qa({post_content:"",raw:[]}),[m,p]=qa({meta_key:"vibe_question_explaination",meta_value:"",raw:[]}),[_,v]=qa({ID:"",post_title:"",post_content:"",taxonomy:[{taxonomy:"question-tag",value:[]}],meta:[{meta_key:"vibe_question_type",meta_value:""}]}),[h,w]=qa({}),[g,b]=qa(!1),[k,x]=qa("");ja("vibebp").getUser().token=ja("vibebp").getToken();const N=Ta(null);Pa(()=>{if("object"==typeof e.field.value&&e.field.value.hasOwnProperty("ques")&&e.field.value.ques.length){let t={...e.field};fetch(window.wplms_create_course_data.api_url+"/getQuizQuestions",{method:"post",body:JSON.stringify({questions:e.field.value.ques,token:ja("vibebp").getToken()})}).then(e=>e.json()).then(a=>{a.status&&(t.value=[],a.questions.map((a,s)=>{t.value.push({type:"question",data:a,marks:e.field.value.marks[s]})})),r(!0),s(t),e.update(t,e.fieldIndex,"fieldvaluechanged"),console.log()})}else e.field.hasOwnProperty("value")&&Array.isArray(e.field.value)&&e.field.value.length||(e.field.value=[]),s(e.field),r(!0)},[e.field]);const I=(n,i)=>{let o={...a};console.log("SetQuestionValue",n,i),"fieldvaluechanged"==i&&(o.value[n.index]=n.field,s(o),e.update(o,e.fieldIndex,"fieldvaluechanged"),t.update({field:o,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex},"curriculumchangedunitdata")),"questionremoved"==i&&(n.hasOwnProperty("index")&&o.value.splice(n.index,1),s(o),e.update(o,e.fieldIndex,"fieldvaluechanged"),t.update({field:o,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex},"curriculumchangedunitdata"))},C=(e,t)=>{"fieldvaluechanged"==t&&w(e.show_value)},O=(n,i=null)=>{let o={};f(i)&&h&&h.id&&(i=h),o={type:n,data:i,marks:0};let r={...a};f(r.value)&&(r.value=[]),r.value.push(o),t.update({field:r,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex},"curriculumchangedunitdata"),v({ID:"",post_title:"",post_content:"",taxonomy:[{taxonomy:"question-tag",value:[]}],meta:[{meta_key:"vibe_question_type",meta_value:""}]}),p({meta_key:"vibe_question_explaination",meta_value:"",raw:[]}),s(r),e.update(r,e.fieldIndex,"fieldvaluechanged")},S=(e,t,a=null)=>{console.log(e);let s=e.field,n={..._};if("taxonomy"==s.type){let e=n.taxonomy.findIndex(e=>e.taxonomy==s.taxonomy);-1==e?n.taxonomy.push({taxonomy:s.taxonomy,value:s.value}):n.taxonomy[e].value=s.value}else{if("post_content"==s.id&&s.value.length)return void u({post_content:s.value,raw:s.raw});if("vibe_question_explaination"==s.id&&s.value.length)return void p({meta_key:"vibe_question_explaination",meta_value:s.value,raw:s.raw});if("post"==s.from&&(n[s.id]=s.value),"meta"==s.from)if("duration"==s.type){let e=n.meta.findIndex(e=>e.meta_key==s.id);e>-1?n.meta[e].meta_value=s.value.value:n.meta.push({meta_key:s.id,meta_value:s.value.value});let t=n.meta.findIndex(e=>e.meta_key==s.id+"_parameter");t>-1?n.meta[t].meta_value=s.value.parameter:n.meta.push({meta_key:s.id,meta_value:s.value.parameter})}else{let e=n.meta.findIndex(e=>e.meta_key==s.id);e>-1?n.meta[e].meta_value=s.value:n.meta.push({meta_key:s.id,meta_value:s.value}),"editor"==s.type&&s.hasOwnProperty("raw")&&(e=n.meta.findIndex(e=>e.meta_key==s.id+"_raw"),e>-1?n.meta[e].meta_value=s.raw:n.meta.push({meta_key:s.id+"_raw",meta_value:s.raw}))}}v(n)};return o?Oa(za,null,Oa("div",{className:"unitquestions unit_field"},a&&a.value&&a.value.length?a.value.map((t,s)=>Oa("div",{className:"question_block_wrapper"},Oa(ha,{question:a,field:t,fieldIndex:e.fieldIndex,cindex:e.cindex,index:s,update:I,tabIndex:e.tabIndex,ufieldIndex:e.ufieldIndex}))):"",Oa("div",{className:"add_cpt"},"select"==g?Oa("div",{className:"select_existing_cpt"},Oa("span",{className:"vicon vicon-arrow-left",onClick:()=>b(!1)}),Oa(rt,{field:{cpt:l},update:C}),Object.keys(h).length?Oa("a",{class:"use_selected_curriculum button is-primary",onClick:()=>{O(l)}},Oa("i",{className:"vicon vicon-plus"})," ",window.wplms_create_course_data.translations.add_cpt.question.add):""):"upload"==g?Oa("div",{className:"upload_wrapper"},Oa("span",{className:"vicon vicon-arrow-left",onClick:()=>b(!1)}),Oa(rt,{field:{cpt:l},update:C}),Oa("div",{className:"uploadbox"},Oa("label",{for:"questions_fileupload",className:"upload_file"},Oa("input",{id:"questions_fileupload",ref:N,type:"file",onChange:e=>{}})),k?Oa("a",{className:isUploading?"is-primary button is-loading":"is-primary button"},window.wplms_create_course_data.translations.upload_file):""),Oa("a",{class:"use_selected_curriculum button is-primary",onClick:()=>{O(l)}},Oa("i",{className:"vicon vicon-plus"})," ",window.wplms_create_course_data.translations.add_cpt.question.add)):"create"==g?Oa("div",{className:"new_cpt"},Oa("span",{className:"vicon vicon-arrow-left",onClick:()=>b(!1)}),Oa("div",{className:"question_type_wrapper"},_.meta.findIndex(e=>"vibe_question_type"==e.meta_key)>-1?a.buttons.question_types.map((e,t)=>Oa("div",{className:e.value==_.meta[_.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value?"question_type active":"question_type",onClick:()=>{let t={..._},a=t.meta.findIndex(e=>"vibe_question_type"==e.meta_key);t.meta[a].meta_value=e.value,v(t)}},Oa("span",null,e.value==_.meta[_.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value?oa(e.value,"#00A1FF","#fff"):oa(e.value,"#fff","#222")),Oa("span",null,e.label))):""),_.meta[_.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value.length?Oa(za,null,a.buttons.question_types[a.buttons.question_types.findIndex(e=>e.value==_.meta[_.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value)].fields.map((e,a)=>Oa(Zd,{field:e,fieldIndex:a,update:S,tabIndex:t.activeTab})),Oa("div",{className:"question_actions"},Oa("a",{onClick:()=>{if(_.post_title.length){i(!0);let e={..._};m.meta_value.length&&(e.meta.push({meta_key:m.meta_key,meta_value:m.meta_value}),e.meta.push({meta_key:m.meta_key+"_raw",meta_value:m.raw}));let t=a.buttons.question_types.findIndex(t=>t.value==e.meta[e.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value);-1!==t&&a.buttons.question_types[t].hasOwnProperty("fields")&&a.buttons.question_types[t].fields.length&&a.buttons.question_types[t].fields.map((t,a)=>{if("meta"==t.from)if("duration"==t.type){e.meta.findIndex(e=>e.meta_key==t.id)<0&&e.meta.push({meta_key:t.id,meta_value:t.value.value}),e.meta.findIndex(e=>e.meta_key==t.id+"_parameter")<0&&e.meta.push({meta_key:t.id,meta_value:t.value.parameter})}else{e.meta.findIndex(e=>e.meta_key==t.id)<0&&e.meta.push({meta_key:t.id,meta_value:t.value})}}),fetch(window.wplms_create_course_data.api_url+"/createElement/question",{method:"post",body:JSON.stringify({...e,...d,token:ja("vibebp").getToken()})}).then(e=>e.json()).then(e=>{i(!1),e.status&&(O("question",e.data),w(e.data))})}else Ma("vibebp").addNotification({text:window.wplms_create_course_data.translations.missing_data})},className:n?"button is-primary is-loading":"button is-primary"},Oa("i",{class:"vicon vicon-plus"}),window.wplms_create_course_data.translations.add_cpt.question.create),Oa("a",{className:"link",onClick:()=>{b(!1)}},window.wplms_create_course_data.translations.cancel))):""):Oa(za,null,Oa("div",{className:"add_cpt_option"},Oa("a",{onClick:()=>{b("select")}},Oa("i",{className:"vicon vicon-search"})," ",window.wplms_create_course_data.translations.add_cpt.question.search)),Oa("div",{className:"add_cpt_option"},Oa("a",{onClick:()=>{b("create")}},Oa("i",{class:"vicon vicon-plus"}),window.wplms_create_course_data.translations.add_cpt.question.create))))),Oa("span",{className:"total_marks"},window.wplms_create_course_data.translations.total_marks," ",a&&a.value&&a.value.length?a.value.reduce((e,t,s)=>parseInt(a.value[s].marks)+parseInt(e),0):0)):""};const{createElement:Ha,render:Aa,useState:Fa,useEffect:Da,useContext:Ra,Fragment:Ja,RawHTML:Ba}=wp.element,{dispatch:$a,select:Ua}=wp.data;var Va=e=>{let t=Ua("vibebp").getUser();t.token=Ua("vibebp").getToken();Ra(y);const[a,s]=Fa(!1),[n,i]=Fa(e.field),[o,r]=Fa({}),[l,c]=Fa(-1),[d,u]=Fa(!1);Da(()=>{i(e.field),s(!0),r(e.question.buttons.question_types[e.question.buttons.question_types.findIndex(t=>t.value==e.field.data.type)].fields)},[e.field]);const m=(e,t)=>{if(console.log(e,t),"fieldvaluechanged"==t){let t=[...o];t[t.findIndex(t=>t.id==e.field.id)]=e.field,r(t)}};return a?Ha(Ja,null,Ha("div",{className:"question_block"},Ha("div",{className:"question_heading"},Ha("strong",{className:"title"},Ha("span",null,oa(n.data.type))," ",n.data.text),Ha("ul",{className:"data_links"},Ha("li",null,Ha("a",{className:"edit",title:"Edit Question",onClick:a=>{var s;s=n.data.id,fetch(window.wplms_create_course_data.api_url+"/curriculum/getElementFields/",{method:"post",body:JSON.stringify({type:n.type,id:s,fields:o,token:t.token})}).then(e=>e.json()).then(t=>{t.status&&(r(t.fields),c(e.index))})}},Ha("span",{className:"vicon vicon-pencil-alt"}))),Ha("li",null,Ha("a",{className:"remove",title:"Remove",onClick:t=>{e.update({index:e.index,question:n},"questionremoved")}},Ha("span",{className:"vicon vicon-close"})))))),o.length&&l>-1?Ha("div",{className:"question_wrapper"},Ha("div",{className:"list-group"},o.map((t,a)=>Ha("div",{className:"list-group-item"},Ha(Zd,{question:e.question,field:t,fieldIndex:a,tabIndex:e.fieldIndex,update:m,cindex:e.cindex,aindex:e.index,index:a})))),Ha("div",{className:"question_actions"},Ha("a",{className:d?"button is-primary is-loading":"button is-primary",onClick:()=>{let t={post_title:"",post_content:"",meta:[],taxonomy:[]};o.map(e=>{if("post"==e.from)if("post_content"==e.id){if(t[e.id]=e.value,e.hasOwnProperty("raw")&&e.raw){let a=t.meta.findIndex(e=>"raw"==e.meta_key);a>-1?t.meta[a].meta_value=e.raw:t.meta.push({meta_key:"raw",meta_value:e.raw})}}else t[e.id]=e.value;if("meta"==e.from){let a=t.meta.findIndex(t=>t.meta_key==e.id);if(a>-1?t.meta[a].meta_value=e.value:t.meta.push({meta_key:e.id,meta_value:e.value}),"editor"==e.type&&e.hasOwnProperty("raw")){let a=t.meta.findIndex(t=>t.meta_key==e.id+"_raw");a>-1?t.meta[a].meta_value=e.raw:t.meta.push({meta_key:e.id+"_raw",meta_value:e.raw})}}if("taxonomy"==e.from){let a=t.taxonomy.findIndex(t=>t.taxonomy==e.id);a>-1?t.taxonomy[a].value=e.value:t.taxonomy.push({taxonomy:e.id,value:e.value})}}),fetch(`${window.wplms_create_course_data.api_url}/createElement/${n.type}`,{method:"post",body:JSON.stringify({type:n.type,id:n.data.id,...t,token:Ua("vibebp").getToken()})}).then(e=>e.json()).then(a=>{if(u(!1),a.status){$a("vibebp").addNotification({text:a.text});let s={...n};s.data.text=t.post_title,e.update({field:s,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex,index:e.index},"fieldvaluechanged"),c(-1)}})}},window.wplms_create_course_data.translations.save),Ha("a",{className:"link",onClick:()=>{c(-1)}},window.wplms_create_course_data.translations.cancel))):""):""};const{createElement:Wa,render:Ya,useState:Xa,useEffect:Qa,useContext:Ka,Fragment:Ga,useRef:Za}=wp.element,{dispatch:es,select:ts}=wp.data;var as=e=>{const t=Ka(y),[a,s]=Xa({}),[n,i]=Xa(!1),[o,r]=Xa(!1),[l,c]=Xa("question"),[d,u]=Xa({post_content:"",raw:[]}),[m,p]=Xa({meta_key:"vibe_question_explaination",meta_value:"",raw:[]}),[_,v]=Xa({ID:"",post_title:"",post_content:"",taxonomy:[{taxonomy:"question-tag",value:[]}],meta:[{meta_key:"vibe_question_type",meta_value:""}]}),[h,w]=Xa({}),[g,b]=Xa(!1),[k,x]=Xa("");ts("vibebp").getUser().token=ts("vibebp").getToken();const N=Za(null);Qa(()=>{if("object"==typeof e.field.value&&e.field.value.length&&"object"!=typeof e.field.value[0]){let t={...e.field};fetch(window.wplms_create_course_data.api_url+"/getQuizQuestions",{method:"post",body:JSON.stringify({questions:e.field.value,token:ts("vibebp").getToken()})}).then(e=>e.json()).then(a=>{a.status&&(t.value=[],a.questions.map((e,a)=>{t.value.push({type:"question",data:e})})),r(!0),s(t),e.update(t,e.fieldIndex,"fieldvaluechanged"),console.log()})}else e.field.hasOwnProperty("value")&&Array.isArray(e.field.value)&&e.field.value.length||(e.field.value=[]),s(e.field),r(!0)},[e.field]);const I=(n,i)=>{let o={...a};"fieldvaluechanged"==i&&(o.value[n.index]=n.field,s(o),e.update(o,e.fieldIndex,"fieldvaluechanged"),t.update({field:o,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex},"curriculumchangedunitdata")),"questionremoved"==i&&(n.hasOwnProperty("index")&&o.value.splice(n.index,1),s(o),e.update(o,e.fieldIndex,"fieldvaluechanged"),t.update({field:o,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex},"curriculumchangedunitdata"))},C=(e,t)=>{"fieldvaluechanged"==t&&w(e.show_value)},O=(n,i=null)=>{let o={};f(i)&&h&&h.id&&(i=h),o={type:n,data:i};let r={...a};f(r.value)&&(r.value=[]),r.value.push(o),t.update({field:r,ufieldIndex:e.ufieldIndex,fieldIndex:e.fieldIndex,cindex:e.cindex},"curriculumchangedunitdata"),v({ID:"",post_title:"",post_content:"",taxonomy:[{taxonomy:"question-tag",value:[]}],meta:[{meta_key:"vibe_question_type",meta_value:""}]}),p({meta_key:"vibe_question_explaination",meta_value:"",raw:[]}),s(r),e.update(r,e.fieldIndex,"fieldvaluechanged")},S=(e,t,a=null)=>{console.log(e);let s=e.field,n={..._};if("taxonomy"==s.type){let e=n.taxonomy.findIndex(e=>e.taxonomy==s.taxonomy);-1==e?n.taxonomy.push({taxonomy:s.taxonomy,value:s.value}):n.taxonomy[e].value=s.value}else{if("post_content"==s.id&&s.value.length)return void u({post_content:s.value,raw:s.raw});if("vibe_question_explaination"==s.id&&s.value.length)return void p({meta_key:"vibe_question_explaination",meta_value:s.value,raw:s.raw});if("post"==s.from&&(n[s.id]=s.value),"meta"==s.from)if("duration"==s.type){let e=n.meta.findIndex(e=>e.meta_key==s.id);e>-1?n.meta[e].meta_value=s.value.value:n.meta.push({meta_key:s.id,meta_value:s.value.value});let t=n.meta.findIndex(e=>e.meta_key==s.id+"_parameter");t>-1?n.meta[t].meta_value=s.value.parameter:n.meta.push({meta_key:s.id,meta_value:s.value.parameter})}else{let e=n.meta.findIndex(e=>e.meta_key==s.id);e>-1?n.meta[e].meta_value=s.value:n.meta.push({meta_key:s.id,meta_value:s.value}),"editor"==s.type&&s.hasOwnProperty("raw")&&(e=n.meta.findIndex(e=>e.meta_key==s.id+"_raw"),e>-1?n.meta[e].meta_value=s.raw:n.meta.push({meta_key:s.id+"_raw",meta_value:s.raw}))}}v(n)};return o?Wa("div",{className:"field_quiz_questions"},Wa("div",{className:" unitquestions unit_field"},a&&a.value&&a.value.length?a.value.map((t,s)=>Wa("div",{className:"question_block_wrapper"},Wa(Va,{question:a,field:t,fieldIndex:e.fieldIndex,cindex:e.cindex,index:s,update:I,tabIndex:e.tabIndex,ufieldIndex:e.ufieldIndex}))):"",Wa("div",{className:"add_cpt"},"select"==g?Wa("div",{className:"select_existing_cpt"},Wa("span",{className:"vicon vicon-arrow-left",onClick:()=>b(!1)}),Wa(rt,{field:{cpt:l},update:C}),Wa("a",{class:"use_selected_curriculum button is-primary",onClick:()=>{O(l)}},Wa("i",{className:"vicon vicon-plus"})," ",window.wplms_create_course_data.translations.add_cpt.question.add)):"upload"==g?Wa("div",{className:"upload_wrapper"},Wa("span",{className:"vicon vicon-arrow-left",onClick:()=>b(!1)}),Wa(rt,{field:{cpt:l},update:C}),Wa("div",{className:"uploadbox"},Wa("label",{for:"questions_fileupload",className:"upload_file"},Wa("input",{id:"questions_fileupload",ref:N,type:"file",onChange:e=>{}})),k?Wa("a",{className:isUploading?"is-primary button is-loading":"is-primary button"},window.wplms_create_course_data.translations.upload_file):""),Wa("a",{class:"use_selected_curriculum button is-primary",onClick:()=>{O(l)}},Wa("i",{className:"vicon vicon-plus"})," ",window.wplms_create_course_data.translations.add_cpt.question.add)):"create"==g?Wa("div",{className:"new_cpt"},Wa("span",{className:"vicon vicon-arrow-left",onClick:()=>b(!1)}),Wa("div",{className:"question_type_wrapper"},_.meta.findIndex(e=>"vibe_question_type"==e.meta_key)>-1?a.buttons.question_types.map((e,t)=>Wa("div",{className:e.value==_.meta[_.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value?"question_type active":"question_type",onClick:()=>{let t={..._},a=t.meta.findIndex(e=>"vibe_question_type"==e.meta_key);t.meta[a].meta_value=e.value,v(t)}},Wa("span",null,e.value==_.meta[_.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value?oa(e.value,"#00A1FF","#fff"):oa(e.value,"#fff","#222")),Wa("span",null,e.label))):""),_.meta[_.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value.length?Wa(Ga,null,a.buttons.question_types[a.buttons.question_types.findIndex(e=>e.value==_.meta[_.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value)].fields.map((e,a)=>Wa(Zd,{field:e,fieldIndex:a,update:S,tabIndex:t.activeTab})),Wa("div",{className:"question_actions"},Wa("a",{onClick:()=>{if(_.post_title.length){i(!0);let e={..._};m.meta_value.length&&(e.meta.push({meta_key:m.meta_key,meta_value:m.meta_value}),e.meta.push({meta_key:m.meta_key+"_raw",meta_value:m.raw}));let t=a.buttons.question_types.findIndex(t=>t.value==e.meta[e.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value);-1!==t&&a.buttons.question_types[t].hasOwnProperty("fields")&&a.buttons.question_types[t].fields.length&&a.buttons.question_types[t].fields.map((t,a)=>{if("meta"==t.from)if("duration"==t.type){e.meta.findIndex(e=>e.meta_key==t.id)<0&&e.meta.push({meta_key:t.id,meta_value:t.value.value}),e.meta.findIndex(e=>e.meta_key==t.id+"_parameter")<0&&e.meta.push({meta_key:t.id,meta_value:t.value.parameter})}else{e.meta.findIndex(e=>e.meta_key==t.id)<0&&e.meta.push({meta_key:t.id,meta_value:t.value})}}),fetch(window.wplms_create_course_data.api_url+"/createElement/question",{method:"post",body:JSON.stringify({...e,...d,token:ts("vibebp").getToken()})}).then(e=>e.json()).then(e=>{i(!1),e.status&&(O("question",e.data),w(e.data))})}else es("vibebp").addNotification({text:window.wplms_create_course_data.translations.missing_data})},className:n?"button is-primary is-loading":"button is-primary"},Wa("i",{class:"vicon vicon-plus"}),window.wplms_create_course_data.translations.add_cpt.question.create),Wa("a",{className:"link",onClick:()=>{b(!1)}},window.wplms_create_course_data.translations.cancel))):""):Wa(Ga,null,Wa("div",{className:"add_cpt_option"},Wa("a",{onClick:()=>{b("select")}},Wa("i",{className:"vicon vicon-search"})," ",window.wplms_create_course_data.translations.add_cpt.question.search)),Wa("div",{className:"add_cpt_option"},Wa("a",{onClick:()=>{b("create")}},Wa("i",{class:"vicon vicon-plus"}),window.wplms_create_course_data.translations.add_cpt.question.create)))))):""};const{createElement:ss,render:ns,useState:is,useEffect:os,useContext:rs,Fragment:ls,RawHTML:cs}=wp.element,{dispatch:ds,select:us}=wp.data;var ms=e=>{const[t,a]=is(e.field),[s,n]=is(""),[i,o]=is([]),[r,l]=is([]),[c,d]=is(!1),[u,m]=is(!1),[p,_]=is(!1);us("vibebp").getUser().token=us("vibebp").getToken(),os(()=>{if(a(e.field),e.field.hasOwnProperty("value")&&e.field.value.length&&e.hasOwnProperty("results")&&null!==e.results&&e.results.length){let t=[];e.results.map((a,s)=>{-1!==e.field.value.indexOf(a.id)&&t.push(a)}),l(t)}_(!0)},[e.field]),os(()=>{e.hasOwnProperty("results")&&null!==e.results&&e.results.length&&(o([...e.results]),e.field.hasOwnProperty("value")&&e.field.value.length&&l(e.results.filter(t=>(e.field.value.indexOf(t.id)>-1||e.field.value.indexOf(t.id.toString())>-1)&&-1===r.findIndex(e=>e.id==t.id))))},[e.results]);let v=[...i];return s.length&&(v=i.filter(e=>e.text.indexOf(s)>-1)),ss("div",{className:"taxonomy_field"},r.length?ss("div",{className:"selected_term_list_wrapper"},ss("div",{className:"selected_term_list"},r.map((s,n)=>{let l=t.cpt?t.taxonomy:"";return ss("div",{className:"term_select"},ss("span",{type:l,onClick:()=>{let l=[...r],c=[...i];l.splice(n,1),c.push(s),o(c);let d={...t},u=[];l&&l.length?(l.map(e=>{u.push(e.id)}),d.value=u,a(d),e.update(d,e.fieldIndex,"fieldvaluechanged")):(d.value=u,a(d),e.update(d,e.fieldIndex,"fieldvaluechanged"))}},s.text))}))):"",ss("div",{className:"term_select"},ss("div",{class:"term_select_label"},t.label,ss("i",u?{class:"vicon vicon-angle-down","aria-hidden":"true",onClick:()=>{m(!u)}}:{class:"vicon vicon-plus","aria-hidden":"true",onClick:()=>{m(!u)}})),u?ss("div",{className:"search_term_list"},i.length?ss(ls,null,i.length>2?ss("div",{className:"searchbox"},ss("input",{type:"text",value:s,onChange:e=>n(e.target.value)}),ss("span",{className:"vicon vicon-search"})):"",v.map((s,l)=>{if(-1===h(s,r))return ss("div",{className:"search_term",onClick:()=>{n("");let c=[...r];if(-1===h(s,c)){c.push(s);let n=[...i];n.splice(l,1),o(n);let r={...t},d=[];c&&c.length?(c.map(e=>{d.push(e.id)}),r.value=d,a(r),e.update(r,e.fieldIndex,"fieldvaluechanged")):(r.value=d,a(r),e.update(r,e.fieldIndex,"fieldvaluechanged"))}}},ss("span",null,s.text))})):""):""))};const{createElement:ps,render:_s,useState:vs,useEffect:hs,useContext:ws,Fragment:fs,RawHTML:gs}=wp.element,{dispatch:ys,select:bs}=wp.data;var ks=e=>{const[t,a]=vs(e.field),[s,n]=vs(-1),[i,o]=vs(null);let r=bs("vibebp").getUser();r.token=bs("vibebp").getToken(),hs(()=>{a(e.field)},[e.field]),hs(()=>{fetch(window.wplms_create_course_data.api_url+"/taxonomy/",{method:"post",body:JSON.stringify({taxonomy:"question-tag",token:r.token})}).then(e=>e.json()).then(e=>{e.status?Array.isArray(e.posts)&&(e.posts.map(e=>{localStorage.setItem("post_"+e.id,JSON.stringify(e))}),o(e.posts)):o([])})},[]),console.log(t);const l=(s,n,i)=>{let o={...t};o.value&&(o.value[n].tagfield=s,a(o),e.update(o,e.fieldIndex,"fieldvaluechanged"))};return ps("div",{className:"repeatable",id:t.id},ps("div",{className:"add_quiz_tag_button"},ps("a",{className:"button is-primary add_repeatable_count_option",onClick:()=>{let s={...t};console.log(t),Array.isArray(s.value)||(s.value=[]),s.value.push({count:0,tagfield:{taxonomy:"question-tag",id:s.value.length-1,value:[]}}),a(s),e.update(s,e.fieldIndex,"fieldvaluechanged")}},window.wplms_create_course_data.translations.add_dynamic_questions_tag)),ps("ul",{className:"vibequiztags"},ps("li",{class:"dynamic_quiz_tags_headings"},ps("strong",null,window.wplms_create_course_data.translations.question_tags),ps("span",null,window.wplms_create_course_data.translations.number)),ps(fs,null,t.value&&t.value.length&&Array.isArray(t.value)?t.value.map((o,r)=>ps("li",null,ps(ms,{results:i,reset:s,field:{...o.tagfield,id:r,value:o.tagfield.value},fieldIndex:r,update:l}),ps("input",{type:"text",className:"count",value:o.count,onChange:s=>{((s,n)=>{let i={...t};console.log(i),i.value&&(i.value[n].count=s.target.value,a(i),e.update(i,e.fieldIndex,"fieldvaluechanged"))})(s,r)}}),ps("span",{className:"vicon vicon-close",onClick:()=>{(s=>{let i={...t};n(s),i.value.splice(s,1),a(i),e.update(i,e.fieldIndex,"fieldvaluechanged")})(r)}}))):"")))};const{createElement:xs,render:Ns,useState:Is,useEffect:Cs,useContext:Os,Fragment:Ss,RawHTML:qs}=wp.element,{dispatch:Ps,select:Es}=wp.data;var zs=e=>{Es("vibebp").getUser().token=Es("vibebp").getToken();Os(y);const[t,a]=Is(!1),[s,n]=Is(e.field),[i,o]=Is(null),[r,l]=Is([]),[c,d]=Is(!1);Cs(()=>{if(e.field.hasOwnProperty("value")&&e.field.value&&e.field.value.hasOwnProperty("value")&&e.field.value.value.length){let t={...e.field};t.value=[...e.field.value.value],o(e.field.value.type),console.log("useEffect",t),l(t)}console.log(e.field),n(e.field),a(!0)},[e.field]);const u=(t,a,i)=>{if(console.log("setFieldValue",t),"fieldvaluechanged"==i){let a={...s};a.hasOwnProperty("value")||(a.value={}),a.value.value=t.value,n(a),l(t),console.log(a),e.update(a,e.fieldIndex,"fieldvaluechanged")}},m=t=>{let a={...s};a.value={},a.value.type=t,a.value.value=[];let i={...a};i.value=[],o(t),console.log("changeType",i),l(i),n(a),e.update(a,e.fieldIndex,"fieldvaluechanged")};return t?xs(Ss,null,i?"questions"==i?xs("div",null,xs("span",{className:"practice_question_back"},xs("span",{className:"vicon vicon-arrow-left",onClick:()=>{m(null)}}),xs("span",{className:"vicon vicon-control-shuffle tip",title:window.wplms_course_data.translations.switch_type,onClick:()=>{m("tags")}})),xs(as,{field:r,update:u,fieldIndex:e.fieldIndex})):"tags"==i?xs("div",null,xs("span",{className:"practice_question_back"},xs("span",{className:"vicon vicon-arrow-left",onClick:()=>{m(null)}}),xs("span",{className:"vicon vicon-control-shuffle tip",title:window.wplms_course_data.translations.switch_type,onClick:()=>{m("questions")}})),xs(ks,{field:r,update:u,fieldIndex:e.fieldIndex})):"":xs("div",{className:"field_quiz_questions"},xs("div",{className:"unitquestions"},xs("div",{class:"add_cpt"},xs("div",{class:"add_cpt_option",onClick:()=>{m("tags")}},xs("a",null," ",xs("i",{class:"vicon  vicon-control-shuffle"}),window.wplms_course_data.translations.select_question_tags)),xs("div",{class:"add_cpt_option",onClick:()=>{m("questions")}},xs("a",null,xs("i",{class:"vicon vicon-exchange-vertical"}),window.wplms_course_data.translations.select_create_questions)))))):""};const{createElement:Ts,render:Ms,useState:js,useEffect:Ls,useContext:Hs,Fragment:As,RawHTML:Fs}=wp.element;var Ds=e=>{const[t,a]=js(e.field),[s,n]=(Hs(y),js({post_content:"",raw:{}})),[i,o]=js(Math.round(1e5*Math.random()));Ls(()=>{if(e.field&&e.field.id){var t=new CustomEvent("load_vibe_editor",{detail:{selector:".vibe_"+e.field.id+i+"_editor",content:e.field.hasOwnProperty("value")?e.field.value:"",raw:e.field.hasOwnProperty("raw")?e.field.raw:"",components:e.field.components?e.field.components:"",updater:e.field.id+i}});document.dispatchEvent(t)}},[e.field]),Ls(()=>(e.field&&e.field.id&&document.addEventListener("vibe_editor_content_update_"+e.field.id+i,r,!1),()=>{e.field&&e.field.id&&document.removeEventListener("vibe_editor_content_update_"+e.field.id+i,r)}));const r=t=>{console.log("captured"),n({post_content:t.detail.raw_html,raw:t.detail.editor_content});let s={...e.field};s.value=t.detail.raw_html,s.raw=t.detail.editor_content,a(s),e.update(s,e.fieldIndex,"fieldvaluechanged")};return Ts("div",{className:"vibev_editor"},Ts("div",{className:"vibe_"+t.id+i+"_editor"},Ts("textarea",{value:t.value})))};const{createElement:Rs,render:Js,useState:Bs,useEffect:$s,useContext:Us,Fragment:Vs,RawHTML:Ws}=wp.element;var Ys=e=>{const[t,a]=Bs({});$s(()=>{a(e.field)},[e.field]);const s=(s,n)=>{let i={...t};i.value[n]=s,a(i),console.log(i),e.update(i,e.fieldIndex,"fieldvaluechanged")};return Rs("div",{className:"repeatable",id:t.id},Rs("a",{className:"button small is-primary add_repeatable_count_option",onClick:()=>{let s={...t};f(s.value)&&(s.value=[]),s.value.push("Option "+(s.value.length+1)),a(s),e.update(s,e.fieldIndex,"fieldvaluechanged")}},window.wplms_create_course_data.translations.add_option),Rs("ul",{className:"repeatableoption"},t.value&&t.value.length?t.value.map((n,i)=>Rs("li",null,Rs("span",null,i+1+" "),Rs(Ds,{field:n?{id:"field_text_"+i,value:n,components:["editor"]}:{id:"field_text_"+i,components:["editor"]},update:(e,t,a)=>{s(e.value,i)}}),Rs("span",{class:"vicon vicon-close",onClick:()=>{(s=>{let n={...t};n.value.splice(s,1),a(n),e.update(n,e.fieldIndex,"fieldvaluechanged")})(i)}}))):""))};const{createElement:Xs,render:Qs,useState:Ks,useEffect:Gs,useContext:Zs,Fragment:en,RawHTML:tn}=wp.element,{dispatch:an,select:sn}=wp.data;var nn=e=>{const[t,a]=Ks(e.field),[s,n]=Ks(-1),[i,o]=Ks(null);let r=sn("vibebp").getUser();r.token=sn("vibebp").getToken(),Gs(()=>{a(e.field)},[e.field]),Gs(()=>{fetch(window.wplms_create_course_data.api_url+"/taxonomy/",{method:"post",body:JSON.stringify({taxonomy:"question-tag",token:r.token})}).then(e=>e.json()).then(e=>{e.status?Array.isArray(e.posts)&&(e.posts.map(e=>{localStorage.setItem("post_"+e.id,JSON.stringify(e))}),o(e.posts)):o([])})},[]);const l=(s,n,i)=>{let o={...t};o.value&&(o.value[n].tagfield=s,a(o),e.update(o,e.fieldIndex,"fieldvaluechanged"))};let c=0;return Array.isArray(t.value)&&t.value.length&&t.value.map(e=>{c+=e.count*e.marks}),Xs("div",{className:"repeatable",id:t.id},Xs("div",{className:"add_quiz_tag_button"},Xs("a",{className:"button is-primary add_repeatable_count_option",onClick:()=>{let s={...t};Array.isArray(s.value)||(s.value=[]),s.value.push({marks:0,count:0,tagfield:{taxonomy:"question-tag",id:s.value.length-1,value:[]}}),a(s),e.update(s,e.fieldIndex,"fieldvaluechanged")}},window.wplms_create_course_data.translations.add_dynamic_questions_tag),Xs("span",null,window.wplms_create_course_data.translations.total_marks," ",c)),Xs("ul",{className:"vibequiztags"},Xs("li",{class:"dynamic_quiz_tags_headings"},Xs("strong",null,window.wplms_create_course_data.translations.question_tags),Xs("span",null,window.wplms_create_course_data.translations.number),Xs("span",null,window.wplms_create_course_data.translations.per_marks)),Xs(en,null,t.value&&t.value.length&&Array.isArray(t.value)?t.value.map((o,r)=>Xs("li",null,Xs(ms,{results:i,reset:s,field:{...o.tagfield,id:r,value:o.tagfield.value},fieldIndex:r,update:l}),Xs("input",{type:"text",className:"count",value:o.count,onChange:s=>{((s,n)=>{let i={...t};i.value&&(i.value[n].count=s.target.value,a(i),e.update(i,e.fieldIndex,"fieldvaluechanged"))})(s,r)}}),Xs("input",{type:"text",className:"marks",value:o.marks,onChange:s=>{((s,n)=>{let i={...t};i.value&&(i.value[n].marks=s.target.value,a(i),e.update(i,e.fieldIndex,"fieldvaluechanged"))})(s,r)}}),Xs("span",{className:"vicon vicon-close",onClick:()=>{(s=>{let i={...t};n(s),i.value.splice(s,1),a(i),e.update(i,e.fieldIndex,"fieldvaluechanged")})(r)}}))):"")))};const{createElement:on,render:rn,useState:ln,useEffect:cn,useContext:dn,Fragment:un,RawHTML:mn}=wp.element,{dispatch:pn,select:_n}=wp.data;var vn=e=>{dn(y);const[t,a]=ln({}),[s,n]=ln(""),[i,o]=ln([]),[r,l]=ln({}),[c,d]=ln(!1);let u=_n("vibebp").getUser();return u.token=_n("vibebp").getToken(),cn(()=>{e.field&&e.field.hasOwnProperty("show_value")&&l(e.field.show_value),a(e.field)},[e.field]),cn(()=>{let s={...t};r.id&&(s.value=r.id,s.show_value=r,a(s),e.update(s,e.fieldIndex,"fieldvaluechanged"))},[r]),cn(()=>{if(s.length>3){d(!0);let e="",a="";t.cpt&&(e=t.cpt,a="selectcpt"),t.post_type&&(e=t.post_type,a="selectcpt"),t.taxonomy&&(e=t.taxonomy,a="taxonomy"),fetch(`${window.wplms_create_course_data.api_url}/${a}/${e}`,{method:"post",body:JSON.stringify({search:s,token:u.token})}).then(e=>e.json()).then(e=>{e.status&&Array.isArray(e.posts)&&(e.posts.map(e=>{localStorage.setItem("post_"+e.id,JSON.stringify(e))}),o(e.posts)),d(!1)})}},[s]),on("div",{className:"selectcptfield"},on("div",{className:"selectcptfield_list"},r&&r.text?on("div",{className:"selectcptfield_items"},on("span",{type:t.cpt,onClick:()=>{l({})}},r.text)):""),r&&r.text?"":on(un,null,on("div",{className:c?"control is-loading":"control"},on("input",{type:"text",value:s,placeholder:window.wplms_create_course_data.translations.type_keyword,onChange:e=>{n(e.target.value)}})),i.length?on("div",{className:"search_results"},i.map((e,t)=>on("div",{className:"search_result selectcpt",onClick:()=>{n("");let a={...r};a=e,i.splice(t,1),l(a)}},on("span",{dangerouslySetInnerHTML:{__html:e.text}})))):""))};const{createElement:hn,render:wn,useState:fn,useEffect:gn,useContext:yn,Fragment:bn,RawHTML:kn}=wp.element,{dispatch:xn,select:Nn}=wp.data;var In=e=>{yn(y);const[t,a]=fn({}),[s,n]=fn(""),[i,o]=fn([]),[r,l]=fn([]),[c,d]=fn(!1),[u,m]=fn(!1);return Nn("vibebp").getUser().token=Nn("vibebp").getToken(),gn(()=>{e.field&&e.field.hasOwnProperty("show_value")&&l(e.field.show_value),a(e.field)},[e.field]),gn(()=>{if(s.length>3){m(!0);let e="",a="";t.cpt&&(e=t.cpt,a="selectcpt"),t.post_type&&(e=t.post_type,a="selectcpt"),t.taxonomy&&(e=t.taxonomy,a="taxonomy"),fetch(`${window.wplms_create_course_data.api_url}/${a}/${e}`,{headers:{Authorization:window.wplms_create_course_data.token},method:"post",body:JSON.stringify({search:s,token:Nn("vibebp").getToken()})}).then(e=>e.json()).then(e=>{console.log(e),e.status?Array.isArray(e.posts)&&(e.posts.map(e=>{localStorage.setItem("post_"+e.id,JSON.stringify(e))}),o(e.posts)):xn("vibebp").addNotification({text:e.message}),m(!1)})}},[s]),hn("div",{className:"selectcptfield"},hn("div",{className:"selectcptfield_list"},r.length?hn("div",{className:"selectcptfield_items"},r.map(s=>{let n=t.cpt?t.taxonomy:"";return hn("span",{type:n,onClick:()=>{let n=[...r];n.splice(h(s,r),1),l(n);let i={...t};if(n&&n.length){let t=[];n.map(e=>{t.push(e.id)}),i.value=t,i.show_value=n,a(i),e.update(i,e.fieldIndex,"fieldvaluechanged")}else i.value=[],i.show_value=[],e.update(i,e.fieldIndex,"fieldvaluechanged")}},s.text)})):""),c?hn("span",{className:"add_wrapper"},hn("div",{className:u?"control is-loading":"control"},hn("input",{type:"text",value:s,placeholder:t.hasOwnProperty("placeholder")?t.placeholder:window.wplms_create_course_data.translations.type_keyword,onChange:e=>{n(e.target.value)}})),hn("span",{onClick:()=>{d(!c)},className:"vicon vicon-close"})):hn("span",{className:"add_wrapper",onClick:()=>{d(!c)}},window.wplms_create_course_data.translations.add,hn("span",{className:"vicon vicon-plus"})),i.length?hn("div",{className:"search_results"},i.map((s,o)=>{if(-1===h(s,r))return hn("div",{className:"search_result selectcpt",onClick:()=>{n("");let c=[...r];if(-1===h(s,c)){c.push(s),i.splice(o,1),l(c);let n={...t};if(c&&c.length){let t=[];c.map(e=>{t.push(e.id)}),n.value=t,n.show_value=c,a(n),e.update(n,e.fieldIndex,"fieldvaluechanged")}}}},hn("span",null,s.text))})):"")};const{createElement:Cn,render:On,useState:Sn,useEffect:qn,useContext:Pn,Fragment:En,RawHTML:zn}=wp.element;var Tn=e=>{Pn(y);const[t,a]=Sn({}),[s,n]=Sn(""),[i,o]=Sn([]),[r,l]=Sn([]),[c,d]=Sn(!1),[u,m]=Sn(!1),[p,_]=Sn(!1);qn(()=>{if(e.field&&e.field.hasOwnProperty("value")&&e.field.value.length){let t=[];e.field.value.map(a=>{e.field.options.map(e=>{e.value!=a&&e.id!=a||t.push(e)})}),console.log(t),l(t)}a(e.field),_(!0)},[e.field]),qn(()=>{p&&(d(!0),o([...t.options]),d(!1))},[p]);let v="search_results";return u&&(v="search_results active"),Cn("div",{className:"selectcptfield multiselect"},Cn("div",{className:"selectcptfield_list"},r.length?Cn("div",{className:"selectcptfield_items"},r.map(s=>{let n=t.cpt?t.multiselect:"";return Cn("span",{type:n,onClick:()=>{let n=[...r],c=[...i];n.splice(h(s,r,"value"),1),c.push(s),o(c),l(n);let d={...t};if(n&&n.length){let t=[];n.map(e=>{e.hasOwnProperty("id")?t.push(e.id):e.hasOwnProperty("value")&&t.push(e.value)}),d.value=t,d.show_value=n,a(d),e.update(d,e.fieldIndex,"fieldvaluechanged")}else d.value=[],d.show_value=[],a(d),e.update(d,e.fieldIndex,"fieldvaluechanged")}},s.label)})):""),Cn("div",{className:"selectimitate",onClick:()=>{m(!u)}},Cn("i",u?{class:"vicon vicon-angle-up","aria-hidden":"true"}:{class:"vicon vicon-angle-down","aria-hidden":"true"}),i.length?Cn("div",{className:v},i.map((s,o)=>{if(-1===h(s,r,"value"))return Cn("div",{className:"search_result selectcpt",onClick:()=>{n("");let c=[...r];if(-1===h(s,c,"value")){c.push(s),i.splice(o,1),l(c);let n={...t};if(c&&c.length){let t=[];c.map(e=>{e.hasOwnProperty("id")?t.push(e.id):e.hasOwnProperty("value")&&t.push(e.value)}),n.value=t,n.show_value=c,a(n),e.update(n,e.fieldIndex,"fieldvaluechanged")}}}},Cn("span",null,s.label))})):c?Cn("div",{className:"search_results"},Cn(Ze,null)):""))};const{createElement:Mn,render:jn,useState:Ln,useEffect:Hn,useContext:An,Fragment:Fn,RawHTML:Dn}=wp.element;var Rn=e=>{const t=An(y),[a,s]=Ln({});Hn(()=>{s(e.field)},[e.field]);return Mn("div",{className:"new_section"},Mn("input",{type:"text",className:"section",onChange:t=>(t=>{let s={...a};s.data=t.target.value,e.update({field:s,fieldIndex:e.fieldIndex,cindex:e.cindex},"curriculumchanged")})(t),placeholder:window.wplms_create_course_data.translations.section_name,value:a.data}),t.adHocSettings&&t.adHocSettings.collapse_into_sections&&(void 0===t.adHocSettings.uncollapsed_section||t.adHocSettings.uncollapsed_section>=0&&t.adHocSettings.uncollapsed_section!=e.cindex)?Mn("span",{className:"vicon vicon-plus",onClick:()=>{t.update(e.cindex,"uncollapsed_section")}}):"",Mn("a",{class:"remove",onClick:a=>{t.course[e.tabIndex].fields[e.fieldIndex].curriculum&&t.course[e.tabIndex].fields[e.fieldIndex].curriculum.length&&t.update({index:e.cindex,fieldIndex:e.fieldIndex},"removecurriculum")}},Mn("span",{class:"vicon vicon-close"})))};const{createElement:Jn,render:Bn,useState:$n,useEffect:Un,useContext:Vn,Fragment:Wn,RawHTML:Yn}=wp.element;var Xn=e=>{const t=Vn(y),[a,s]=$n(e.field);Un(()=>{s(e.field)},[e.field]);let n="";if("section"!==a.type){let e=t.course[t.course.findIndex(e=>"course_curriculum"==e.id)].fields[0].curriculum_elements;if(e[e.findIndex(e=>e.type==a.type)].hasOwnProperty("types")){let t=e[e.findIndex(e=>e.type==a.type)].types;t.findIndex(e=>e.id==a.data.type)>-1&&(n=t[t.findIndex(e=>e.id==a.data.type)].icon)}}return Jn("div",{className:"curriculum_element"},Jn("strong",{onClick:e.show},n.length?-1==n.indexOf("<svg")?Jn("i",{className:n}):Jn("i",{dangerouslySetInnerHTML:{__html:n}}):"",a.data.text),Jn("a",{className:"remove",onClick:e.remove},Jn("span",{className:"vicon vicon-close"})))};const{createElement:Qn,render:Kn,useState:Gn,useEffect:Zn,useContext:ei,Fragment:ti,RawHTML:ai}=wp.element;const{createElement:si,render:ni,useState:ii,useEffect:oi,useContext:ri,Fragment:li,RawHTML:ci}=wp.element,{select:di,dispatch:ui}=wp.data;var mi=e=>{const[t,a]=ii("");return oi(()=>{fetch(window.wplms_create_course_data.api_url+"/unit/elementorLink/",{method:"post",body:JSON.stringify({token:di("vibebp").getToken(),id:e.id})}).then(e=>e.json()).then(e=>{e.status&&a(e.link)})},[]),si("a",{href:t,target:"_blank",className:"edit_with_elementor_wrapper"},si("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",width:"72",height:"72"},si("path",{d:"M 5 5 L 5 27 L 27 27 L 27 5 L 5 5 z M 7 7 L 25 7 L 25 25 L 7 25 L 7 7 z M 11 11 L 11 21 L 13 21 L 13 11 L 11 11 z M 15 11 L 15 13 L 21 13 L 21 11 L 15 11 z M 15 15 L 15 17 L 21 17 L 21 15 L 15 15 z M 15 19 L 15 21 L 21 21 L 21 19 L 15 19 z"})))};const{createElement:pi,useState:_i,useEffect:vi,Fragment:hi,render:wi}=wp.element;var fi=({progress:e,size:t})=>{let a,s;switch(t){case"xs":a=10,s=1;break;case"sm":a=25,s=2.5;break;case"med":a=50,s=5;break;case"lg":a=75,s=7.5;break;case"xl":a=100,s=10;break;default:a=50,s=5}const n=a-2*s,i=2*n*Math.PI,o=i-e/100*i;return pi("div",{className:"react-progress-circle"},pi("svg",{height:2*a,width:2*a},pi("circle",{className:"ReactProgressCircle_circleBackground",strokeWidth:s,style:{strokeDashoffset:o},r:n,cx:a,cy:a}),pi("circle",{className:"ReactProgressCircle_circle",strokeWidth:s,strokeDasharray:i+" "+i,style:{strokeDashoffset:o},r:n,cx:a,cy:a})))};const{Component:gi,createElement:yi,render:bi,useState:ki,useEffect:xi,Fragment:Ni}=wp.element;var Ii=e=>{const[t,a]=ki(e.duration),[s,n]=ki({d:0,h:0,m:0,s:0});xi(()=>{if(e.start){setTimeout(()=>{let s=t-1;s<=-1?e.update(e.quiz_id,"expired"):s>=0&&(a(s),i())},1e3)}else a(e.duration),i()},[t,e.start,e.duration]);const i=()=>{let e={...s},a=t;a>86400?(e.d=Math.floor(a/86400),a-=86400*e.d):e.d=0,a>3600?(e.h=Math.floor(a/3600),a-=3600*e.h):e.h=0,a>60?(e.m=Math.floor(a/60),a-=60*e.m):e.m=0,e.s=a,n(e)};let o=0;return t>-1&&(o=Math.floor((e.duration-t)/e.duration*100),o<=0&&(o=1)),yi("div",{className:"quiztimer"},yi("div",{className:"circle_timer"},o?yi(fi,{size:window.innerWidth<480?"xs":"sm",progress:o}):"",yi("span",null,yi("span",{className:"timer_amount"},s.d?yi(Ni,null,yi("span",null,s.d),yi("span",null,":")):"",s.h?yi(Ni,null,yi("span",null,s.h),yi("span",null,":")):"",s.m?yi(Ni,null,yi("span",null,s.m),yi("span",null,":")):"",yi("span",null,s.s)),yi("span",{className:"timer_unit"},s.d?yi(Ni,null,yi("span",null,window.wplms_course_data.translations.days),yi("span",null)):"",s.h?yi(Ni,null,yi("span",null,window.wplms_course_data.translations.hours),yi("span",null)):"",s.m?yi(Ni,null,yi("span",null,window.wplms_course_data.translations.minutes),yi("span",null)):"",yi("span",null,window.wplms_course_data.translations.seconds)))))};const{createElement:Ci,render:Oi,useState:Si,useEffect:qi,Fragment:Pi}=wp.element;var Ei=e=>{const[t,a]=Si({});qi(()=>{a(e.question)},[e.question]);let s="";t.hasOwnProperty("marked_answer")&&(s=t.marked_answer);let n="";return t.hasOwnProperty("usercorrect")&&t.show_correct_answer&&(n="question_incorrect",t.usercorrect>0&&(n="question_correct")),Ci(Pi,null,Ci("div",{className:"question_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),Ci("input",{type:"text",className:n,value:s,onChange:t=>{let s={...e.question};s.marked_answer=t.target.value,a(s),e.update(s,e.index,"changed")}}))};const{createElement:zi,render:Ti,useState:Mi,useEffect:ji,Fragment:Li}=wp.element;var Hi=e=>{const[t,a]=Mi({}),[s,n]=Mi([]);ji(()=>{if(a(e.question),e.question.hasOwnProperty("options")&&e.question.options.length&&Array.isArray(e.question.options)){let t=[...e.question.options];window.wplms_course_data.question_option_rearrange&&i(t),n(t)}},[e.question.correct_indexes]);const i=e=>{for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),s=e[t];e[t]=e[a],e[a]=s}};let o="";return t.hasOwnProperty("marked_answer")&&(o=t.marked_answer),zi(Li,null,zi("div",{className:"question_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),t.options&&t.options.length?zi(Li,null,(t=>s.map((function(s,n){let i=t.options.findIndex(e=>e==s);return zi("div",{className:"question_option radio "+(t.show_correct_answer&&t.correct_indexes?t.correct_indexes&&t.correct_indexes.length&&t.correct_indexes.includes(i)?"question_correct":"question_incorrect":"")},zi("input",{type:"radio",name:e.quiz_id+"_"+t.id,value:i,id:e.quiz_id+"_"+t.id+i,checked:parseInt(t.marked_answer)===i,onChange:t=>{let s={...e.question};s.marked_answer=t.target.value,a(s),e.update(s,e.index,"changed")}}),zi("label",{for:e.quiz_id+"_"+t.id+i,dangerouslySetInnerHTML:{__html:s}}))})))(t),t.attempted?"":zi("span",{className:"resetq_answer button",onClick:t=>{let s={...e.question};s.marked_answer=null,a(s),e.update(s,e.index,"changed")}},zi("i",{class:"vicon vicon-trash"}))):"")};const{createElement:Ai,render:Fi,useState:Di,useEffect:Ri,Fragment:Ji}=wp.element;var Bi=e=>{const[t,a]=Di({});Ri(()=>{a(e.question)},[e.question]);const s=(t,s)=>{let n={...e.question};n.marked_answer&&n.marked_answer.length||(n.marked_answer=[]),n.marked_answer[s]=t,a(n),e.update(n,e.index,"changed")},n=(t,a)=>Ai(Ji,null,Ai("span",{className:t.show_correct_answer&&t.correct_indexes?t.correct_indexes&&t.correct_indexes.length&&t.correct_indexes.includes(a)?"question_correct":"question_incorrect":""},Ai("select",{name:e.quiz_id+"_"+t.id,id:e.quiz_id+"_"+t.id,onChange:e=>{s(e.target.value,a)}},Ai("option",null,window.wplms_course_data.translations.select_option),((e,t)=>e.options.map((function(a,s){return e.hasOwnProperty("options_arr")&&e.options_arr&&e.options_arr.length&&e.options_arr[t]&&e.options_arr[t].length?e.options_arr[t].includes((s+1).toString())||e.options_arr[t].includes(s+1)?Ai("option",{value:s,selected:e.marked_answer&&e.marked_answer.length&&e.marked_answer[t]&&parseInt(e.marked_answer[t])===s,dangerouslySetInnerHTML:{__html:a}}):void 0:Ai("option",{value:s,selected:e.marked_answer&&e.marked_answer.length&&e.marked_answer[t]&&parseInt(e.marked_answer[t])===s,dangerouslySetInnerHTML:{__html:a}})})))(t,a))),t.attempted?"":Ai("span",{className:"resetq_answer button",onClick:e=>{s(null,a)}},Ai("i",{class:"vicon vicon-trash"})));return Ai(Ji,null,t&&t.extra_content&&Array.isArray(t.extra_content)?Ai("div",{className:"question_content"},t.extra_content.map((function(e,a){return Ai(Ji,null,Ai("span",{className:"select_question_content",dangerouslySetInnerHTML:{__html:e}}),t.options&&t.options.length&&a<t.extra_content.length-1?Ai(Ji,null,n(t,a)):"")}))):"")};const{createElement:$i,render:Ui,useState:Vi,useEffect:Wi,Fragment:Yi}=wp.element;var Xi=e=>{const[t,a]=Vi({}),[s,n]=Vi([]);"undefined"!=e.question.marked_answer&&null!=e.question.marked_answer||(e.question.marked_answer=[]),Wi(()=>{if(a(e.question),e.question.hasOwnProperty("options")&&e.question.options.length&&Array.isArray(e.question.options)){let t=[...e.question.options];window.wplms_course_data.question_option_rearrange&&i(t),n(t)}},[e.question.correct_indexes]);const i=e=>{for(var t=e.length-1;t>0;t--){var a=Math.floor(Math.random()*(t+1)),s=e[t];e[t]=e[a],e[a]=s}};return $i(Yi,null,$i("div",{className:"question_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),t.options&&t.options.length?$i(Yi,null,(t=>{if(s&&s.length)return s.map((function(s,n){let i=t.options.findIndex(e=>e==s);return $i("div",{className:"question_option checkbox "+(t.show_correct_answer&&t.correct_indexes?t.correct_indexes&&t.correct_indexes.length&&t.correct_indexes.includes(i)?"question_correct":"question_incorrect":"")},$i("input",{type:"checkbox",name:e.quiz_id+"_"+t.id,value:i,id:e.quiz_id+"_"+t.id+i,checked:e.question.marked_answer&&e.question.marked_answer.length&&e.question.marked_answer.includes(i),onChange:t=>{let s={...e.question};if(s.marked_answer.includes(i)){let e=s.marked_answer.indexOf(i);e>-1&&s.marked_answer.splice(e,1)}else s.marked_answer.push(i);a(s),e.update(s,e.index,"changed")}}),$i("label",{for:e.quiz_id+"_"+t.id+i,dangerouslySetInnerHTML:{__html:s}}))}))})(t),t.attempted?"":$i("span",{className:"resetq_answer button",onClick:t=>{let s={...e.question};s.marked_answer=null,a(s),e.update(s,e.index,"changed")}},$i("i",{class:"vicon vicon-trash"}))):"")};const{createElement:Qi,render:Ki,useState:Gi,useEffect:Zi,Fragment:eo}=wp.element;var to=e=>{const[t,a]=Gi("120"),[s,n]=Gi(()=>{let t="";return e.marked_answer&&e.marked_answer.length&&(t=e.marked_answer[e.index]),t});Zi(()=>{s.length>15&&a(8*s.length)},[s]);let i="";s&&(i=s);return Qi(eo,null,Qi("div",{className:"fillblank_area"},Qi("input",{type:"text",value:i,onChange:t=>{let a=s;a=t.target.value,n(a),e.update(a,e.index,"changed")},style:{width:t+"px"}})))};const{createElement:ao,render:so,useState:no,useEffect:io,Fragment:oo}=wp.element;var ro=e=>{const[t,a]=no({});io(()=>{a(e.question)},[]);let s="";t.hasOwnProperty("marked_answer")&&(s=t.marked_answer);const n=(s,n,i)=>{if("changed"==i){let i={...t};i.marked_answer&&t.marked_answer.length||(i.marked_answer=[]),i.marked_answer[n]=s,a(i),e.update(i,e.index,"changed")}};return ao(oo,null,t&&t.extra_content&&Array.isArray(t.extra_content)?ao("div",{className:"question_content"},t.extra_content.map((function(e,a){return ao(oo,null,ao("span",{className:"select_question_content",dangerouslySetInnerHTML:{__html:e}}),a<t.extra_content.length-1?ao("div",{className:"fillblank_area "+(t.show_correct_answer&&t.correct_indexes?t.correct_indexes&&t.correct_indexes.length&&t.correct_indexes.includes(a)?"question_correct":"question_incorrect":"")},ao(to,{update:n,index:a,marked_answer:t.marked_answer})):"")}))):"")};const{createElement:lo,render:co,useState:uo,useEffect:mo,Fragment:po}=wp.element;var _o=e=>{const[t,a]=uo([]),[s,n]=uo(!1),[i,o]=uo([]),[r,l]=uo([]),[c,d]=uo([]),[u,m]=uo([]);mo(()=>{o(e.items)},[e.items]);let p="droppable";s&&(p+=" active");const _=e=>{let t="";return s===i[e]&&(t="dragging"),t};return lo("div",{className:p},i.map((p,v)=>lo("div",{key:v,onDragStart:e=>{i[v]&&n(i[v])},onDragEnd:()=>{n(!1)},onDragOver:t=>{t.preventDefault(),((t,a)=>{if(!s)return;let n=i[a];if(s===n)return;let r=[...i];r=r.filter(e=>e!=s),r.splice(a,0,s),o(r),e.update(r,"changed")})(0,v)},ref:e=>{((e,s)=>{if(e){let n=t;n[s]||(n[s]=e),a(n)}})(e,v)},draggable:"true",style:u[v],onTouchStart:e=>{let a=[...c];t.map((e,t)=>{let s=e.getBoundingClientRect();a[t]=s}),d(a),i[v]&&n(i[v])},onTouchMove:e=>{e.preventDefault();let t=[];if("touchmove"===e.type){let a=[...u];a[v]={transform:"translateY("+Math.floor(e.touches[0].clientY-c[v].top)+"px)"},m(a),t.push(i[v]);let s=[];if(e.touches[0].clientY&&c.map((a,n)=>{a.top+a.height/2>e.touches[0].clientY&&i[n]!==i[v]&&t.push(i[n]),a.bottom-a.height/2<e.touches[0].clientY&&i[n]!==i[v]&&s.push(i[n])}),s.length)for(let e=s.length-1;e>=0;e--)t.unshift(s[e]);l(t)}},onTouchEnd:t=>{o(r),e.update(r,"changed"),d([]),m([]),n(!1),l([])},className:_(v)+" "+(e.question.show_correct_answer&&e.question.correct_indexes?e.question.correct_indexes&&e.question.correct_indexes.length&&e.question.correct_indexes.includes(v)?"question_correct":"question_incorrect":"")},lo("div",{dangerouslySetInnerHTML:{__html:p}}))))};const{createElement:vo,render:ho,useState:wo,useEffect:fo,Fragment:go}=wp.element;var yo=e=>{e.question.id,e.quiz_id;const[t,a]=wo({}),[s,n]=wo(!1);fo(()=>{let t=e.question;if(!s&&t&&t.marked_answer&&t.marked_answer.length&&"undefined"!=t.marked_answer){let e=[];t.marked_answer.map((a,s)=>{e.push(t.original_options[parseInt(a)-1])}),t.options=e,a(t),n(!0)}a(t)},[t]);return vo(go,null,vo("div",{className:"question_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),t.options&&t.options.length?vo(go,null,vo(_o,{items:t.options,original_items:t.original_options,update:(s,n)=>{if("changed"==n){let n=t;n.marked_answer=[],s.map((e,t)=>{let a=n.original_options.indexOf(e);n.marked_answer.push(a+1)}),a(n),e.update(n,e.index,"changed")}},question:t}),t.attempted?"":vo("span",{className:"resetq_answer button",onClick:s=>{let n={...t};n.marked_answer=null,n.options=n.original_options,a(n),e.update(n,e.index,"changed")}},vo("i",{class:"vicon vicon-trash"}))):"")};const{createElement:bo,render:ko,useState:xo,useEffect:No,Fragment:Io}=wp.element;function Co(e){if(null==e)return!0;if(void 0===e)return!0;if("number"==typeof e)return!1;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var Oo=e=>{const[t,a]=xo([]),[s,n]=xo(!1),[i,o]=xo([]),[r,l]=xo(""),[c,d]=xo([]),[u,m]=xo(e.matches),[p,_]=xo([]),[v,h]=xo([]),[w,f]=xo([]),[g,y]=xo({}),[b,k]=xo([]),[x,N]=xo([]),[I,C]=xo([]),[O,S]=xo({x:0,y:0}),[q,P]=xo([]);No(()=>{let t=[...e.items];e.question&&e.question.marked_answer&&e.question.marked_answer.length&&e.question.marked_answer.map(a=>{a&&"NaN"!=typeof a&&(t=t.filter(t=>t!=e.question.original_options[a-1]))}),d(t);let a=[];e.question&&e.question.marked_answer&&e.question.marked_answer.length&&e.question.marked_answer.map(e=>{parseFloat(e)-1>=0?a.push(e-1):a.push(null)}),C(a),e.update(!1,"reset")},[e.items,e.reset]);let E="droppable";s&&(E+=" active");const z=e=>{let t="";return s===c[e]&&(t="dragging"),t};return bo("div",{className:"match_playground"},bo("div",{className:"match_options"},u&&u.length?u.map((a,l)=>bo("div",{key:l,className:"match_option "+(e.question.show_correct_answer&&e.question.correct_indexes?e.question.correct_indexes&&e.question.correct_indexes.length&&e.question.correct_indexes.includes(l)?"question_correct":"question_incorrect":""),onDrop:t=>{((t,a)=>{if(!s)return;if(q.index===a)return;let n=[...c],i=[...I];if(!i[a]&&0!==i[a]){n=n.filter(e=>e!=s);let t=e.original_items.indexOf(s);u&&u.length&&u.map((e,t)=>{Co(i[t])&&(i[t]=null)}),Co(a)||(i[a]=t),C(i),d(n),e.update(i,"changed")}})(0,l)},onDragOver:e=>{e.preventDefault()},ref:e=>{((e,t)=>{if(e){let a=i;a[t]||(a[t]=e),o(a)}})(e,l)}},bo("div",{dangerouslySetInnerHTML:{__html:a}}),bo("div",{className:"children"},e.original_items&&null!=I[l]&&e.original_items[I[l]]?bo("div",{key:"droppablediv"+l,draggable:"true",onDragStart:t=>{e.original_items[I[l]]&&(n(e.original_items[I[l]]),P({index:l,source:"droppablediv"}))},onDragEnd:()=>{n(!1),P({})},onDragOver:e=>{e.preventDefault()},className:z(l),style:x[I[l]],onTouchStart:a=>{let s=[...v];t.map((e,t)=>{let a=e.getBoundingClientRect();s[t]=a}),h(s);let o=[...w];i.map((e,t)=>{let a=e.getBoundingClientRect();o[t]=a}),f(o),y(r.getBoundingClientRect()),e.original_items[I[l]]&&(n(e.original_items[I[l]]),P({index:l,source:"droppablediv"})),P({})},onTouchMove:e=>{if(e&&(e.preventDefault(),"touchmove"===e.type)){let t=[...x];t[I[l]]={position:"fixed",top:Math.floor(e.touches[0].clientY)+"px",left:Math.floor(e.touches[0].clientX)+"px"},N(t),S({x:e.touches[0].clientX,y:e.touches[0].clientY})}},onTouchEnd:t=>{let a=[...c],i=[...I];g.top<O.y&&g.top+g.height>O.y&&g.left<O.x&&g.left+g.width>O.x&&(a.push(s),i.map((e,t)=>{e==I[l]&&(i[t]=null)})),f([]),y({}),n(!1),N([]),k([]),d(a),C(i),e.update(i,"changed"),S({x:0,y:0})}},bo("div",{dangerouslySetInnerHTML:{__html:e.original_items[I[l]]}})):""))):""),bo("div",{className:E,onDragOver:e=>{e.preventDefault()},onDrop:t=>{(t=>{if("droppablediv"!==q.source)return;if(!s)return;let a=[...c],n=[...I];a.includes(s)||a.push(s),d(a),Co(q.index)||(n[q.index]=null),C(n),e.update(n,"changed")})()},ref:e=>{(e=>{e&&l(e)})(e)}},c&&c.length?c.map((s,o)=>bo("div",{key:"draggablediv"+o,onDragStart:e=>{c[o]&&n(c[o]),P({})},onDragEnd:()=>{n(!1),P({})},onDragOver:e=>{e.preventDefault()},ref:e=>{((e,s)=>{if(e){let n=t;n[s]||(n[s]=e),a(n)}})(e,o)},draggable:"true",style:b[o],onTouchStart:e=>{let a=[...v];t.map((e,t)=>{let s=e.getBoundingClientRect();a[t]=s}),h(a);let o=[...w];i.map((e,t)=>{let a=e.getBoundingClientRect();o[t]=a}),f(o),s&&n(s),P({})},onTouchMove:e=>{if(e.preventDefault(),"touchmove"===e.type){let t=[...b];t[o]={position:"fixed",top:Math.floor(e.touches[0].clientY)+"px",left:Math.floor(e.touches[0].clientX)+"px"},k(t),S({x:e.touches[0].clientX,y:e.touches[0].clientY})}},onTouchEnd:t=>{k([]);let a=[...c],i=[...I];w.map((t,n)=>{if(t.top<O.y&&t.top+t.height>O.y&&t.left<O.x&&t.left+t.width>O.x){let t=e.original_items.indexOf(s);t>=0&&!i[n]&&0!==i[n]&&(i[n]=t,a=a.filter(e=>e!=s))}}),f([]),n(!1),d(a),C(i),e.update(i,"changed"),S({x:0,y:0})},className:z(o)},bo("div",{dangerouslySetInnerHTML:{__html:s}}))):""))};const{createElement:So,render:qo,useState:Po,useEffect:Eo,Fragment:zo}=wp.element;var To=e=>{e.question.id,e.quiz_id;const[t,a]=Po({}),[s,n]=Po(!1);Eo(()=>{a(e.question)},[t]);return So(zo,null,So("div",{className:"question_content"},So("div",{className:"question_statement",dangerouslySetInnerHTML:{__html:t&&t.extra_content&&t.extra_content.statement?t.extra_content.statement:""}}),t.options&&t.options.length&&t.content.match&&t.content.match.length?So(Oo,{matches:t.extra_content.match,original_matches:t.extra_content.match,items:t.options,original_items:t.original_options,update:(s,i)=>{if("changed"==i){let n={...t};n.marked_answer=[],s.map(e=>{n.marked_answer.push(parseInt(e)+1)}),a(n),e.update(n,e.index,"changed")}"reset"==i&&n(!1)},reset:s,question:t}):"",So("div",{className:"question_end",dangerouslySetInnerHTML:{__html:t&&t.content&&t.content.end?t.content.end:""}})),t.attempted?"":So("span",{className:"resetq_answer button",onClick:s=>{n(!0);let i={...t};i.marked_answer=null,i.options=i.original_options,a(i),e.update(i,e.index,"changed")}},So("i",{class:"vicon vicon-trash"})))};const{createElement:Mo,render:jo,useState:Lo,useEffect:Ho,Fragment:Ao}=wp.element;var Fo=e=>{const[t,a]=Lo(e.question);let s="";return t.hasOwnProperty("marked_answer")&&(s=t.marked_answer),Mo(Ao,null,Mo("div",{className:"question_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),t.options&&t.options.length?Mo(Ao,null,(t=>t.options.map((function(s,n){return Mo("div",{className:"question_option radio "+(t.show_correct_answer&&t.correct_indexes?t.correct_indexes&&t.correct_indexes.length&&t.correct_indexes.includes(n)?"question_correct":"question_incorrect":"")},Mo("input",{type:"radio",name:e.quiz_id+"_"+t.id,value:n,id:e.quiz_id+"_"+t.id+n,checked:parseInt(t.marked_answer)===n,onChange:t=>{let s={...e.question};s.marked_answer=t.target.value,a(s),e.update(s,e.index,"changed")}}),Mo("label",{for:e.quiz_id+"_"+t.id+n,dangerouslySetInnerHTML:{__html:s}}))})))(t),t.attempted?"":Mo("span",{className:"resetq_answer button",onClick:t=>{let s={...e.question};s.marked_answer=null,a(s)}},Mo("i",{class:"vicon vicon-trash"}))):"")};const{createElement:Do,render:Ro,useState:Jo,useEffect:Bo,Fragment:$o}=wp.element;var Uo,Vo,Wo=e=>{const[t,a]=Jo({});Bo(()=>{a(e.question)},[e.question]);let s="";t.hasOwnProperty("marked_answer")&&(s=t.marked_answer);let n="";return t.hasOwnProperty("usercorrect")&&t.show_correct_answer&&(n="question_incorrect",t.usercorrect>0&&(n="question_correct")),Do($o,null,Do("div",{className:"question_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),Do("textarea",{className:n,type:"text",onChange:t=>{let s={...e.question};s.marked_answer=t.target.value,a(s),e.update(s,e.index,"changed")},value:s},s))},Yo=Yo||function(e,t){var a={},s=a.lib={},n=function(){},i=s.Base={extend:function(e){n.prototype=this;var t=new n;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=s.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,a=e.words,s=this.sigBytes;if(e=e.sigBytes,this.clamp(),s%4)for(var n=0;n<e;n++)t[s+n>>>2]|=(a[n>>>2]>>>24-n%4*8&255)<<24-(s+n)%4*8;else if(65535<a.length)for(n=0;n<e;n+=4)t[s+n>>>2]=a[n>>>2];else t.push.apply(t,a);return this.sigBytes+=e,this},clamp:function(){var t=this.words,a=this.sigBytes;t[a>>>2]&=4294967295<<32-a%4*8,t.length=e.ceil(a/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var a=[],s=0;s<t;s+=4)a.push(4294967296*e.random()|0);return new o.init(a,t)}}),r=a.enc={},l=r.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var a=[],s=0;s<e;s++){var n=t[s>>>2]>>>24-s%4*8&255;a.push((n>>>4).toString(16)),a.push((15&n).toString(16))}return a.join("")},parse:function(e){for(var t=e.length,a=[],s=0;s<t;s+=2)a[s>>>3]|=parseInt(e.substr(s,2),16)<<24-s%8*4;return new o.init(a,t/2)}},c=r.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var a=[],s=0;s<e;s++)a.push(String.fromCharCode(t[s>>>2]>>>24-s%4*8&255));return a.join("")},parse:function(e){for(var t=e.length,a=[],s=0;s<t;s++)a[s>>>2]|=(255&e.charCodeAt(s))<<24-s%4*8;return new o.init(a,t)}},d=r.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},u=s.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var a=this._data,s=a.words,n=a.sigBytes,i=this.blockSize,r=n/(4*i);if(t=(r=t?e.ceil(r):e.max((0|r)-this._minBufferSize,0))*i,n=e.min(4*t,n),t){for(var l=0;l<t;l+=i)this._doProcessBlock(s,l);l=s.splice(0,t),a.sigBytes-=n}return new o.init(l,n)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});s.Hasher=u.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,a){return new e.init(a).finalize(t)}},_createHmacHelper:function(e){return function(t,a){return new m.HMAC.init(e,a).finalize(t)}}});var m=a.algo={};return a}(Math);Vo=(Uo=Yo).lib.WordArray,Uo.enc.Base64={stringify:function(e){var t=e.words,a=e.sigBytes,s=this._map;e.clamp(),e=[];for(var n=0;n<a;n+=3)for(var i=(t[n>>>2]>>>24-n%4*8&255)<<16|(t[n+1>>>2]>>>24-(n+1)%4*8&255)<<8|t[n+2>>>2]>>>24-(n+2)%4*8&255,o=0;4>o&&n+.75*o<a;o++)e.push(s.charAt(i>>>6*(3-o)&63));if(t=s.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var t=e.length,a=this._map;(s=a.charAt(64))&&-1!=(s=e.indexOf(s))&&(t=s);for(var s=[],n=0,i=0;i<t;i++)if(i%4){var o=a.indexOf(e.charAt(i-1))<<i%4*2,r=a.indexOf(e.charAt(i))>>>6-i%4*2;s[n>>>2]|=(o|r)<<24-n%4*8,n++}return Vo.create(s,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(e){function t(e,t,a,s,n,i,o){return((e=e+(t&a|~t&s)+n+o)<<i|e>>>32-i)+t}function a(e,t,a,s,n,i,o){return((e=e+(t&s|a&~s)+n+o)<<i|e>>>32-i)+t}function s(e,t,a,s,n,i,o){return((e=e+(t^a^s)+n+o)<<i|e>>>32-i)+t}function n(e,t,a,s,n,i,o){return((e=e+(a^(t|~s))+n+o)<<i|e>>>32-i)+t}for(var i=Yo,o=(l=i.lib).WordArray,r=l.Hasher,l=i.algo,c=[],d=0;64>d;d++)c[d]=4294967296*e.abs(e.sin(d+1))|0;l=l.MD5=r.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var o=0;16>o;o++){var r=e[l=i+o];e[l]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}o=this._hash.words;var l=e[i+0],d=(r=e[i+1],e[i+2]),u=e[i+3],m=e[i+4],p=e[i+5],_=e[i+6],v=e[i+7],h=e[i+8],w=e[i+9],f=e[i+10],g=e[i+11],y=e[i+12],b=e[i+13],k=e[i+14],x=e[i+15],N=t(N=o[0],O=o[1],C=o[2],I=o[3],l,7,c[0]),I=t(I,N,O,C,r,12,c[1]),C=t(C,I,N,O,d,17,c[2]),O=t(O,C,I,N,u,22,c[3]);N=t(N,O,C,I,m,7,c[4]),I=t(I,N,O,C,p,12,c[5]),C=t(C,I,N,O,_,17,c[6]),O=t(O,C,I,N,v,22,c[7]),N=t(N,O,C,I,h,7,c[8]),I=t(I,N,O,C,w,12,c[9]),C=t(C,I,N,O,f,17,c[10]),O=t(O,C,I,N,g,22,c[11]),N=t(N,O,C,I,y,7,c[12]),I=t(I,N,O,C,b,12,c[13]),C=t(C,I,N,O,k,17,c[14]),N=a(N,O=t(O,C,I,N,x,22,c[15]),C,I,r,5,c[16]),I=a(I,N,O,C,_,9,c[17]),C=a(C,I,N,O,g,14,c[18]),O=a(O,C,I,N,l,20,c[19]),N=a(N,O,C,I,p,5,c[20]),I=a(I,N,O,C,f,9,c[21]),C=a(C,I,N,O,x,14,c[22]),O=a(O,C,I,N,m,20,c[23]),N=a(N,O,C,I,w,5,c[24]),I=a(I,N,O,C,k,9,c[25]),C=a(C,I,N,O,u,14,c[26]),O=a(O,C,I,N,h,20,c[27]),N=a(N,O,C,I,b,5,c[28]),I=a(I,N,O,C,d,9,c[29]),C=a(C,I,N,O,v,14,c[30]),N=s(N,O=a(O,C,I,N,y,20,c[31]),C,I,p,4,c[32]),I=s(I,N,O,C,h,11,c[33]),C=s(C,I,N,O,g,16,c[34]),O=s(O,C,I,N,k,23,c[35]),N=s(N,O,C,I,r,4,c[36]),I=s(I,N,O,C,m,11,c[37]),C=s(C,I,N,O,v,16,c[38]),O=s(O,C,I,N,f,23,c[39]),N=s(N,O,C,I,b,4,c[40]),I=s(I,N,O,C,l,11,c[41]),C=s(C,I,N,O,u,16,c[42]),O=s(O,C,I,N,_,23,c[43]),N=s(N,O,C,I,w,4,c[44]),I=s(I,N,O,C,y,11,c[45]),C=s(C,I,N,O,x,16,c[46]),N=n(N,O=s(O,C,I,N,d,23,c[47]),C,I,l,6,c[48]),I=n(I,N,O,C,v,10,c[49]),C=n(C,I,N,O,k,15,c[50]),O=n(O,C,I,N,p,21,c[51]),N=n(N,O,C,I,y,6,c[52]),I=n(I,N,O,C,u,10,c[53]),C=n(C,I,N,O,f,15,c[54]),O=n(O,C,I,N,r,21,c[55]),N=n(N,O,C,I,h,6,c[56]),I=n(I,N,O,C,x,10,c[57]),C=n(C,I,N,O,_,15,c[58]),O=n(O,C,I,N,b,21,c[59]),N=n(N,O,C,I,m,6,c[60]),I=n(I,N,O,C,g,10,c[61]),C=n(C,I,N,O,d,15,c[62]),O=n(O,C,I,N,w,21,c[63]);o[0]=o[0]+N|0,o[1]=o[1]+O|0,o[2]=o[2]+C|0,o[3]=o[3]+I|0},_doFinalize:function(){var t=this._data,a=t.words,s=8*this._nDataBytes,n=8*t.sigBytes;a[n>>>5]|=128<<24-n%32;var i=e.floor(s/4294967296);for(a[15+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),a[14+(n+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(a.length+1),this._process(),a=(t=this._hash).words,s=0;4>s;s++)n=a[s],a[s]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return t},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=r._createHelper(l),i.HmacMD5=r._createHmacHelper(l)}(Math),function(){var e,t=Yo,a=(e=t.lib).Base,s=e.WordArray,n=(e=t.algo).EvpKDF=a.extend({cfg:a.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var a=(r=this.cfg).hasher.create(),n=s.create(),i=n.words,o=r.keySize,r=r.iterations;i.length<o;){l&&a.update(l);var l=a.update(e).finalize(t);a.reset();for(var c=1;c<r;c++)l=a.finalize(l),a.reset();n.concat(l)}return n.sigBytes=4*o,n}});t.EvpKDF=function(e,t,a){return n.create(a).compute(e,t)}}(),Yo.lib.Cipher||function(e){var t=(p=Yo).lib,a=t.Base,s=t.WordArray,n=t.BufferedBlockAlgorithm,i=p.enc.Base64,o=p.algo.EvpKDF,r=t.Cipher=n.extend({cfg:a.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,a){this.cfg=this.cfg.extend(a),this._xformMode=e,this._key=t,this.reset()},reset:function(){n.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,a,s){return("string"==typeof a?_:m).encrypt(e,t,a,s)},decrypt:function(t,a,s){return("string"==typeof a?_:m).decrypt(e,t,a,s)}}}});t.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var l=p.mode={},c=function(e,t,a){var s=this._iv;s?this._iv=void 0:s=this._prevBlock;for(var n=0;n<a;n++)e[t+n]^=s[n]},d=(t.BlockCipherMode=a.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();d.Encryptor=d.extend({processBlock:function(e,t){var a=this._cipher,s=a.blockSize;c.call(this,e,t,s),a.encryptBlock(e,t),this._prevBlock=e.slice(t,t+s)}}),d.Decryptor=d.extend({processBlock:function(e,t){var a=this._cipher,s=a.blockSize,n=e.slice(t,t+s);a.decryptBlock(e,t),c.call(this,e,t,s),this._prevBlock=n}}),l=l.CBC=d,d=(p.pad={}).Pkcs7={pad:function(e,t){for(var a,n=(a=(a=4*t)-e.sigBytes%a)<<24|a<<16|a<<8|a,i=[],o=0;o<a;o+=4)i.push(n);a=s.create(i,a),e.concat(a)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=r.extend({cfg:r.cfg.extend({mode:l,padding:d}),reset:function(){r.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var a=t.createEncryptor;else a=t.createDecryptor,this._minBufferSize=1;this._mode=a.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var u=t.CipherParams=a.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),m=(l=(p.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?s.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var a=s.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return u.create({ciphertext:e,salt:a})}},t.SerializableCipher=a.extend({cfg:a.extend({format:l}),encrypt:function(e,t,a,s){s=this.cfg.extend(s);var n=e.createEncryptor(a,s);return t=n.finalize(t),n=n.cfg,u.create({ciphertext:t,key:a,iv:n.iv,algorithm:e,mode:n.mode,padding:n.padding,blockSize:e.blockSize,formatter:s.format})},decrypt:function(e,t,a,s){return s=this.cfg.extend(s),t=this._parse(t,s.format),e.createDecryptor(a,s).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),p=(p.kdf={}).OpenSSL={execute:function(e,t,a,n){return n||(n=s.random(8)),e=o.create({keySize:t+a}).compute(e,n),a=s.create(e.words.slice(t),4*a),e.sigBytes=4*t,u.create({key:e,iv:a,salt:n})}},_=t.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:p}),encrypt:function(e,t,a,s){return a=(s=this.cfg.extend(s)).kdf.execute(a,e.keySize,e.ivSize),s.iv=a.iv,(e=m.encrypt.call(this,e,t,a.key,s)).mixIn(a),e},decrypt:function(e,t,a,s){return s=this.cfg.extend(s),t=this._parse(t,s.format),a=s.kdf.execute(a,e.keySize,e.ivSize,t.salt),s.iv=a.iv,m.decrypt.call(this,e,t,a.key,s)}})}(),function(){for(var e=Yo,t=e.lib.BlockCipher,a=e.algo,s=[],n=[],i=[],o=[],r=[],l=[],c=[],d=[],u=[],m=[],p=[],_=0;256>_;_++)p[_]=128>_?_<<1:_<<1^283;var v=0,h=0;for(_=0;256>_;_++){var w=(w=h^h<<1^h<<2^h<<3^h<<4)>>>8^255&w^99;s[v]=w,n[w]=v;var f=p[v],g=p[f],y=p[g],b=257*p[w]^16843008*w;i[v]=b<<24|b>>>8,o[v]=b<<16|b>>>16,r[v]=b<<8|b>>>24,l[v]=b,b=16843009*y^65537*g^257*f^16843008*v,c[w]=b<<24|b>>>8,d[w]=b<<16|b>>>16,u[w]=b<<8|b>>>24,m[w]=b,v?(v=f^p[p[p[y^f]]],h^=p[p[h]]):v=h=1}var k=[0,1,2,4,8,16,32,64,128,27,54];a=a.AES=t.extend({_doReset:function(){for(var e=(a=this._key).words,t=a.sigBytes/4,a=4*((this._nRounds=t+6)+1),n=this._keySchedule=[],i=0;i<a;i++)if(i<t)n[i]=e[i];else{var o=n[i-1];i%t?6<t&&4==i%t&&(o=s[o>>>24]<<24|s[o>>>16&255]<<16|s[o>>>8&255]<<8|s[255&o]):(o=s[(o=o<<8|o>>>24)>>>24]<<24|s[o>>>16&255]<<16|s[o>>>8&255]<<8|s[255&o],o^=k[i/t|0]<<24),n[i]=n[i-t]^o}for(e=this._invKeySchedule=[],t=0;t<a;t++)i=a-t,o=t%4?n[i]:n[i-4],e[t]=4>t||4>=i?o:c[s[o>>>24]]^d[s[o>>>16&255]]^u[s[o>>>8&255]]^m[s[255&o]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,o,r,l,s)},decryptBlock:function(e,t){var a=e[t+1];e[t+1]=e[t+3],e[t+3]=a,this._doCryptBlock(e,t,this._invKeySchedule,c,d,u,m,n),a=e[t+1],e[t+1]=e[t+3],e[t+3]=a},_doCryptBlock:function(e,t,a,s,n,i,o,r){for(var l=this._nRounds,c=e[t]^a[0],d=e[t+1]^a[1],u=e[t+2]^a[2],m=e[t+3]^a[3],p=4,_=1;_<l;_++){var v=s[c>>>24]^n[d>>>16&255]^i[u>>>8&255]^o[255&m]^a[p++],h=s[d>>>24]^n[u>>>16&255]^i[m>>>8&255]^o[255&c]^a[p++],w=s[u>>>24]^n[m>>>16&255]^i[c>>>8&255]^o[255&d]^a[p++];m=s[m>>>24]^n[c>>>16&255]^i[d>>>8&255]^o[255&u]^a[p++],c=v,d=h,u=w}v=(r[c>>>24]<<24|r[d>>>16&255]<<16|r[u>>>8&255]<<8|r[255&m])^a[p++],h=(r[d>>>24]<<24|r[u>>>16&255]<<16|r[m>>>8&255]<<8|r[255&c])^a[p++],w=(r[u>>>24]<<24|r[m>>>16&255]<<16|r[c>>>8&255]<<8|r[255&d])^a[p++],m=(r[m>>>24]<<24|r[c>>>16&255]<<16|r[d>>>8&255]<<8|r[255&u])^a[p++],e[t]=v,e[t+1]=h,e[t+2]=w,e[t+3]=m},keySize:8});e.AES=t._createHelper(a)}();var Xo=Yo,Qo={stringify:function(e){var t={ct:e.ciphertext.toString(Xo.enc.Base64)};return e.iv&&(t.iv=e.iv.toString()),e.salt&&(t.s=e.salt.toString()),JSON.stringify(t).replace(/\s/g,"")},parse:function(e){var t=JSON.parse(e),a=Xo.lib.CipherParams.create({ciphertext:Xo.enc.Base64.parse(t.ct)});return t.iv&&(a.iv=Xo.enc.Hex.parse(t.iv)),t.s&&(a.salt=Xo.enc.Hex.parse(t.s)),a}};var Ko=e=>{let t="";if(!e.type)return t;if(!e.marked||"undefined"==e.marked)return t;switch(e.type){case"truefalse":case"single":case"survey":t=e.options[parseInt(e.marked)];break;case"multiple":if(t="",(a=e.marked.split(",")).length)for(let s=0;s<a.length;s++)t+=e.options[parseInt(a[s])]+(s+1<a.length?" , ":"");break;case"sort":case"match":if((a=e.marked.split(",")).length)for(let s=0;s<a.length;s++)"undefined"!==e.original_options[parseInt(a[s])-1]&&null!=e.original_options[parseInt(a[s])-1]&&""!=e.original_options[parseInt(a[s])-1]||(e.original_options[parseInt(a[s])-1]="____"),t+=e.original_options[parseInt(a[s])-1]+(s+1<a.length?" , ":"");break;case"select":if(t="",(a=e.marked.split("|")).length)for(let s=0;s<a.length;s++)t+=e.options[parseInt(a[s])]+(s+1<a.length?" , ":"");break;case"fillblank":case"text":var a;if(t="",(a=e.marked.split("|")).length)for(let e=0;e<a.length;e++)t+=a[e]+(e+1<a.length?" , ":"");break;case"largetext":case"smalltext":t=e.marked}return t};var Go=e=>{let t="";if(!e.type)return"";switch(e.type){case"truefalse":t=e.correct?window.wplms_course_data.translations.true:window.wplms_course_data.translations.false;break;case"single":case"survey":t=e.options[parseInt(e.correct)-1];break;case"multiple":if(t="",(a=e.correct.split(",")).length)for(let s=0;s<a.length;s++)t+=e.options[parseInt(a[s])-1]+(s+1<a.length?" , ":"");break;case"sort":case"match":if(t="",(a=e.correct.split(",")).length)for(let s=0;s<a.length;s++)t+=e.original_options[parseInt(a[s])-1]+(s+1<a.length?" , ":"");break;case"select":if(t="",(a=e.correct.split("|")).length)for(let s=0;s<a.length;s++)t+=e.options[parseInt(a[s])-1]+(s+1<a.length?" , ":"");break;case"fillblank":case"text":case"largetext":case"smalltext":var a;if(t="",(a=e.correct.split("|")).length)for(let e=0;e<a.length;e++)t+=a[e]+(e+1<a.length?" , ":"")}return t};function Zo(e){if(null==e)return!0;if(void 0===e)return!0;if("number"==typeof e)return!1;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var er=(e,t=null,a=null,s=null,n=!0)=>{s&&(s=parseFloat(s)),a||(s=null);let i=0,o=[],r=0;e.user_marks=0;let l=0,c=null;Zo(e.correct)||(c=JSON.parse(Xo.AES.decrypt(e.correct,e.key,{format:Qo}).toString(Xo.enc.Utf8))),e.correct=c,e.marked_answer&&"undefined"!=e.marked_answer||(e.marked_answer=null);let d=e.marked_answer;switch(e.type){case"truefalse":e.marked=d,e.correct=parseInt(c),d==c?(e.user_marks=e.marks,i=1):e.user_marks=0,o.push(c);break;case"single":e.marked=d,d==c-1?(e.user_marks=e.marks,i=1):e.user_marks=0,o.push(c-1);break;case"multiple":Zo(d)&&(d=[]);var u=d;e.marked=d.join(",").slice();var m=c.split(",");if(o=m,t){if(u.length)for(let e=0;e<u.length;e++){let t=u[e]+1;t=t.toString(),-1!==m.indexOf(t)?r++:l++}i=r/m.length,e.user_marks=Math.round(e.marks*i*100)/100}else if(u.length==m.length)for(let t=0;t<u.length;t++){e.user_marks=e.marks,i=1;let a=u[t]+1;if(a=a.toString(),-1==m.indexOf(a)){e.user_marks=0,i=0;break}}break;case"match":case"sort":Zo(d)&&(d=[]),e.marked=d.join(",").slice();let a=d,s=c.split(","),n=0;if(a&&a.length){for(let t=0;t<a.length;t++){e.user_marks=e.marks,i=1;let c="";Zo(a[t])||(c=a[t].toString()),s[t]!=c?(i&&(e.user_marks=0,i=0,n=1),l++):(r++,o.push(t))}t?(i=r/s.length,e.user_marks=Math.round(e.marks*i*100)/100):n&&(e.user_marks=0,i=0)}break;case"fillblank":Zo(d)&&(d=[]),d.map((e,t)=>{d[t]=e.toLowerCase()}),e.marked=d.join("|").slice(),c=c.toLowerCase();let p=c.split("|");if(e.user_marks=0,d.length){e.user_marks=e.marks,i=1;for(let t=0;t<d.length;t++){let a="";Zo(d[t])||(a=d[t].toString());let s=[];Zo(p[t])||Array.isArray(p[t])||(s=p[t].split(",")),-1==s.indexOf(a)?(i&&(e.user_marks=0,i=0),l++):(r++,o.push(t))}t?(i=r/p.length,e.user_marks=Math.round(e.marks*i*100)/100):d.length!==p.length&&(e.user_marks=0,i=0)}break;case"select":Zo(d)&&(d=[]),e.marked=d.join("|").slice();let _=c.split("|");if(e.user_marks=0,d&&d.length){e.user_marks=e.marks,i=1;for(let t=0;t<d.length;t++){let a="";a=(parseInt(d[t])+1).toString(),a!=_[t]?(i&&(e.user_marks=0,i=0),l++):(r++,o.push(t))}t?(i=r/_.length,e.user_marks=Math.round(e.marks*i*100)/100):d.length!==_.length&&(e.user_marks=0,i=0)}break;case"smalltext":case"largetext":e.marked=d,d&&c&&d.toLowerCase()==c.toLowerCase()?(e.user_marks=e.marks,i=1):e.user_marks=0}if(!Zo(d)&&s&&(t&&l>0?e.user_marks=e.user_marks-l*s:i||(e.user_marks=e.user_marks-s)),e.auto||n||(e.user_marks=0,e.show_correct_answer=0),o&&o.length)for(var p=o.length-1;p>=0;p--)"multiple"==e.type?o[p]=parseInt(o[p]-1):o[p]=parseInt(o[p]);return e.correct_indexes=o,e.auto&&(e.usercorrect=i,e.attempted=!0),e.marked=Ko(e),e.correct=Go(e),e};const{createElement:tr,render:ar,useState:sr,useEffect:nr,Fragment:ir,RawHTML:or}=wp.element;var rr=e=>{const[t,a]=sr({}),[s,n]=sr(!1);nr(()=>{a(e.question),setTimeout(()=>{n(!0)},200)},[]);let i="incorrect",o="checked_answer incorrect";return t.hasOwnProperty("user_marks")&&t.user_marks&&parseFloat(t.user_marks)>0&&(i="correct",o="checked_answer correct"),tr(ir,null,t.show_correct_answer?tr("div",{className:o},tr("strong",null,window.wplms_course_data.translations.correct_answer,tr(or,null,t.correct))):"",tr("div",{className:s?"question_wrapper loaded":"question_wrapper"},tr("div",{className:"result"},tr("div",{className:i},tr("span",null),tr("strong",null,t.user_marks)))))};const{createElement:lr,render:cr,useState:dr,useEffect:ur,Fragment:mr}=wp.element;var pr=e=>{let t="",a="";return ur(()=>{},[e.question]),e.question.hasOwnProperty("show_hint")&&e.question.show_hint?(a="question_hint_content message show",t="question_hint show"):(e.question.show_hint=0,a="question_hint_content message",t="question_hint"),lr(mr,null,e.question.hint?lr("span",{className:t,onClick:t=>{e.question.show_hint=!e.question.show_hint,e.update({...e.question},e.index,"changed")}}):"",e.question.hint?lr("span",{className:a,dangerouslySetInnerHTML:{__html:e.question.hint}}):"")};const{createElement:_r,render:vr,useState:hr,useEffect:wr,Fragment:fr}=wp.element;var gr=e=>{const[t,a]=hr({}),[s,n]=hr([]);wr(()=>{a(e.quiz),n(e.currentQuestions)},[e.quiz,e.currentQuestions]);let i=[];if(t.hasOwnProperty("meta")&&t.meta.hasOwnProperty("questions")&&t.meta.questions&&t.meta.questions.length&&(i=t.meta.questions),i.length)if(null!==e.filter)switch(e.filter){case"wrong":i=i.filter(e=>!e.hasOwnProperty("user_marks")||!e.user_marks||parseFloat(e.user_marks)<=0);break;case"correct":i=i.filter(e=>e.hasOwnProperty("user_marks")&&e.user_marks&&parseFloat(e.user_marks)>0);break;case"bookmarked":i=i.filter(t=>e.bookMarked.indexOf(t.id)>-1)}else i=t.meta.questions;return _r("div",{className:"quiz_timeline"},_r("div",{class:t&&t.meta&&t.meta.questions&&t.meta.questions.length>=10?"timeline_wrapper question_numbers":"timeline_wrapper"},_r("ul",null,t&&t.meta&&t.meta.questions&&t.meta.questions.length?i.map((a,i)=>{let o="";return e.bookMarked.indexOf(a.id)>-1&&(o+=" bookmarked"),("undefined"!=a.marked_answer&&null!=a.marked_answer||Array.isArray(a.marked_answer)&&a.marked_answer.length)&&(o+=" done",a.hasOwnProperty("attempted")&&a.attempted&&(a.hasOwnProperty("user_marks")&&a.user_marks&&parseFloat(a.user_marks)>0?o+=" correct":o+=" incorrect")),-1!==s.indexOf(i)&&(o+=" active"),_r("li",{className:o,"data-number":window.wplms_course_data.translations.question_prefix+(i+1)},_r("span",{onClick:a=>{((a,i,o)=>{a.preventDefault();let r=[...s],l=[];if(t.question_number&&"undefined"!=t.question_number&&t.question_number>0){if(-1!==r.indexOf(o))return;let e=Math.ceil((o+1)/t.question_number),a=e*t.question_number-t.question_number,s=e*t.question_number;for(let e=a;e<s;e++)l.push(e);n(l)}e.update(l,"show")})(a,0,i)}},a.marks))}):"",t&&t.meta&&t.meta.questions&&t.meta.questions.length?_r("span",{className:"hide_questions",onClick:e.hideQuestions},_r("span",{class:"vicon vicon-angle-double-left"}),_r("span",null,window.wplms_course_data.translations.hide_questions)):"")))};const{createElement:yr,render:br,useState:kr,useEffect:xr,Fragment:Nr}=wp.element;const{createElement:Ir,render:Cr,useState:Or,useEffect:Sr,Fragment:qr}=wp.element;var Pr=e=>{const[t,a]=Or({}),[s,n]=Or([]),[i,o]=Or(1);Sr(()=>{if(a(e.quiz),n(e.currentQuestions),e.currentQuestions.length){let t=Math.ceil((e.currentQuestions[0]+1)/e.quiz.question_number);o(t)}const t=document.createElement("script");t.src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js",t.async=!0,t.onload=()=>{document.dispatchEvent(new Event("VibeBP_Editor_Content"))},document.body.appendChild(t)},[e.quiz,e.currentQuestions]),Sr(()=>{a(e.quiz),r(null,1)},[e.filter]),Sr(()=>{"bookmarked"==e.filter&&e.questions.length&&s.length&&e.questions.length<=s[s.length-1]&&r(null,e.questions.length)},[e.bookMarked]);const r=(a,s)=>{if(a&&a.preventDefault(),i===s)return;let r=[],l=s*t.question_number-t.question_number,c=s*t.question_number;for(let e=l;e<c;e++)r.push(e);n(r),e.update(r,"show"),o(s)},l=(a=null,o)=>{a&&a.preventDefault();let r=[...s],l=[];if(t.question_number&&"undefined"!=t.question_number&&t.question_number>0)if(o>0){let a;a=t.question_number+r[r.length]>e.questions.length?e.questions.length:r[r.length-1]+t.question_number+1;for(let e=r[r.length-1]+1;e<a;e++)l.push(e);let s=i;s++,n(l)}else{for(let e=r[0]-1;e>=r[0]-t.question_number;e--)l.unshift(e);let e=i;e--,n(l)}e.update(l,"show")};return t&&t.meta&&e.questions&&e.questions.length?Ir("div",{class:"quiz_pagination_wrapper buttons has-addons"},e.questions[s[0]-1]&&"undefined"!=e.questions[s[0]-1]?Ir("span",{href:"#",className:"button ques_link left prevq",onClick:e=>{l(e,-1)}},Ir("i",{className:"vicon vicon-angle-left","aria-hidden":"true"})):Ir("span",{href:"#",className:"button ques_link left prevq faded"},Ir("i",{className:"vicon vicon-angle-left","aria-hidden":"true"})),(()=>{let a=Math.ceil(e.questions.length/t.question_number),s=a,n=[],o=0;if(a>1)for(;a;)if(a){let e=a;i==e?n.unshift(Ir("span",{className:"button active",onClick:t=>{r(t,e)}},a)):(i-1>=1||i+1<=s)&&(i-1==e||i+1==e||1==e||e==s?n.unshift(Ir("span",{className:"button",onClick:t=>{r(t,e)}},a)):o<2&&(n.unshift(Ir("span",{className:"button"},"...")),o++)),a--}return n})(),e.questions[s[s.length-1]+1]&&"undefined"!=e.questions[s[s.length-1]+1]?Ir("span",{href:"#",className:"button ques_link right nextq",onClick:e=>{l(e,1)}},Ir("i",{className:"vicon vicon-angle-right","aria-hidden":"true"})):Ir("span",{href:"#",className:"button ques_link right nextq faded"},Ir("i",{className:"vicon vicon-angle-right","aria-hidden":"true"}))):""};const{createElement:Er,render:zr,useState:Tr,useEffect:Mr,Fragment:jr,RawHTML:Lr}=wp.element;var Hr=e=>Er(jr,null,e.active?Er("div",{className:"confirmpopup_wrapper"},Er("div",{className:"confirmpopup_content"},Er("div",{dangerouslySetInnerHTML:{__html:e.content}}),Er("div",{className:"buttons_wrapper"},Er("span",{className:"button",onClick:t=>{e.yesfunction,e.update(e.type,"trigger")}},e.yes),Er("span",{className:"button",onClick:t=>{e.update(e.type,"nottrigger")}},e.no)))):"");const{createElement:Ar,render:Fr,useState:Dr,useEffect:Rr,Fragment:Jr}=wp.element;function Br(e){if(null==e)return!0;if(void 0===e)return!0;if("number"==typeof e)return!1;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var $r=e=>{const[t,a]=Dr(e.quiz),[s,n]=Dr(!1),[i,o]=Dr(""),[r,l]=Dr({}),[c,d]=Dr({});return Rr(()=>{let t=0,a=0,s=0,n=0;if(e.quiz&&e.quiz.meta&&e.quiz.meta.questions&&(e.quiz.meta.questions.map((e,i)=>{e.hasOwnProperty("usercorrect")&&e.hasOwnProperty("marked_answer")&&!Br(e.marked_answer)?parseInt(e.usercorrect)>0?t++:a++:s++,n++}),d({correct:t,incorrect:a,ommitted:s}),""!=i)){let e={datasets:[{data:[t,a,s],backgroundColor:["#82c362","#dc6a6a","#5381ab"]}],labels:[window.wplms_course_data.translations.correct+" ("+t+") ("+Math.round(t/n*100)+"%)",window.wplms_course_data.translations.incorrect+" ("+a+") ("+Math.round(a/n*100)+"%)",window.wplms_course_data.translations.unattempted+" ("+s+") ("+Math.round(s/n*100)+"%)"]},o=new Chart(i,{type:"pie",data:e});l(o)}},[i]),Ar("div",{className:"quiz_stats_chart"},t&&t.meta&&t.meta.questions&&t.meta.questions.length&&t.submitted?Ar(Jr,null,r&&c?Ar("div",{className:"quiz_stats_chart_pie"},Ar("canvas",{ref:e=>{e&&""==i&&o(e)}})):"",Ar("div",{className:"question_stats_content_wrapper"},Ar("span",{className:"question_stats_content_heading"},window.wplms_course_data.translations.historical),Ar("div",{className:"question_stats_content"},t.meta.questions.map((e,t)=>{if(e.hasOwnProperty("correct_data"))return Ar("div",{className:e.hasOwnProperty("user_marks")&&e.user_marks&&parseFloat(e.user_marks)>0?"checked_answer correct":"checked_answer incorrect"},Ar("span",null,window.wplms_course_data.translations.q,t+1),Ar("span",null,e.correct_data,"%"))})),t.hasOwnProperty("tags_data")&&!Br(t.tags_data)?Ar(Jr,null,Ar("span",{className:"question_stats_content_heading"},window.wplms_course_data.translations.correct_by_tag),Ar("div",{className:"question_stats_content"},t.tags_data.map(e=>Ar("div",{className:"checked_answer correct"},Ar("span",{dangerouslySetInnerHTML:{__html:e.label}}),Ar("span",null,e.value,"%"))))):"")):"")};const{createElement:Ur,render:Vr,useState:Wr,useEffect:Yr,Fragment:Xr}=wp.element,{dispatch:Qr,select:Kr}=wp.data;var Gr=e=>{const[t,a]=Wr([]),[s,n]=Wr(null),[i,o]=Wr(!0),[r,l]=Wr(null),[c,d]=Wr(!1);Yr(()=>{let e=Kr("vibebp").getToken();!function(e){if(null==e)return!0;if("number"==typeof e)return!0;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)?(u(e),n(e)):localforage.getItem("bp_login_token").then(t=>{e=t,u(e),n(e)})},[e.quizid]);const u=t=>{fetch(window.wplms_course_data.api_url+"/user/quiz/previousresults/"+e.quizid,{method:"post",body:JSON.stringify({token:t})}).then(e=>e.json()).then(e=>{e&&e.length&&a(e),o(!1)})};return i?"":Ur("div",{className:"previous_results_wrapper"},Ur("h3",{className:"subtitle",onClick:()=>{d(!c)}},Ur("span",null,window.wplms_course_data.translations.previous_results)," ",Ur("span",{className:c?"vicon vicon-minus":"vicon vicon-plus"})),c?r&&r.hasOwnProperty("id")?Ur("div",{className:"single_quiz_result quiz_results"},Ur("span",{className:"vicon vicon-arrow-left",onClick:()=>{l(null)}}),Ur(pl,{quizid:e.quizid,activity:r.id})):Ur("div",null,t.length?Ur("ul",{className:"quiz_results"},t.map(e=>Ur("li",{className:"result",onClick:()=>{l(e)}},Ur("span",{dangerouslySetInnerHTML:{__html:e.content}})))):Ur("div",{className:"vbp_message message"},window.wplms_course_data.translations.results_not_available)):"")};const{createElement:Zr,render:el}=wp.element;var tl=e=>Zr("div",{class:"lds-ellipsis"},Zr("div",null),Zr("div",null),Zr("div",null),Zr("div",null));const{createElement:al,render:sl,useState:nl,useEffect:il,useCallback:ol,useRef:rl,Fragment:ll,useLayoutEffect:cl}=wp.element,{dispatch:dl,select:ul}=wp.data;function ml(e){if(null==e)return!0;if("number"==typeof e)return!0;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var pl=e=>{const[t,a]=nl({}),[s,n]=nl("quiz"),[i,o]=nl([]),r=rl(null),l=rl(null),[c,d]=nl({}),[u,m]=nl("up"),[p,_]=nl(!1),[v,h]=nl(!1),[w,f]=nl(!1),[g,y]=nl(!0),[b,k]=nl(null),[x,N]=nl(null),[I,C]=nl([]),[O,S]=nl([]);il(()=>{let t=ul("vibebp").getToken();ml(t)?localforage.getItem("bp_login_token").then(e=>{t=e,M(t),k(t)}):(M(t),k(t)),document.addEventListener("wplms_answer_question_type",({detail:e})=>{j(e.question,e.index,"changed")}),localforage.getItem("bookmarked_questions_"+e.quizid).then(e=>{e&&e.length&&C(JSON.parse(e))})},[e.quizid]);const q=(P=e=>{let t=window.scrollY;if(!l||!l.current)return;let a=l.current.getBoundingClientRect();void 0!==e.target.scrollTop?(t=e.target.scrollTop,r&&r.current<t?(m("down"),console.log("-")):a.top<t&&m("up")):r&&r.current>t?m("up"):a.top<=t&&m("down"),r.current=t},E=200,function(){var e=this,t=arguments,a=function(){T=null,z||P.apply(e,t)},s=z&&!T;clearTimeout(T),T=setTimeout(a,E),s&&P.apply(e,t)});var P,E,z,T;cl(()=>{if(!s){if(document.querySelector(".course_status"))return document.querySelector(".course_status").addEventListener("scroll",q,{passive:!1}),()=>{document.querySelector(".course_status").removeEventListener("scroll",q)};if(document.querySelector(".incourse"))return window.addEventListener("scroll",q,{passive:!1}),()=>{window.removeEventListener("scroll",q)}}});const M=(t=null)=>{t||(t=b),n("quiz");let s={token:t};e.hasOwnProperty("activity")&&e.activity&&(s.activity=e.activity),fetch(window.wplms_course_data.api_url+"/user/quiz/"+e.quizid,{method:"post",body:JSON.stringify(s)}).then(e=>e.json()).then(e=>{if(e){if(N(null),e.meta&&e.meta.questions){let t=0,s=0;if("object"==typeof e.meta.questions&&!Array.isArray(e.meta.questions)){let t=[];Object.keys(e.meta.questions).map(a=>{"object"==typeof e.meta.questions[a]&&(e.meta.questions[a].id=a,t.push(e.meta.questions[a]),t.id=a)}),e.meta.questions=t}e.meta.questions.map((a,n)=>{if(a.raw)e.meta.questions[n]=a.raw;else{e.meta.questions[n].show=!1;let t=localStorage.getItem(a.id);!ml(t)&&ml(a.marked_answer)&&(!function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(t)?a.marked_answer=t:a.marked_answer=JSON.parse(t)),a.attempted&&(e.meta.questions[n].correct=JSON.parse(Xo.AES.decrypt(a.correct,a.key,{format:Qo}).toString(Xo.enc.Utf8)),a.correct=Go(a))}t+=parseFloat(a.marks),s+=parseInt(a.max_marks)}),Number.isInteger(t)||(t=t.toFixed(2)),e.marks=t,e.max_marks=s,e.question_number=parseInt(e.question_number);let n=[];if(e.question_number&&e.question_number>0)for(let t=0;t<e.question_number;t++)n.push(t);o(n),a(e)}e.remaining&&e.remaining<=0&&A(e,t);var s=document.createEvent("Event");s.initEvent("unit_traverse",!1,!0),document.querySelector(".unit_content")&&document.querySelector(".unit_content")&&document.querySelector(".unit_content").dispatchEvent(s)}else console.log(e);n(!1)})},j=(e,s,n)=>{if("changed"==n){let n={...t};n.meta.questions[s]=e,a(n),ml(e.marked_answer)?null==e.marked_answer&&localStorage.removeItem(e.id):"object"==typeof e.marked_answer||Array.isArray(e.marked_answer)?localStorage.setItem(e.id,JSON.stringify(e.marked_answer)):localStorage.setItem(e.id,e.marked_answer)}},L=(e,t)=>{"show"==t&&o(e)},H=()=>{n("start");let e={...t};e.start=!0,t.remaining&&t.remaining>0?(n(!1),a(e)):fetch(window.wplms_course_data.api_url+"/user/quiz/start",{method:"POST",body:JSON.stringify({quiz_id:e.id,token:b})}).then(e=>e.json()).then(t=>{n(!1),a(e)})},A=(s=null,i=null)=>{C([]),localforage.removeItem("bookmarked_questions_"+e.quizid),s||(s=t),i||ml(b)||(i=b),n("submit");let o={...s},r=0,l=0;if(o.meta&&o.meta.questions&&o.meta.questions.length)for(let e=0;e<o.meta.questions.length;e++)o.meta.questions[e].attempted||(o.meta.questions[e]=er(o.meta.questions[e],t.partial_marking,t.negative_marking,parseFloat(t.negative_marks),!1)),o.meta.questions[e].content=o.meta.questions[e].original_content,o.meta.questions[e].auto||(o.meta.questions[e].user_marks=0),r+=parseFloat(o.meta.questions[e].user_marks),l+=parseInt(o.meta.questions[e].marks),localStorage.removeItem(o.meta.questions[e].id);o.marks=r.toFixed(2),o.max_marks=l,fetch(window.wplms_course_data.api_url+"/user/submitresult/",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({quiz_id:o.id,course_id:o.course_id,results:o.meta.questions,quiz:o,token:i})}).then(e=>e.json()).then(t=>{if(t){if(n(!1),o.submitted=!0,o.start=!1,t.check_results_url&&(o.check_results_url=t.check_results_url),t.completion_message&&(o.meta.completion_message=t.completion_message),t.retake_html&&(o.retake_html=t.retake_html),o.meta&&o.meta.questions&&o.meta.questions.length&&!ml(t.correct_data))for(let e=0;e<o.meta.questions.length;e++)t.correct_data.hasOwnProperty(o.meta.questions[e].id)&&(o.meta.questions[e].correct_data=t.correct_data[o.meta.questions[e].id]);t.hasOwnProperty("tags_data")&&(o.tags_data=t.tags_data),a(o);var s=document.createEvent("Event");if(s.initEvent("unit_traverse",!1,!0),o.hasOwnProperty("quiz_passing_score")&&o.quiz_passing_score?t.hasOwnProperty("continue")&&t.continue&&e.hasOwnProperty("update")&&e.update("quizsubmitted"):e.hasOwnProperty("update")&&e.update("quizsubmitted"),document.querySelector(".unit_content")&&document.querySelector(".unit_content")){document.querySelector(".unit_content").dispatchEvent(s);var i=new CustomEvent("react_quiz_submitted",{detail:{next_unit:t.next_unit}});document.dispatchEvent(i)}}})},F=(e,a)=>{switch(e.type){case"smalltext":return al(Ei,{question:e,index:a,update:j});case"single":return al(Hi,{question:e,index:a,update:j,quiz_id:t.id});case"select":return al(Bi,{question:e,index:a,update:j,quiz_id:t.id});case"multiple":return al(Xi,{question:e,index:a,update:j,quiz_id:t.id});case"fillblank":return al(ro,{question:e,index:a,update:j,quiz_id:t.id});case"sort":return al(yo,{question:e,index:a,update:j,quiz_id:t.id});case"match":return al(To,{question:e,index:a,update:j,quiz_id:t.id});case"truefalse":return al(Fo,{question:e,index:a,update:j,quiz_id:t.id});case"largetext":return al(Wo,{question:e,index:a,update:j,quiz_id:t.id});default:return document.dispatchEvent(new CustomEvent("wplms_load_question_type",{detail:{question:e,quiz_id:t.id,index:a}})),al("div",{"data-q":e.id,className:e.type})}},D=(e,a)=>{if("trigger"==a)switch(e){case"submit":A(t),h(!1),f(!1);break;case"start":H(),_(!1)}if("nottrigger"==a)switch(e){case"submit":h(!1),f(!1);break;case"start":_(!1)}};let R=0;t.meta&&t.meta.duration&&(R=t.meta.duration),t&&t.remaining&&t.remaining>0&&(R=t.remaining);let J="",B="loading_quiz";s||(J="disabled",B+=" disabled");let $=window.wplms_course_data.translations.submit_quiz_confirm;if(t.meta&&t.meta.questions){let e=1;t.meta.questions.map((function(t){t.marked_answer||(e=0)})),e||($=window.wplms_course_data.translations.unanswered_confirm+$)}let U=[];if(t.hasOwnProperty("meta")&&t.meta.hasOwnProperty("questions")&&t.meta.questions&&t.meta.questions.length&&(U=t.meta.questions),U.length&&null!==x)switch(x){case"wrong":U=U.filter(e=>!e.hasOwnProperty("user_marks")||!e.user_marks||parseFloat(e.user_marks)<=0);break;case"correct":U=U.filter(e=>e.hasOwnProperty("user_marks")&&e.user_marks&&parseFloat(e.user_marks)>0);break;case"bookmarked":U=U.filter(e=>I.indexOf(e.id)>-1)}return"quiz"!==s?al(ll,null,al(Hr,{active:v,update:D,type:"submit",content:$,yes:window.wplms_course_data.translations.yes,no:window.wplms_course_data.translations.no,yesfunction:"submitQuiz"}),ReactDOM.createPortal(al(Hr,{active:w,update:D,type:"submit",content:window.wplms_course_data.translations.bookmark_confirm,yes:window.wplms_course_data.translations.yes,no:window.wplms_course_data.translations.no,yesfunction:"submitQuiz"}),document.querySelector("#quiz_popup")),al(Hr,{active:p,update:D,type:"start",content:window.wplms_course_data.translations.start_quiz_confirm,yes:window.wplms_course_data.translations.yes,no:window.wplms_course_data.translations.no,yesfunction:"startQuiz"}),al("div",{className:"incourse"},al("div",{className:B},al("div",{id:"ajaxloader",className:J})),e.hasOwnProperty("activity")?t.submitted?al("h3",null,al("span",{className:"student_score"},t.meta.auto?t.marks+"/"+t.max_marks:""),t.quiz_passing_score?al("span",null,t.marks>t.quiz_passing_score?window.wplms_course_data.translations.passed:window.wplms_course_data.translations.failed):""):"":al("div",{className:"up"==u?"incoursequiz_details show_controls":"incoursequiz_details hide_controls",ref:l},al("div",null,t.submitted?al("strong",{onClick:()=>{m("up"==u?"down":"up")}},al("span",{className:"student_score"},t.meta.auto?t.marks+"/"+t.max_marks:""),t.quiz_passing_score?al("span",null,t.marks>t.quiz_passing_score?window.wplms_course_data.translations.passed:window.wplms_course_data.translations.failed):"",al("span",{className:"student_quiz_status"},window.wplms_course_data.translations.quiz_submitted)):al("div",{className:"quiztimer_wrapper",onClick:()=>{m("up"==u?"down":"up")}},t&&t.meta&&t.meta.duration&&parseInt(t.meta.duration)<863913600?al(Ii,{duration:R,update:(e,a)=>{"expired"==a&&A(t)},quiz_id:t.id,start:t.start}):al("strong",null,window.wplms_course_data.translations.no_time_limit)),t&&t.meta&&t.meta.questions&&t.meta.questions.length&&!g?al("span",{className:"show_questions",onClick:()=>y(!0)},al("span",null,window.wplms_course_data.translations.show_questions),al("span",{className:"vicon vicon-angle-double-right"})):"",t&&t.meta&&t.meta.questions&&t.meta.questions.length&&t.submitted?al("div",{className:"buttons has-addons small"},al("a",{className:"correct"==x?"button tip end is-focused":"button tip",title:window.wplms_course_data.translations.show_correct_attempts,onClick:()=>{N("correct"!=x?"correct":null)}},al("span",{className:"vicon vicon-check"})),al("a",{className:"wrong"==x?"button tip end is-focused":"button tip",title:window.wplms_course_data.translations.show_wrong_attempts,onClick:()=>{N("wrong"!=x?"wrong":null)}},al("span",{className:"vicon vicon-close"}))):"",t&&t.meta&&t.meta.questions&&t.meta.questions.length&&I.length?al("div",{className:"buttons has-addons"},al("a",{className:"bookmarked"==x?"button tip end is-focused":"button tip",title:window.wplms_course_data.translations.show_bookmarked,onClick:()=>{N("bookmarked"!=x?"bookmarked":null)}},al("span",{className:"vicon vicon-bookmark-alt"}))):"",!t.submitted||t.meta&&t.meta.retakes>0?al("div",{className:"incourse_quiz_button"},t.start||t.submitted?"":t.remaining&&t.remaining>0?al("a",{className:"continue_quiz button is-primary",onClick:H},window.wplms_course_data.translations.continue):t.meta.hasOwnProperty("check_access")&&t.meta.check_access.hasOwnProperty("status")&&!t.meta.check_access.status?al("div",{className:"check_quiz",dangerouslySetInnerHTML:{__html:t.meta.check_access.html}}):al("a",{className:"start"===s?"start_quiz button full is-primary is-loading":"start_quiz  full button is-primary",onClick:()=>{window.wplms_course_data.start_popup?_(!0):H()}},window.wplms_course_data.translations.start),t.start&&!t.submitted?al("a",{className:"save"===s?"save_quiz button is-primary is-loading":"save_quiz button is-primary",onClick:()=>{if(t.meta.questions&&t.meta.questions.length){n("save");let e=[];t.meta.questions.map((t,a)=>{let s={...t};null==s.marked_answer||"undefined"==s.marked_answer||ml(s.marked_answer)||t.attempted||(s.correct=Go(s),e.push(s))}),fetch(window.wplms_course_data.api_url+"/user/savequiz",{method:"POST",body:JSON.stringify({quiz_id:t.id,questions:e,token:b})}).then(e=>e.json()).then(e=>{n(!1)})}}},window.wplms_course_data.translations.save_quiz):"",t.start&&!t.submitted?al("a",{className:"submit"===s?"submit_quiz button is-primary is-loading":"submit_quiz button is-primary",onClick:()=>{window.wplms_course_data.submit_popup?h(!0):I.length?f(!0):A()}},window.wplms_course_data.translations.submit):"",!t.start&&t.submitted&&t.meta&&t.meta.retakes>0?al("div",{className:"quiz_retake",onClick:()=>(n("retake"),void fetch(window.wplms_course_data.api_url+"/user/coursestatus/retake_single_quiz/"+e.quizid,{method:"post",body:JSON.stringify({token:b})}).then(e=>e.json()).then(t=>{t&&(t.status?(M(),e.hasOwnProperty("update")&&e.update("retake_quiz")):t.message&&(dl("vibebp").addNotification({icon:"",text:t.message}),n(!1)))}))},al("a",{className:"retake"===s?"retake_quiz button is-primary is-loading":"retake_quiz button is-primary"},window.wplms_course_data.translations.retake),al("strong",null,window.wplms_course_data.translations.retakes_left," : ",t.meta.retakes)):""):""),g?al(gr,{hideQuestions:()=>y(!1),quiz:t,currentQuestions:i,update:L,filter:x,bookMarked:I}):""),al("div",{className:"quiz_questions_content"},al("div",{className:""},t.start||t.submitted?"":al("div",{className:"quiz_content",dangerouslySetInnerHTML:{__html:t&&t.content?t.content:""}}),!t.start&&t.submitted?al("div",{className:""},al("div",{className:"quiz_content",dangerouslySetInnerHTML:{__html:t.meta.completion_message}}),!t.start&&t.submitted&&t.retake_html?al("div",{dangerouslySetInnerHTML:{__html:t.retake_html}}):""):"",t.start||!t.submitted||e.hasOwnProperty("activity")?"":al(Gr,{quizid:e.quizid}),t&&t.meta&&t.meta.questions&&t.submitted&&t.meta.auto&&t.show_advance_stats&&!e.hasOwnProperty("activity")?al($r,{quiz:t}):"",t&&t.meta&&U&&(t.start||t.submitted)?U.map((o,r)=>{if(-1===i.indexOf(r))return;let l="",c="";return o.hasOwnProperty("show_hint")&&o.show_hint?(c="question_hint_content message show",l="question_hint show"):(c="question_hint_content message",l="question_hint"),al("div",{className:"question"},al("div",{className:"question_actions"},al("span",null,window.wplms_course_data.translations.question_full_prefix," ",r+1),al("div",null,al("span",{className:"marks"},al("i",{className:"vicon vicon-medall"}),o.marks),al("span",{className:O.indexOf(o.id)>-1?"is-loading":o.flagged?"flagged":"flag",onClick:()=>{((e,s)=>{let n=[...O];n.indexOf(e.id)<=-1&&n.push(e.id),S(n),fetch(window.wplms_course_data.api_url+"/user/question/flag/"+e.id,{method:"post",body:JSON.stringify({token:b,flagged:e.hasOwnProperty("flagged")&&e.flagged})}).then(e=>e.json()).then(i=>{if(i)if(i.status){let i=n.indexOf(e.id);i>-1&&(n.splice(i,1),S(n));let o={...t};o.meta.questions[s].flagged=!(e.hasOwnProperty("flagged")&&e.flagged),a(o)}else i.message&&dl("vibebp").addNotification({icon:"",text:i.message})})})(o,r)}},al("i",{className:o.flagged?"vicon vicon-flag-alt":"vicon vicon-flag"})),o.hint?al("span",{className:l,onClick:e=>{let s={...t};s.meta.questions[r].hasOwnProperty("show_hint")&&s.meta.questions[r].show_hint?s.meta.questions[r].show_hint=!1:s.meta.questions[r].show_hint=!0,a(s)}}):"")),F(o,r),!t.submitted&&t.start?al("span",{className:"bookmark button",onClick:()=>{(t=>{let a=[...I],s=a.indexOf(t.id);s<=-1?a.push(t.id):a.splice(s,1),localforage.setItem("bookmarked_questions_"+e.quizid,JSON.stringify(a)),C(a),a.length||"bookmarked"!=x||N(null)})(o)}},al("i",{className:I.indexOf(o.id)>-1?"vicon vicon-bookmark-alt":"vicon vicon-bookmark"})):"",o.attempted||!t.check_answer||t.submitted?"":al("div",{className:"checkanswer"===s?"check_answer button is-primary is-loading":"check_answer button is-primary",onClick:e=>{((e,s)=>{n("checkanswer");let i=er(e,t.partial_marking,t.negative_marking,parseFloat(t.negative_marks),!0),o={...t};i.attempted=!0,o.meta.questions[s]=i,fetch(window.wplms_course_data.api_url+"/user/saveuserquestion",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({quiz_id:o.id,question:i,token:b})}).then(e=>e.json()).then(e=>{n(!1),a(o)})})(o,r)}},window.wplms_course_data.translations.check_answer),o.hint?al("span",{className:c,dangerouslySetInnerHTML:{__html:o.hint}}):"",o.attempted?al(rr,{question:o}):"",o.attempted&&o.show_correct_answer&&o.explanation.length?al("div",{className:"explanation"},al("strong",null,window.wplms_course_data.translations.question_explanation),al("div",{dangerouslySetInnerHTML:{__html:o.explanation}})):"")}):"",t&&t.meta&&t.meta.questions&&(t.start||t.submitted)?al(Pr,{quiz:t,questions:[...U],currentQuestions:i,filter:x,update:L,bookMarked:I}):"")))):al(tl,null)},_l=a(0),vl=a.n(_l);const{createElement:hl,useState:wl,useEffect:fl,useRef:gl,Fragment:yl,render:bl}=wp.element,{dispatch:kl,select:xl}=wp.data,Nl=Math.round(100*Math.random());var Il=e=>{const t=gl(null),[a,s]=wl(!1),[n,i]=wl(!1),[o,r]=wl(""),[l,c]=wl(""),[d,u]=wl(""),[m,p]=wl(""),[_,v]=wl({x:0,y:0,width:0,height:0,type:"image"}),[h,w]=wl(""),[f,g]=wl(window.wplms_course_data.translations.select_image);fl(()=>{e.hasOwnProperty("crop")&&e.crop&&s(!0)},[]),fl(()=>{if(n&&h&&a)new vl.a(h,{returnMode:"ratio",onCropEnd:function(t){let a={..._};a.x=100*t.x,a.y=100*t.y,a.height=100*t.height,a.width=100*t.width,v(a);let s={x:h.naturalWidth*t.x,y:h.naturalHeight*t.y,width:h.naturalWidth*t.width,height:h.naturalHeight*t.height};e.update(m,s)}})},[n,h]);_.x,_.y,_.width,_.height;return hl("div",{className:"uploader"},hl("label",{for:"fileupload_"+Nl,className:"upload_file"},f,"image"==e.type?hl("input",{id:"fileupload_"+Nl,"data-type":e.type,ref:t,type:"file",accept:"image/*",onChange:a=>{t.current.files[0].size<window.wplms_course_data.settings.upload_limit?(r(window.URL.createObjectURL(t.current.files[0])),p(t.current.files[0]),e.update(t.current.files[0],{..._,key:"image"})):(g(window.wplms_course_data.translations.image_size_error),setTimeout(()=>{g(window.wplms_course_data.translations.select_image)},3500))}}):"video"==e.type?hl("input",{id:"fileupload_"+Nl,"data-type":e.type,ref:t,type:"file",accept:"video/*",onChange:a=>{t.current.files[0].size<window.wplms_course_data.settings.upload_limit?(c(window.URL.createObjectURL(t.current.files[0])),p(t.current.files[0]),e.update(t.current.files[0],{..._,key:"video"})):(g(window.wplms_course_data.translations.image_size_error),setTimeout(()=>{g(window.wplms_course_data.translations.select_image)},3500))}}):hl("input",{id:"fileupload_"+Nl,"data-type":e.type,ref:t,type:"file",onChange:a=>{t.current.files&&t.current.files[0]&&(t.current.files[0].size<e.args.allowed_file_size?-1!==e.args.allowed_mime_types.indexOf(t.current.files[0].type)?(u(window.URL.createObjectURL(t.current.files[0])),p(t.current.files),e.update(t.current.files,{..._,key:"attachment"})):(g(window.wplms_course_data.translations.image_type_error),setTimeout(()=>{g(window.wplms_course_data.translations.select_image)},3500)):(g(window.wplms_course_data.translations.image_size_error),setTimeout(()=>{g(window.wplms_course_data.translations.select_image)},3500)))}})))};const{Component:Cl,createElement:Ol,render:Sl,useState:ql,useEffect:Pl,Fragment:El}=wp.element;var zl=e=>{const[t,a]=ql(e.duration),[s,n]=ql({d:0,h:0,m:0,s:0});Pl(()=>{if(e.start){setTimeout(()=>{let s=t-1;s<=-1?e.update(e.quiz_id,"expired"):s>=0&&(a(s),i())},1e3)}else a(e.duration),i()},[t,e.start,e.duration]);const i=()=>{let e={...s},a=t;a>86400?(e.d=Math.floor(a/86400),a-=86400*e.d):e.d=0,a>3600?(e.h=Math.floor(a/3600),a-=3600*e.h):e.h=0,a>60?(e.m=Math.floor(a/60),a-=60*e.m):e.m=0,e.s=a,n(e)};let o="c100 p0 big";if(t>-1){let a=Math.floor((e.duration-t)/e.duration*100);a<=0&&(a=1),o="c100 p"+a+" big"}return Ol("div",{className:"quiztimer"},Ol(El,null,Ol("div",{className:"circle_timer"},Ol("div",{className:o},Ol("span",null,Ol("span",{className:"timer_amount"},s.d?Ol(El,null,Ol("span",null,s.d),Ol("span",null,":")):"",s.h?Ol(El,null,Ol("span",null,s.h),Ol("span",null,":")):"",s.m?Ol(El,null,Ol("span",null,s.m),Ol("span",null,":")):"",Ol("span",null,s.s)),Ol("span",{className:"timer_unit"},s.d?Ol(El,null,Ol("span",null,window.wplms_course_data.translations.days),Ol("span",null)):"",s.h?Ol(El,null,Ol("span",null,window.wplms_course_data.translations.hours),Ol("span",null)):"",s.m?Ol(El,null,Ol("span",null,window.wplms_course_data.translations.minutes),Ol("span",null)):"",Ol("span",null,window.wplms_course_data.translations.seconds))),Ol("div",{className:"slice"},Ol("div",{className:"bar"}),Ol("div",{className:"fill"}))))))};const{createContext:Tl}=wp.element;var Ml=Tl({courseStatus:{},current_unit_key:0,update:e=>{}});var jl=function(e){if(void 0===e)return!0;if("undefined"===e)return!0;if(null==e)return!0;if("number"==typeof e)return!1;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};const{createElement:Ll,useState:Hl,useEffect:Al,Fragment:Fl,render:Dl,useContext:Rl}=wp.element,{dispatch:Jl,select:Bl}=wp.data;var $l=e=>{const[t,a]=Hl(!0),[s,n]=Hl({}),[i,o]=Hl([]),[r,l]=Hl(""),[c,d]=Hl(!1);Rl(Ml);let u=Bl("vibebp").getUser();u.token=Bl("vibebp").getToken(),Al(()=>{a(!0),fetch(`${window.wplms_course_data.api_url}/user/content/assignmentId/${e.assignment.id}`,{method:"post",body:JSON.stringify({token:u.token})}).then(e=>e.json()).then(e=>{e&&(e.hasOwnProperty("remaining")&&(e.duration=e.remaining),e.hasOwnProperty("comment_content")&&l(e.comment_content),n(e),a(!1))}),document.addEventListener("wplms_assignment_custom_upload",({detail:e})=>{if(e.hasOwnProperty("data")&&e.data.hasOwnProperty("Key")&&e.data.Key.length){let t=[...i],a=e.data.Key.split("/");t.push({...e.data,name:a[a.length-1]}),o(t)}})},[e.assignment]);const m=(t=null)=>{let a=r;if(!t&&s&&s.type&&"upload"==s.type){if(!i||i.length<=0)return alert(window.wplms_course_data.translations.upload_a_file),!1;jl(a)&&(a=s.title+" - "+(u.displayname?u.displayname:u.name?u.name:""))}else if(t&&jl(a)&&(a=s.title+" - "+(u.displayname?u.displayname:u.name?u.name:"")),!a||a.length<=3)return alert(window.wplms_course_data.translations.error),!1;d(!0);var o=new FormData;o.append("body",JSON.stringify({comment:a,attachments:i,token:Bl("vibebp").getToken()})),i.length&&i.map((e,t)=>{e instanceof File?o.append("files_"+t,e):o.append("files_"+t,JSON.stringify(e))}),fetch(`${window.wplms_course_data.api_url}/user/upload/assignmentId/${e.assignment.id}`,{method:"post",body:o}).then(e=>e.json()).then(t=>{if(d(!1),t){let a={...s};t.attachment_urls&&t.attachment_urls.length&&(a.attachment_urls=t.attachment_urls),t.comment_id&&(a.flag=1,a.already_submitted=!0,e.hasOwnProperty("unitIndex")?e.update({unitIndex:e.unitIndex,assignmentIndex:e.assignmentIndex},"complete"):e.update({},"submitassignment")),n(a)}})};let p={allowed_mime_types:s.permit_mime,allowed_file_size:parseInt(s.permit_size)};return t?Ll(tl,null):Ll("div",{className:"course_assignment_wrapper"},Ll("div",{className:"course_assignment"},Ll("div",{className:"assignment_details"},Ll("div",{className:"assignment_marks"},Ll("span",null,s.total_marks),Ll("span",null,window.wplms_course_data.translations.total_marks)),Ll(zl,{duration:s.duration,update:(e,t)=>{"expired"==t&&(s.already_submitted||m(!0))},quiz_id:s.id,start:s.start})),Ll("div",{className:"assignment_content_wrapper"},Ll("div",{className:"assignment_content",dangerouslySetInnerHTML:{__html:s.content}}),s.type&&"upload"==s.type&&s&&s.permit_extension&&s.permit_extension.length&&s.flag<=2?Ll("div",{className:"allowed_file_extenstions"},Ll("label",null,window.wplms_course_data.translations.allowed_file_extenstions),s.permit_extension.map(e=>Ll("span",null,e))):"",s.start?"":Ll("a",{className:"assignment_start_button button is-primary",onClick:()=>{fetch(`${window.wplms_course_data.api_url}/user/start/assignmentId/${e.assignment.id}`,{method:"post",body:JSON.stringify({token:Bl("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(e&&e.start){let e={...s};e.start=!0,n(e)}})}},window.wplms_course_data.translations.start_assigmment),s.start&&s.flag<=2?Ll(Fl,null,s.already_submitted?Ll(Fl,null,s.attachment_urls&&s.attachment_urls.length?Ll(Fl,null,window.wplms_course_data.translations.uploaded_files,Ll("div",{className:"assignment_attachments"},s.attachment_urls.map((e,t)=>Ll("div",null,Ll("a",{href:e.url,target:"_blank",download:!0},e.name))))):"",s.hasOwnProperty("flag")&&1==s.flag&&s.duration>0?Ll("div",{className:"resubmit ",onClick:()=>{(()=>{let t={...s};t.already_submitted=!1,t.flag=0,e.hasOwnProperty("unitIndex")?e.update({unitIndex:e.unitIndex,assignmentIndex:e.assignmentIndex},"retake"):e.update({},"retookassignment"),n(t)})()}},Ll("a",{className:"button is-primary"},window.wplms_course_data.translations.resubmit,Ll("span",{className:"vicon vicon-close"}))):""):"",s.type&&"upload"==s.type&&!s.already_submitted?Ll("div",{className:"upload_assignment"},s.hasOwnProperty("custom_upload")&&s.custom_upload?Ll("div",null,(_=new CustomEvent("custom_assignment_upload",{detail:{data:s}}),document.dispatchEvent(_),Ll("div",{className:"custom_assignment_upload",id:s.custom_upload}))):Ll(Il,{type:1,update:(e,t)=>{let a=[...i];a.push(new File([e[0]],e[0].name)),o(a)},args:p}),i?Ll("div",{className:"assignment_attachments"},i.map((e,t)=>Ll("div",null,Ll("span",null,e.name),Ll("span",{className:"vicon vicon-close",onClick:()=>{(e=>{let t=[...i];t.splice(e,1),o(t)})(t)}})))):"",Ll(Ds,r?{field:{id:"assignment_text",value:r,components:["editor"]},update:(e,t,a)=>{l(e.value)}}:{field:{id:"assignment_text",components:["editor"]},update:(e,t,a)=>{l(e.value)}})):"",!s.hasOwnProperty("type")||s.type&&"textarea"==s.type?Ll(Ds,{field:r?{id:"assignment_text",value:r,components:["editor"]}:{id:"assignment_text",components:["editor"]},update:(e,t,a)=>{l(e.value)}}):""):"",s.flag&&s.hasOwnProperty("marks")&&s.flag>1?Ll("div",{className:"assigment_evaluated"},s.message?Ll("span",null,s.message):"",s.marks?Ll("span",null,window.wplms_course_data.translations.marks_obtained," : ",s.marks):"",s.hasOwnProperty("instructor_remarks")?Ll("div",{className:"remarks"},Ll("h3",null,window.wplms_course_data.translations.instructor_remarks," "),Ll("div",{dangerouslySetInnerHTML:{__html:s.instructor_remarks}})):""):"")),s.start&&!s.already_submitted?Ll("a",{className:c?"button is-primary is-loading":"button is-primary",onClick:()=>{m()}},window.wplms_course_data.translations.submit_assignment):"");var _};const{Component:Ul,createElement:Vl,render:Wl,useState:Yl,useEffect:Xl,Fragment:Ql}=wp.element;var Kl=e=>{const[t,a]=Yl(e.duration),[s,n]=Yl({d:0,h:0,m:0,s:0});Xl(()=>{if(e.start){setTimeout(()=>{let s=t-1;s<=-1?e.update(e.quiz_id,"expired"):s>=0&&(a(s),i())},1e3)}else a(e.duration),i()},[t,e.start,e.duration]);const i=()=>{let e={...s},a=t;a>86400?(e.d=Math.floor(a/86400),a-=86400*e.d):e.d=0,a>3600?(e.h=Math.floor(a/3600),a-=3600*e.h):e.h=0,a>60?(e.m=Math.floor(a/60),a-=60*e.m):e.m=0,e.s=a,n(e)};return Vl("div",{className:"driptimer_wrapper"},Vl("div",{className:"driptimer"},Vl("span",{className:"timer_amount"},s.d?Vl(Ql,null,Vl("span",null,s.d),Vl("span",null,":")):"",s.h?Vl(Ql,null,Vl("span",null,s.h),Vl("span",null,":")):"",s.m?Vl(Ql,null,Vl("span",null,s.m),Vl("span",null,":")):"",Vl("span",null,s.s)),Vl("span",{className:"timer_unit"},s.d?Vl(Ql,null,Vl("span",null,window.wplms_course_data.translations.days),Vl("span",null)):"",s.h?Vl(Ql,null,Vl("span",null,window.wplms_course_data.translations.hours),Vl("span",null)):"",s.m?Vl(Ql,null,Vl("span",null,window.wplms_course_data.translations.minutes),Vl("span",null)):"",Vl("span",null,window.wplms_course_data.translations.seconds))))};const{createElement:Gl,render:Zl,useState:ec,useEffect:tc,Fragment:ac,useContext:sc,useRef:nc}=wp.element,{dispatch:ic,select:oc}=wp.data;var rc=e=>{const t=nc(null),[a,s]=ec(Math.round(1e4*Math.random())),[n,i]=ec(!1),[o,r]=ec(!1),l=(e,t)=>{console.log(e,t),void 0===t&&(t=window.location.href);var a=t.match("[?&]"+e+"=([^&]+)");return a?a[1]:null};tc(()=>{if(d(),document.querySelector("#item_"+e.index)){let t={};if("youtube"==e.provider&&(t.youtube={modestbranding:1}),"vimeo"==e.provider&&(t.vimeo={controls:!0,playsinline:!1},t.controls=[]),window.wplms_course_data.course.status.seek_lock&&(t.listeners={seek:e=>{var t=n.currentTime;if(_getTargetTime(n,e)>t)return e.preventDefault(),!1}}),e.hasOwnProperty("src")&&"mpd"==e.src.split(".").pop())dashjs.MediaPlayer().create().initialize(document.querySelector("#item_"+e.index),e.src,!0);let s=new Plyr(document.querySelector("#item_"+e.index),t);if(e.hasOwnProperty("src")&&"m3u8"==e.src.split(".").pop())if(Hls.isSupported()){const t=new Hls;t.loadSource(e.src),t.attachMedia(document.querySelector("#item_"+e.index))}else document.querySelector("#item_"+e.index).src=e.src;r(s),s.once("loadeddata",()=>{let t=localStorage.getItem(e.url);t&&t<=o.duration&&(s.currentTime=t),i({plyr:s,url:e.url})}),s.once("ready",()=>{if("youtube"==e.provider){let t=l("t",e.url);t&&void 0!==t||(t=l("start",e.url)),t&&(s.currentTime=t)}"vimeo"==e.provider&&document.querySelector(".plyr__poster")&&document.querySelector(".item_player_"+a+" .plyr__poster")&&document.querySelector(".item_player_"+a+" .plyr__poster").remove()}),s.once("ended",c)}return()=>{d()}},[e.url]);const c=t=>{e.update("ended",{index:e.index,src:e.url,event:t})},d=()=>{if(document.querySelector(".video_wrapper > div").remove(),"youtube"==e.provider)(t=document.createElement("div")).setAttribute("id","item_"+e.index),t.setAttribute("data-plyr-provider","youtube"),t.setAttribute("data-plyr-embed-id",e.embed_id);else if("vimeo"==e.provider){(t=document.createElement("div")).setAttribute("id","item_"+e.index),t.setAttribute("data-plyr-provider","vimeo"),t.setAttribute("data-plyr-embed-id",e.embed_id)}else{var t=document.createElement("div"),a=document.createElement("video");a.setAttribute("id","item_"+e.index);var s=document.createElement("source");s.setAttribute("src",e.src),s.setAttribute("type",e.mime_type),a.appendChild(s),t.appendChild(a)}document.querySelector(".video_wrapper").appendChild(t)};return Gl("div",{className:"video_wrapper item_player_"+a},"youtube"==e.provider?Gl("div",{ref:t,id:"item_"+e.index,"data-plyr-provider":"youtube","data-plyr-embed-id":e.embed_id}):"vimeo"==e.provider?Gl("div",{ref:t,id:"item_"+e.index,"data-plyr-provider":"vimeo","data-plyr-embed-id":e.embed_id}):"local"==e.provider?Gl("div",null,Gl("video",{className:"activity_meta video",ref:t,id:"item_"+e.index},Gl("source",{src:e.src,type:e.mime_type}))):"")};const{createElement:lc,render:cc,useState:dc,useEffect:uc,Fragment:mc}=wp.element,{dispatch:pc,select:_c}=wp.data;var vc=e=>{const[t,a]=dc({}),[s,n]=dc(!1),[i,o]=dc(null);uc(()=>{a(e.question),n(!0)},[e.question]);const r=(e,s=0,n)=>{let i={...t};"changed"==n&&(i=e,a(i),!function(e){if(null==e)return!0;if("number"==typeof e)return!0;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(e.marked_answer)?"object"==typeof e.marked_answer||Array.isArray(e.marked_answer)?localStorage.setItem(e.id,JSON.stringify(e.marked_answer)):localStorage.setItem(e.id,e.marked_answer):null==e.marked_answer&&localStorage.removeItem(e.id))};return s?t?lc(mc,null,lc("div",{className:"incourse"},lc("div",{className:"quiz_questions_content"},lc("div",{className:"question_cwrapper"},lc("div",{className:"question","data-i":e.i},lc(pr,{question:t,update:r}),(e=>{switch(e.type){case"smalltext":return lc(Ei,{question:e,update:r});case"single":return lc(Hi,{question:e,update:r,quiz_id:e.id});case"select":return lc(Bi,{question:e,update:r,quiz_id:e.id});case"multiple":return lc(Xi,{question:e,update:r,quiz_id:e.id});case"fillblank":return lc(ro,{question:e,update:r,quiz_id:e.id});case"sort":return lc(yo,{question:e,update:r,quiz_id:e.id});case"match":return lc(To,{question:e,update:r,quiz_id:e.id});case"truefalse":return lc(Fo,{question:e,update:r,quiz_id:e.id});case"largetext":return lc(Wo,{question:e,update:r,quiz_id:e.id})}})({...t}),t.attempted?"":lc("div",{className:"quiz_check_answer button",onClick:e=>{(e=>{let t={...e};n(!1),t=er(t,null,null,null,!0),t.attempted=!0,n(!0),a(t)})(t)}},window.wplms_course_data.translations.check_answer),t.attempted?lc(rr,{question:t}):"",t.attempted&&t.explanation.length?lc("div",{className:"explanation"},lc("strong",null,window.wplms_course_data.translations.question_explanation),lc("div",{dangerouslySetInnerHTML:{__html:t.explanation}})):"")),t.attempted&&window.wplms_course_data.question_retries?lc("div",{className:"quiz_check_answer button",onClick:e=>{(()=>{let e={...t};if(e.hasOwnProperty("original")){let t=e;e=t.original,e.original=t.original,a(e)}})()}},lc("span",{className:"vicon vicon-reload"}),window.wplms_course_data.translations.retry):""))):"":lc(tl,null)};const{createElement:hc,render:wc,useState:fc,useEffect:gc,Fragment:yc}=wp.element,{dispatch:bc,select:kc}=wp.data;function xc(e){if(null==e)return!0;if("number"==typeof e)return!0;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var Nc=e=>{const[t,a]=fc([]),[s,n]=fc(!1),[i,o]=fc(0);gc(()=>{r()},[e.questions,i]);const r=()=>{n(!1),fetch(`${window.wplms_course_data.api_url}/course/questions/?client_id=${window.wplms_course_data.client_id}`,{method:"post",body:JSON.stringify({questions:e.questions,page:i+1,per_page:window.wplms_course_data.practice_questions})}).then(e=>e.json()).then(e=>{if(e.status){if(e.questions){let t=[];e.questions.map(e=>{let a=localStorage.getItem(e.id);!xc(a)&&xc(e.marked_answer)&&(!function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(a)?e.marked_answer=a:e.marked_answer=JSON.parse(a)),t.push(e)}),a(t)}n(!0)}else console.log(e)})};return hc("div",{className:"practice_questions"},s?t.filter((e,t)=>t<(i+1)*window.wplms_course_data.practice_questions).map(e=>hc(vc,{question:e,i:i*window.wplms_course_data.practice_questions+t.indexOf(e)+1})):hc(tl,null),e.questions.length>window.wplms_course_data.practice_questions?hc("div",{className:"buttons has-addons"},i>0?hc("span",{className:"button vicon vicon-angle-left",onClick:()=>{s&&o(i-1)}}):"",i<Math.floor(e.questions.length/window.wplms_course_data.practice_questions)?hc("span",{className:"button vicon vicon-angle-right",onClick:()=>{s&&o(i+1)}}):""):"")};const{createElement:Ic,render:Cc,useState:Oc,useEffect:Sc,Fragment:qc,useContext:Pc}=wp.element,{dispatch:Ec,select:zc}=wp.data;var Tc=e=>{const[t,a]=Oc(null),[s,n]=Oc(e.curriculumItem),[i,o]=Oc(!1),[r,l]=Oc(!1),[c,d]=Oc(!1),[u,m]=Oc(!1);Pc(Ml);Sc(()=>{n(e.curriculumItem)},[e.curriculumItem]),Sc(()=>{var e;if(document.querySelector(".wp-playlist.wp-video-playlist")&&(void 0!==(e=JSON.parse(document.querySelector(".wp-playlist-script").innerHTML))&&e&&e.hasOwnProperty("tracks")&&e.tracks.length)){document.querySelector(".wp-playlist video")&&document.querySelector(".wp-playlist video").remove(),(a=document.createElement("div")).classList.add("wplms-playlist");var t=document.createElement("video");a.appendChild(t),document.querySelector(".wp-playlist.wp-video-playlist").parentNode.appendChild(a),setTimeout(()=>{new Plyr(".wplms-playlist video").source={type:"video",sources:e.tracks};var t=document.createElement("div");t.classList.add("wplms_playlist"),e.tracks.map((e,a)=>{var s=document.createElement("span");s.classList.add("track"),s.setAttribute("data-url",e.src),s.innerHTML=e.title,a<1&&s.classList.add("active"),s.onclick=t=>{t.preventDefault(),document.querySelector(".wplms_playlist .track")&&document.querySelectorAll(".wplms_playlist .track").forEach((e,t)=>{e.classList.remove("active")}),t.target.classList.add("active"),document.querySelector(".wplms-playlist video")&&document.querySelector(".wplms-playlist video").remove();var a=document.createElement("div");a.classList.add("wplms-playlist");var s=document.createElement("video");a.appendChild(s),document.querySelector(".wp-playlist.wp-video-playlist").parentNode.appendChild(a),setTimeout(()=>{new Plyr(".wplms-playlist video").source={type:"video",sources:[e]}},200)},t.appendChild(s)}),document.querySelector(".wp-playlist.wp-video-playlist").appendChild(t)},200)}if(document.querySelector(".wp-playlist.wp-audio-playlist")&&(void 0!==(e=JSON.parse(document.querySelector(".wp-playlist-script").innerHTML))&&e&&e.hasOwnProperty("tracks")&&e.tracks.length)){var a;document.querySelector(".wp-playlist audio")&&document.querySelector(".wp-playlist audio").remove(),document.querySelector(".wp-playlist-current-item")&&document.querySelector(".wp-playlist-current-item").remove(),(a=document.createElement("div")).classList.add("wplms-playlist");t=document.createElement("audio");a.appendChild(t),document.querySelector(".wp-playlist.wp-audio-playlist").parentNode.appendChild(a),setTimeout(()=>{new Plyr(".wplms-playlist audio").source={type:"audio",sources:e.tracks};var t=document.createElement("div");t.classList.add("wplms_playlist"),e.tracks.map((e,a)=>{var s=document.createElement("span");s.classList.add("track"),s.setAttribute("data-url",e.src),s.innerHTML=e.title,a<1&&s.classList.add("active"),s.onclick=t=>{t.preventDefault(),document.querySelector(".wplms_playlist .track")&&document.querySelectorAll(".wplms_playlist .track").forEach((e,t)=>{e.classList.remove("active")}),t.target.classList.add("active"),document.querySelector(".wplms-playlist")&&document.querySelector(".wplms-playlist").remove();var a=document.createElement("div");a.classList.add("wplms-playlist");var s=document.createElement("audio");a.appendChild(s),document.querySelector(".wp-playlist.wp-audio-playlist").parentNode.appendChild(a),setTimeout(()=>{new Plyr(".wplms-playlist audio").source={type:"audio",sources:[e]}},200)},t.appendChild(s)}),document.querySelector(".wp-playlist.wp-audio-playlist").appendChild(t)},200)}},[s]);let p="";if(s.meta.hasOwnProperty("video")&&"object"==typeof s.meta.video&&"video"==s.meta.video.type){let e=s.meta.video.url.split(".");switch(e[e.length-1]){case"mov":p="video/mp4";break;default:p="video/"+e[e.length-1]}}if(s.meta.hasOwnProperty("audio")&&"object"==typeof s.meta.audio&&"audio"==s.meta.audio.type){let e=s.meta.audio.url.split(".");switch(e[e.length-1]){case"m4a":p="audio/mp4";break;case"oga":p="audio/ogg";break;default:p="audio/"+e[e.length-1]}}const v=(t,a,n=null)=>{let r={};window.wplms_course_data.course.status.seek_lock&&(r.listeners={seek:e=>{var t=i.currentTime;if(((e,t)=>"object"!=typeof t||"input"!==t.type&&"change"!==t.type?Number(t):t.target.value/t.target.max*e.media.duration)(i,e)>t)return e.preventDefault(),!1}});let l=new Plyr(t,r);l.once("loadeddata",()=>{let e=localStorage.getItem(a);e&&e<=l.duration&&(l.currentTime=e),o({plyr:l,url:a})}),null===n||s.status||l.once("ended",t=>{e.update({index:n,src:a,event:t},"videosended")})};_(()=>{void 0!==i.player&&i.player.on("playing",()=>{localStorage.setItem(i.url,i.player.currentTime)})},500,[i,r]);const h=(e,t)=>{let a={...s};a.meta.hasOwnProperty("assignments")&&a.meta.assignments.length&&a.meta.assignments[t]&&(a.meta.assignments[t].show=e),n(a)},w=(t,a)=>{"complete"==a&&e.update({assignmentIndex:t.assignmentIndex},"completeUnitAssigmnent"),"retake"==a&&e.update({assignmentIndex:t.assignmentIndex},"retakeUnitAssigmnent")};window.scorm_page_type="unit",window.hasOwnProperty("scorm_wplms_data")||(window.scorm_wplms_data={}),window.scorm_wplms_data.module_id=s.id,window.scorm_wplms_data.type="unit";const f=(t,a)=>{e.update(a,"mediaended")};let g=[],y=[];if(s.meta.hasOwnProperty("video")&&"object"==typeof s.meta.video){if("youtube"==s.meta.video.type){let e=s.meta.video.url.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&|?]+)/);e&&e.length&&(g=e[1])}"vimeo"==s.meta.video.type&&(y=s.meta.video.url.match(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/))}return Ic("div",{className:"course_content_content"},e.hasOwnProperty("noLabels")&&e.noLabels?"":Ic(qc,null,Ic("span",{className:"lesson_info"},Ic("span",null,window.wplms_course_data.reports.module.unit+" ",e.item_number+"/"+e.total_item_count),Ic("span",null," "),Ic(Ct,{timestamp:s.duration,notimediff:1})),Ic("h2",{dangerouslySetInnerHTML:{__html:s.title}})),Ic("div",null,s.meta.hasOwnProperty("access")&&s.meta.access||!s.meta.hasOwnProperty("drip_time")?s.meta.hasOwnProperty("video")&&"object"==typeof s.meta.video&&!Array.isArray(s.meta.video)?"youtube"==s.meta.video.type?Ic("div",null,g&&g.length?Ic(rc,{provider:"youtube",index:e.index,embed_id:g,url:s.meta.video.url,update:f}):""):"vimeo"==s.meta.video.type?Ic("div",null,Ic(rc,{provider:"vimeo",index:e.index,embed_id:y[4],url:s.meta.video.url,update:f})):Ic("div",null,Ic(rc,{provider:"local",index:e.index,src:s.meta.video.url,mime_type:p,url:s.meta.video.url,update:f})):s.meta.hasOwnProperty("audio")&&"object"==typeof s.meta.audio&&!Array.isArray(s.meta.audio)&&s.meta.audio.url.length?Ic("audio",{className:"activity_meta video",ref:e=>{v(e,s.meta.audio.url)}},Ic("source",{src:s.meta.audio.url,type:p})):s.meta.hasOwnProperty("package")?Ic("div",{className:"unit_iframe_wrapper"},Ic("iframe",{src:s.meta.package.src,width:"100%",height:"100%",frameborder:"0",allowfullscreen:"allowfullscreen"})):Ic("div",{className:s.type+""+s.id}):Ic(Kl,{start:!0,duration:s.meta.drip_time,update:(t,a)=>{"expired"==a&&e.update({index:e.index},"loadunit")},quiz_id:e.index})),s.meta&&s.meta.hasOwnProperty("access")&&s.meta.access&&s.meta.hasOwnProperty("video")&&s.meta.video.length?Ic("div",{className:"unit_videos"},s.meta.video.map((e,t)=>Ic("div",{className:"video_wrapper"},Ic("video",{className:"activity_meta video",ref:a=>v(a,e,t)},Ic("source",{src:e,type:"video/mp4"}))))):"",s.meta&&s.meta.hasOwnProperty("access")&&s.meta.access&&s.meta.hasOwnProperty("audio")&&s.meta.audio.length?Ic("div",{className:"unit_videos"},s.meta.audio.map((e,t)=>Ic("div",{className:"video_wrapper"},Ic("audio",{className:"activity_meta video",ref:t=>v(t,e)},Ic("source",{src:e,type:"audio/mpeg"}))))):"",s.meta&&s.meta.hasOwnProperty("access")&&s.meta.access&&s.meta.hasOwnProperty("iframes")&&s.meta.iframes.length?Ic("div",{className:"unit_iframes"},s.meta.iframes.map((e,t)=>"object"==typeof e&&e.hasOwnProperty("value")?Ic("div",{className:"unit_iframe_wrapper "+e.shortcode},Ic("iframe",{src:e.value,width:"560",height:"315",frameborder:"0",allowfullscreen:"allowfullscreen"})):Ic("div",{className:"unit_iframe_wrapper"},Ic("iframe",{src:e,width:"560",height:"315",frameborder:"0",allowfullscreen:"allowfullscreen"})))):"",Ic("div",{dangerouslySetInnerHTML:{__html:s.content},ref:e=>{e&&!t&&a(e)}}),s.meta&&s.meta.hasOwnProperty("access")&&s.meta.access&&s.meta.attachments&&s.meta.attachments.length?Ic("div",{className:"unit_attachments"},Ic("h3",null,window.wplms_course_data.translations.attachments),s.meta.attachments.map((e,t)=>Ic("div",{className:"attachment"},Ic("span",null,e.name),Ic("a",{href:e.link,download:e.link.substring(e.link.lastIndexOf("/")+1),target:"_blank",className:"vicon vicon-download"})))):"",s.meta&&s.meta.hasOwnProperty("access")&&s.meta.access&&s.meta.attachments&&s.meta.assignments.length?Ic("div",{className:"unit_assignments"},Ic("h3",null,window.wplms_course_data.translations.assignments),s.meta.assignments.map((t,a)=>Ic("div",{className:"assignment"},Ic("div",{className:"assignment_heading"},Ic("span",null,t.title),Ic("div",{className:"assignment_meta"},t&&t.hasOwnProperty("show")&&t.show?Ic("a",{className:"vicon vicon-minus",onClick:()=>{h(!1,a)}}):Ic("a",{className:"vicon vicon-plus",onClick:()=>{h(!0,a)}}))),t.show?Ic("div",{className:"assignment_content_wrapper"},Ic($l,{assignment:t,assignmentIndex:a,index:a,unitIndex:e.index,update:w})):""))):"",s.meta.hasOwnProperty("pratice_questions")&&s.meta.pratice_questions.length?Ic("div",{className:"pratice_questions"},Ic(Nc,{questions:s.meta.pratice_questions})):"")};const{createElement:Mc,render:jc,useState:Lc,useEffect:Hc,useContext:Ac,Fragment:Fc,RawHTML:Dc}=wp.element,{select:Rc,dispatch:Jc}=wp.data;var Bc=e=>{const t=Ac(y),[a,s]=Lc(!1),[n,i]=Lc("view"),[o,r]=Lc(e.field),[l,c]=Lc(!1),[d,u]=Lc(0),[m,p]=Lc(!1),[_,v]=Lc(!1),[h,w]=Lc(!1),[g,b]=Lc({}),[k,x]=Lc({}),[N,I]=Lc(""),[C,O]=Lc(e.curriculum);Hc(()=>{O(C)},[e.curriculum]),Hc(()=>{let a={...e.field};if(i("view"),!e.hasOwnProperty("editFields")){let s=t.course[e.tabIndex].fields[e.fieldIndex].curriculum_elements,n=s[s.findIndex(t=>t.type==e.field.type)].types;s.findIndex(t=>t.type==e.field.type)>-1&&n.findIndex(t=>t.id==e.field.data.type)>-1&&e.field.data.hasOwnProperty("type")?x(n[n.findIndex(t=>t.id==e.field.data.type)].fields):(x(n[0].fields),a.data.type=n[0].id)}r(a)},[e.field]),Hc(()=>{"view"==n&&"unit"==o.type&&(u(0),s(!0),fetch(window.wplms_create_course_data.api_url+"/curriculum/getElement",{method:"post",body:JSON.stringify({type:o.type,id:o.data.id,token:Rc("vibebp").getToken()})}).then(e=>e.json()).then(e=>{s(!1),u(e),document.dispatchEvent(new Event("VibeBP_Editor_Content"))})),"edit"==n&&(s(!0),fetch(window.wplms_create_course_data.api_url+"/curriculum/getElementFields",{method:"post",body:JSON.stringify({type:o.type,id:o.data.id,fields:k,token:Rc("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.status&&(x(e.fields),Array.isArray(e.fields)&&e.fields.map(e=>{"post_content"==e.id&&I({post_content:e.value,raw:e.raw})})),s(!1)}),window.wplms_course_data.course.hasOwnProperty("admin_approval")&&window.wplms_course_data.course.admin_approval&&fetch(window.wplms_course_data.api_url+"/getapproval/",{method:"post",body:JSON.stringify({token:Rc("vibebp").getToken(),courseid:o.data.id})}).then(e=>e.json()).then(e=>{e.status&&(Jc("vibebp").addNotification({text:window.wplms_course_data.translations.draft_found}),b(e.approval))}))},[n,o]);const S=e=>{let t={};t=e.detail.field,t.hasOwnProperty("value")&&void 0!==e.detail.editFields[e.detail.editFields.findIndex(e=>e.id==t.id)]&&JSON.stringify(t.value)!=JSON.stringify(e.detail.editFields[e.detail.editFields.findIndex(e=>e.id==t.id)].value)&&(e.detail.editFields[e.detail.editFields.findIndex(e=>e.id==t.id)]=t,x(e.detail.editFields))};Hc(()=>{document.removeEventListener("wplms_custom_unit_field_value_changed",S),document.addEventListener("wplms_custom_unit_field_value_changed",S,!1)},[]);const q=(e,t)=>{let a={};if(a=e.hasOwnProperty("field")?e.field:e,a.hasOwnProperty("value")&&void 0!==k[k.findIndex(e=>e.id==a.id)]&&JSON.stringify(a.value)!=JSON.stringify(k[k.findIndex(e=>e.id==a.id)].value)){let e=[...k];"post_content"==a.id?I({post_content:a.value,raw:a.raw}):(e[e.findIndex(e=>e.id==a.id)]=a,x(e))}};let P=0;if("section"!==o.type&&o.data.hasOwnProperty("type")){let e=t.course[t.course.findIndex(e=>"course_curriculum"==e.id)].fields[0].curriculum_elements;if(e[e.findIndex(e=>e.type==o.type)].hasOwnProperty("types")){let t=e[e.findIndex(e=>e.type==o.type)].types;t.findIndex(e=>e.id==o.data.type)>-1&&(P=t[t.findIndex(e=>e.id==o.data.type)].icon)}}let E=1,z=1;if(Array.isArray(C)){let e=C.filter(e=>"section"!=e.type);E=e.length,z=e.findIndex(e=>e.data.id==o.data.id)+1}let T=t.course[e.tabIndex].fields[e.fieldIndex].curriculum_elements;return Mc("div",{className:"element_overlay"},a?Mc(Ze,null):"view"==n?Mc(Fc,null,Mc("div",{className:"element_actions"},Mc("span",{className:"vicon vicon-arrow-left",onClick:e.close}),Mc("span",null,Mc("span",{className:"vicon vicon-control-shuffle tip",title:window.wplms_course_data.translations.switch_type,onClick:()=>i("changeType")}),Mc("span",{className:"vicon vicon-pencil",title:window.wplms_course_data.translations.edit,onClick:()=>i("edit")}),Mc("span",{className:"vicon vicon-trash",title:window.wplms_course_data.translations.delete,onClick:()=>p(!0)}))),Mc("div",{className:"element_content"},"quiz"==o.type?Mc(Fc,null,Mc("h2",null,P?Mc("span",{className:P}):"",o.data.text),Mc(pl,{quizid:o.data.id})):"unit"==o.type&&d?Mc(Tc,{curriculumItem:d,curriculum:C,id:o.data.id,item_number:z,total_item_count:E}):"assignment"==o.type?Mc($l,{assignment:o.data}):""),m?Mc("div",{className:"change_data_wrapper"},Mc("div",{className:"change_data_content"},Mc("span",{className:"vicon vicon-close close",onClick:()=>p(!1)}),Mc("h3",null,window.wplms_course_data.translations.sure_delete),Mc("div",{className:"popup-footer"},Mc("a",{className:l?"button is-primary is-loading":"button is-primary",onClick:()=>{(a=>{!a.hasOwnProperty("data")||a.hasOwnProperty("data")&&!a.data.hasOwnProperty("id")?Jc("vibebp").addNotification({text:window.wplms_course_data.translations.error}):(c(!0),fetch(`${window.wplms_create_course_data.api_url}/deleteElement/${a.data.id}`,{method:"post",body:JSON.stringify({token:Rc("vibebp").getToken(),course_id:t.courseID})}).then(e=>e.json()).then(t=>{p(!1),c(!1),t.status&&(e.close(),e.update(e.cindex,"deleted")),t.hasOwnProperty("message")&&Jc("vibebp").addNotification({text:t.message})}))})(o)}},window.wplms_course_data.translations.ok),Mc("a",{className:"button is-primary",onClick:()=>p(!1)},window.wplms_course_data.translations.cancel)))):""):"edit"==n?Mc(Fc,null,Mc("div",{className:"element_actions"},Mc("span",{className:"vicon vicon-arrow-left",onClick:e.close}),Mc("span",null,Mc("span",{className:"vicon vicon-eye",onClick:()=>i("view")}),Mc("span",{className:"vicon vicon-trash",onClick:()=>p(!0)}))),Mc("div",{className:"element_content"},!a&&k.length?Mc(Fc,null,f(g)?"":Mc("span",{onClick:()=>{s(!0),x(g),g&&g.length&&g.map(e=>{"post_content"==e.id&&I({post_content:e.value,raw:e.raw})}),setTimeout(()=>{s(!1),b(!1)},500)}},Mc("span",{className:"vicon vicon-user"}),window.wplms_create_course_data.translations.load_instrcutor_edit),k.map((t,a)=>"elementor"==t.type?o.data.hasOwnProperty("id")?Mc(mi,{id:o.data.id}):Mc("a",{href:"# ",className:"edit_with_elementor_wrapper"},window.wplms_create_course_data.translations.save_post_to_edit_with_elementor):Mc(Zd,{field:t,fieldIndex:e.fieldIndex,ufieldIndex:a,editFields:k,tabIndex:e.tabIndex,cindex:e.cindex,update:q}))):""),Mc("div",{className:"element_buttons"},Mc("a",{className:_?"button is-primary is-loading":"button is-primary",onClick:()=>{v(!0);let t={post_title:"",post_content:"",meta:[],taxonomy:[]};k.map(e=>{if("post"==e.from&&"post_content"!=e.id&&(t[e.id]=e.value),"meta"==e.from){let a=t.meta.findIndex(t=>t.meta_key==e.id),s=e.value;if("duration"==e.type&&"object"==typeof e.value){let a=t.meta.findIndex(t=>t.meta_key==e.id+"_parameter");a>-1?e.value.hasOwnProperty("parameter")&&(t.meta[a].meta_value=e.value.parameter):e.value.hasOwnProperty("parameter")&&t.meta.push({meta_key:e.id+"_parameter",meta_value:e.value.parameter}),e.value=e.value.value}if("editor"==e.type&&e.hasOwnProperty("raw")){let a=t.meta.findIndex(t=>t.meta_key==e.id+"_raw");a>-1?t.meta[a].meta_value=e.raw:t.meta.push({meta_key:e.id+"_raw",meta_value:e.raw})}if("quiz_questions"==e.type){let t={ques:[],marks:[]};Array.isArray(e.value)&&!e.value.hasOwnProperty("marks")&&e.value.map(e=>{t.ques.push(e.data.id),t.marks.push(e.marks)}),e.value=t}if("multiattachments"==e.type){let t=[];Array.isArray(e.value)&&e.value.map(e=>{e&&e.hasOwnProperty("id")&&t.push(e.id)}),e.value=t}a>-1?t.meta[a].meta_value=e.value:t.meta.push({meta_key:e.id,meta_value:e.value}),e.value=s}if("taxonomy"==e.from){let a=t.taxonomy.findIndex(t=>t.taxonomy==e.id);a>-1?t.taxonomy[a].value=e.value:t.taxonomy.push({taxonomy:e.id,value:e.value})}});let a=t.meta.findIndex(e=>"vibe_type"==e.id);-1==a?t.meta.push({meta_key:"vibe_type",meta_value:o.data.type}):t.meta[a]={meta_key:"vibe_type",meta_value:o.data.type},fetch(`${window.wplms_create_course_data.api_url}/createElement/${o.type}`,{method:"post",body:JSON.stringify({type:o.type,id:o.data.id,...t,...N,token:Rc("vibebp").getToken(),editfields:k})}).then(e=>e.json()).then(a=>{v(!1),a.status&&(Jc("vibebp").addNotification({text:a.message}),e.update(t.post_title,"text"))})}},window.wplms_create_course_data.translations.save),Mc("a",{className:"link",onClick:e.close},window.wplms_create_course_data.translations.cancel)),_?Mc("div",{className:"small_message"},Mc("span",{className:"vicon vicon-alert"}),window.wplms_create_course_data.translations.saving_content_message):""):"changeType"==n?Mc("div",{className:"curriculum_elements_wrapper"},Mc("span",{className:"vicon vicon-arrow-left",onClick:()=>{i("view")}}),Mc("div",{className:"add_cpt_wrapper vibebp_form"},T[T.findIndex(e=>e.type==o.type)].hasOwnProperty("types")?T[T.findIndex(e=>e.type==o.type)].types.map(a=>Mc("div",{className:o.data.hasOwnProperty("type")&&o.data.type==a.id?"add_cpt_type active":"add_cpt_type",onClick:()=>{h||(a=>{let s={...o};w(a.id),fetch(`${window.wplms_create_course_data.api_url}/createElement/${s.type}`,{method:"post",body:JSON.stringify({type:s.type,id:s.data.id,meta:[{meta_key:"vibe_type",meta_value:a.id}],token:Rc("vibebp").getToken()})}).then(e=>e.json()).then(n=>{if(w(!1),n.status){s.data.type=a.id,r(s),e.update({cindex:e.cindex,type:a.id},"changetype");let o=t.course[e.tabIndex].fields[e.fieldIndex].curriculum_elements,l=o[o.findIndex(e=>e.type==s.type)].types;o.findIndex(e=>e.type==s.type)>-1&&l.findIndex(e=>e.id==s.data.type)>-1&&s.data.hasOwnProperty("type")&&x(l[l.findIndex(e=>e.id==s.data.type)].fields),i("edit"),Jc("vibebp").addNotification({text:n.message})}})})(a)}},h==a.id?Mc(Ze,null):Mc(Fc,null,-1==a.icon.indexOf("<svg")?Mc("span",{className:a.icon}):Mc("span",{dangerouslySetInnerHTML:{__html:a.icon}}),a.label))):"")):Mc(Ze,null))};const{createElement:$c,render:Uc,useState:Vc,useEffect:Wc,useContext:Yc,Fragment:Xc,useCallback:Qc}=wp.element,{dispatch:Kc,select:Gc}=wp.data;var Zc=e=>{const t=Yc(y),[a,s]=Vc(e.field),[n,i]=Vc(!1),[o,r]=Vc(0),[l,c]=Vc([]),[d,u]=Vc([]),[v,h]=Vc(!1),[w,f]=Vc(""),[g,b]=Vc({}),[k,x]=Vc({value:"",raw:[]}),[N,I]=Vc({post_title:"",post_content:"",type:"",taxonomy:[],meta:[]}),[C,O]=Vc(!1),[S,q]=Vc(!1),[P,E]=Vc(!1),[z,T]=Vc(""),[M,j]=Vc(!1),[L,H]=Vc([]),[A,F]=Vc(!1),[D,R]=Vc([]),[J,B]=Vc([]),[$,U]=Vc([]),[V,W]=Vc([]),[Y,X]=Vc({meta_value:"",raw:[]});let Q=Gc("vibebp").getUser();Q.token=Gc("vibebp").getToken(),Wc(()=>{let a={...e.field};e.field.hasOwnProperty("curriculum")&&e.field.curriculum.length?e.field.hasOwnProperty("currentEditingunitIndex")||t.update({field:e.field.curriculum.length-1,fieldIndex:e.fieldIndex},"currentEditingunitIndex"):a.curriculum=[],s(a),i(!0),I({post_title:"",post_content:"",type:"",taxonomy:[],meta:[]}),c([]),h(!1)},[e.field]),Wc(()=>{},[t.field]),_(()=>{"string"==typeof w&&w.length&&z.length>3&&(j(!0),fetch(`${window.wplms_create_course_data.api_url}/selectcpt/${w}`,{method:"post",body:JSON.stringify({search:z,token:Q.token})}).then(e=>e.json()).then(e=>{j(!1),e.status&&H(e.posts)}))},500,[z]);const K=(e,a)=>{if("curriculumchanged"==a){let a={field:e.field,cindex:e.cindex,fieldIndex:e.fieldIndex};e.hasOwnProperty("ufieldIndex")&&(a.setting_index=e.ufieldIndex),t.update(a,"curriculumchanged")}},G=e=>{if(!m(N)){E(!0);let t={...N};if(Y.meta_value.length){let e=t.meta.findIndex(e=>e.meta_key==Y.meta_key);if(e<0)t.meta.push({meta_key:Y.meta_key,meta_value:Y.meta_value}),t.meta.push({meta_key:Y.meta_key+"_raw",meta_value:Y.raw});else{t.meta[e]={meta_key:Y.meta_key,meta_value:Y.meta_value};let a=t.meta.findIndex(e=>e.meta_key==Y.meta_key+"_raw");a<0?t.meta.push({meta_key:Y.meta_key+"_raw",meta_value:Y.raw}):t.meta[a]={meta_key:Y.meta_key+"_raw",meta_value:Y.raw}}}if(t.hasOwnProperty("meta")&&t.meta.length){let e=t.meta.findIndex(e=>"vibe_quiz_questions"==e.meta_key);if(e>-1&&Array.isArray(t.meta[e].meta_value)){let a={ques:[],marks:[]};t.meta[e].meta_value.map(e=>{a.ques.push(e.data.id),a.marks.push(e.marks)}),t.meta[e].meta_value=a}let a=t.meta.findIndex(e=>"vibe_unit_attachments"==e.meta_key);if(a>-1&&Array.isArray(t.meta[a].meta_value)){let e=[];t.meta[a].meta_value.map(t=>{t&&t.hasOwnProperty("id")&&e.push(t.id)}),t.meta[a].meta_value=e}let s=t.meta.findIndex(e=>"vibe_practice_questions"==e.meta_key);if(s>-1&&Array.isArray(t.meta[s].meta_value)){let e=[];t.meta[s].meta_value.map(t=>{e.push(t.data.id)}),t.meta[s].meta_value=e}}if("quiz"==e){let e=t.meta.findIndex(e=>"vibe_duration"==e.meta_key);-1==e&&t.meta.push({meta_key:"vibe_duration",meta_value:"6"}),e=t.meta.findIndex(e=>"vibe_duration_parameter"==e.meta_key),-1==e&&t.meta.push({meta_key:"vibe_duration_parameter",meta_value:"60"})}fetch(`${window.wplms_create_course_data.api_url}/createElement/${e}`,{method:"post",body:JSON.stringify({...t,post_content:k.value,raw:k.raw,token:Q.token,editfields:l,type:v})}).then(e=>e.json()).then(t=>{E(!1),t.status?(b(t.data),Z(e,t.data)):t.hasOwnProperty("message")&&Kc("vibebp").addNotification({text:t.message})})}},Z=(s,n=null)=>{m(n)&&g&&g.id&&(n=g);let i={...a};i.curriculum||(i.curriculum=[]),"section"==s?i.curriculum.push({type:s,data:""}):m(n)?i.curriculum.push({data:N,type:s}):i.curriculum.push({data:n,type:s}),I({post_title:"",post_content:"",type:"",taxonomy:[],meta:[]}),c([]),f(!1),h(!1),t.update({field:i,index:e.fieldIndex},"fieldvaluechanged")},ee=e=>{if(e.detail.editFields.hasOwnProperty("meta")){let t=e.detail.editFields.meta.findIndex(t=>t.meta_key==e.detail.field.id);t>-1?e.detail.editFields.meta[t].meta_value=e.detail.field.value:e.detail.editFields.meta.push({meta_key:e.detail.field.id,meta_value:e.detail.field.value})}I(e.detail.editFields);let t=[...l],a=t.findIndex(t=>t.id==e.detail.field.id);a>-1&&(t[a]=e.detail.field,c(t))};Wc(()=>(document.removeEventListener("wplms_custom_unit_field_value_changed",ee),document.addEventListener("wplms_custom_unit_field_value_changed",ee,!1),()=>{document.removeEventListener("wplms_custom_unit_field_value_changed",ee)}),[]);Wc(()=>{t.adHocSettings&&t.adHocSettings.collapse_into_sections&&r(o+1)},[t.adHocSettings]);let te=0;return $c(Xc,null,$c("div",{className:"course_curriculum_wrapper"},$c("div",{className:w||C?"sidecurriculum":""},$c("div",{className:"course_curriculum"},a&&a.curriculum&&a.curriculum.length?a.curriculum.map((n,i)=>{if(t.adHocSettings&&t.adHocSettings.collapse_into_sections)if(a.curriculum[i].type&&"section"!=a.curriculum[i].type){if(void 0===t.adHocSettings.uncollapsed_section)return;if(t.adHocSettings.uncollapsed_section!=te)return}else te=i;return $c("div",{class:"curriculum_field_wrapper"},$c("div",{className:C&&C.data.id==n.id?"curriculum_field is_active":"curriculum_field",draggable:!0,style:V[i],ref:e=>{((e,t)=>{if(e){let a=D;a[t]||(a[t]=e),R(a)}})(e,i)},onTouchStart:e=>{let t=[...$];D.map((e,a)=>{let s=e.getBoundingClientRect();t[a]=s}),U(t),a.curriculum[i]&&F(a.curriculum[i])},onTouchMove:e=>{e.preventDefault();let t=[...V];if(t[i]={transform:"translateY("+Math.floor(e.touches[0].clientY-$[i].top)+"px)"},W(t),"touchmove"===e.type){let t=[];t.push(a.curriculum[i]);let s=[];if(e.touches[0].clientY&&$.map((n,o)=>{n.top+n.height/2>e.touches[0].clientY&&a.curriculum[o]!==a.curriculum[i]&&t.push(a.curriculum[o]),n.bottom-n.height/2<e.touches[0].clientY&&a.curriculum[o]!==a.curriculum[i]&&s.push(a.curriculum[o])}),s.length)for(let e=s.length-1;e>=0;e--)t.unshift(s[e]);B(t)}},onTouchEnd:s=>{if(J&&J.length){let s={...a};s.curriculum=J,t.update({field:s,index:e.fieldIndex},"fieldvaluechanged")}W([]),U([]),F(!1),B([])},onDragStart:s=>{a.curriculum[i]&&(F(a.curriculum[i]),t.update({field:-1,fieldIndex:e.fieldIndex},"currentEditingunitIndex"))},onDragOver:s=>{s.preventDefault(),((s,n)=>{if(!A)return;let i=a.curriculum[n];if(A===i)return;let o={...a};o.curriculum=o.curriculum.filter(e=>e!=A),o.curriculum.splice(n,0,A),t.update({field:o,index:e.fieldIndex},"fieldvaluechanged")})(0,i)},onDragEnd:()=>{t.update({field:a.curriculum.indexOf(A),fieldIndex:e.fieldIndex},"currentEditingunitIndex"),F(!1)}},"section"==a.curriculum[i].type?$c(Rn,{field:a.curriculum[i],fieldIndex:e.fieldIndex,cindex:i,update:K,tabIndex:e.tabIndex,currentEditingunitIndex:e.field.currentEditingunitIndex}):"unit"==a.curriculum[i].type||"quiz"==a.curriculum[i].type||"assignment"==a.curriculum[i].type?$c(Xn,{field:a.curriculum[i],show:()=>{O(a.curriculum[i])},remove:()=>{let n={...a};n.curriculum.splice(i,1),s(n),t.update({field:n,index:e.fieldIndex},"fieldvaluechanged")}}):"quiz"==a.curriculum[i].type||"assignment"==a.curriculum[i].type?$c(Xn,{field:a.curriculum[i],fieldIndex:e.fieldIndex,cindex:i,update:K,tabIndex:e.tabIndex,currentEditingunitIndex:e.field.currentEditingunitIndex}):$c("div",{className:"wplms_curriculum_field"},document.dispatchEvent(new CustomEvent("wplms_curriculum_field",{detail:{field:e}})))))}):""),$c("div",{className:"add_curriculum_element"},a.curriculum_elements.map(e=>$c("a",{className:"button is-primary",onClick:()=>{var t;"label"==e.curriculum_type&&Z(e.type),"post_type"==e.curriculum_type&&(t=e.type,f(t))}},$c("span",{className:"vicon vicon-plus"})," ",e.label))))),w?$c("div",{className:"curriculum_elements_wrapper"},$c("div",{className:"add_cpt_wrapper vibebp_form"},!a.curriculum_elements[a.curriculum_elements.findIndex(e=>e.type==w)].hasOwnProperty("types")||N.hasOwnProperty("type")&&N.type.length?"":a.curriculum_elements[a.curriculum_elements.findIndex(e=>e.type==w)].types.map(e=>$c("div",{className:N.hasOwnProperty("type")&&N.type==e.id?"add_cpt_type active":"add_cpt_type",onClick:()=>{let t={...N};t.type=e.id,t.meta.push({meta_key:"vibe_type",meta_value:e.id}),I(t),h(t.type),c(a.curriculum_elements[a.curriculum_elements.findIndex(e=>e.type==w)].types[a.curriculum_elements[a.curriculum_elements.findIndex(e=>e.type==w)].types.findIndex(e=>e.id==t.type)].fields)}},-1==e.icon.indexOf("<svg")?$c("span",{className:e.icon}):$c("span",{dangerouslySetInnerHTML:{__html:e.icon}}),e.label)),a.curriculum_elements[a.curriculum_elements.findIndex(e=>e.type==w)].hasOwnProperty("types")?N.hasOwnProperty("type")&&N.type?$c(Xc,null,$c("div",{className:"curriculum_element_wrapper vibebp_form_field "+w+"_"+N.type},$c("div",{className:M?"control is-loading ":"control"},$c("input",{className:"input",type:"text",value:z,onChange:e=>{T(e.target.value)},placeholder:window.wplms_create_course_data.translations.type_to_search}),$c("span",{className:"vicon vicon-search"})),L.length?$c("div",{className:"cpt_search_results"},L.map(e=>$c("span",{onClick:()=>{Z(w,e)}},e.text))):"",a.curriculum_elements[a.curriculum_elements.findIndex(e=>e.type==w)].types[a.curriculum_elements[a.curriculum_elements.findIndex(e=>e.type==w)].types.findIndex(e=>e.id==N.type)].fields.map((t,a)=>$c(Zd,{field:t,fieldIndex:e.fieldIndex,editFields:N,tabIndex:e.tabIndex,update:(e,t,a)=>{((e,t,a)=>{let s=e.field,n={...N};if("taxonomy"==s.type){let e=n.taxonomy.findIndex(e=>e.taxonomy==s.taxonomy);-1==e?n.taxonomy.push({taxonomy:s.taxonomy,value:s.value}):n.taxonomy[e].value=s.value}if("meta"==s.from)if("duration"==s.type){let e=n.meta.findIndex(e=>e.meta_key==s.id);e>-1?n.meta[e].meta_value=s.value.value:n.meta.push({meta_key:s.id,meta_value:s.value.value});let t=n.meta.findIndex(e=>e.meta_key==s.id+"_parameter");t>-1?n.meta[t].meta_value=s.value.parameter:n.meta.push({meta_key:s.id+"_parameter",meta_value:s.value.parameter})}else if("editor"==s.type&&s.hasOwnProperty("raw")){if("vibe_quiz_message"==s.id)return void X({meta_key:"vibe_quiz_message",meta_value:s.value,raw:s.raw})}else{let e=n.meta.findIndex(e=>e.meta_key==s.id);e>-1?n.meta[e].meta_value=s.value:n.meta.push({meta_key:s.id,meta_value:s.value})}"post"==s.from&&("post_content"==s.id?x({value:s.value,raw:s.raw}):n[s.id]=s.value),"post_content"!=s.id&&I(n);let i=[...l],o=i.findIndex(t=>t.id==e.field.id);o>-1&&(i[o]=e.field,"post"==e.field.from&&"post_content"==e.field.id&&(i[o]={...e.field,value:e.field.value,raw:e.field.raw}),c(i))})(e)}})),$c("span",{className:"curriculum_element_actions"},$c("a",{className:P?"button is-primary is-loading":"button is-primary",onClick:()=>{G(w)}},window.wplms_course_data.course.hasOwnProperty("admin_approval")&&window.wplms_course_data.course.admin_approval&&!p()?window.wplms_create_course_data.translations.send_for_approval:window.wplms_create_course_data.translations.add_cpt[w].add),$c("a",{className:"link",onClick:()=>{f(!1),I({post_title:"",post_content:"",type:"",taxonomy:[],meta:[]})}},window.wplms_create_course_data.translations.cancel)))):"":$c(Xc,null,$c("div",{className:"curriculum_element_wrapper "+N.type},$c("div",{className:M?"control is-loading ":"control"},$c("input",{className:"input",type:"text",value:z,onChange:e=>{T(e.target.value)},placeholder:window.wplms_create_course_data.translations.type_to_search}),$c("span",{className:"vicon vicon-search"})),L.length?$c("div",{className:"cpt_search_results"},L.map(e=>$c("span",{onClick:()=>{Z(w,e),f(!1)}},e.text))):"",$c("a",{className:P?"button is-primary is-loading":"button is-primary",onClick:()=>{G(w)}},window.wplms_create_course_data.translations.add_cpt[w].add),$c("a",{className:"link",onClick:()=>{f(!1),I({...N,type:""})}},window.wplms_create_course_data.translations.cancel))))):C?$c(Bc,{field:C,fieldIndex:e.fieldIndex,tabIndex:e.tabIndex,curriculum:a.curriculum,close:()=>{O(!1)},cindex:a.curriculum.findIndex(e=>e.data.id==C.data.id),update:(n,i)=>{let o={...a};"text"==i&&(o.curriculum[o.curriculum.findIndex(e=>e.data.id==C.data.id)].data.text=n,t.update({field:o,index:e.fieldIndex},"fieldvaluechanged")),"deleted"==i&&(o.curriculum.splice(n,1),s(o),O(!1),t.update({field:o,index:e.fieldIndex},"fieldvaluechanged")),"changetype"==i&&(o.curriculum[n.cindex].data.type=n.type,s(o),t.update({field:o,index:e.fieldIndex},"fieldvaluechanged"))}}):"")};const{createElement:ed,render:td,useState:ad,useEffect:sd,useContext:nd,Fragment:id,useRef:od}=wp.element,{select:rd,dispatch:ld}=wp.data;var cd=e=>{nd(y);const[t,a]=ad(!0),[s,n]=ad(e.field),[i,o]=ad(!1),[r,l]=ad(!1),[c,d]=ad({paged:1,s:""}),[u,m]=ad(""),[p,v]=ad({package_type:"",name:""}),[h,w]=ad([]),[g,b]=ad(!0),[k,x]=ad(!1),[N,I]=ad(!1),[C,O]=ad([]),[S,q]=ad(!0),P=od(null);sd(()=>{q(!0);let t={...e.field};if(f(e.field.value))n(t),q(!1);else{let e={...p};t.hasOwnProperty("value")&&t.value.hasOwnProperty("package_type")&&(e.package_type=t.value.package_type),t.hasOwnProperty("value")&&t.value.hasOwnProperty("name")&&(e.name=t.value.name),n(t),v(e),a(!1),q(!1)}},[e.field]),_(()=>{fetch(window.wplms_create_course_data.api_url+"/getUploadedPackages",{method:"post",body:JSON.stringify({...c,token:rd("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(e.status)if(k){let t=[...h,...e.packages];t.length<parseInt(e.total)?b(!0):b(!1),w(t),x(!1)}else w(e.packages),parseInt(e.total)>e.packages.length?b(!0):b(!1);else m(e.message)})},500,[c]);const E=e=>{let t={...s};e.hasOwnProperty("type")&&(e.package_type=e.type),p.hasOwnProperty("package_type")&&(e.package_type=p.package_type),t.value=e,n(t)};return S?ed(Ze,null):ed("div",{className:"course_upload_wrapper"},t?ed(id,null,ed("div",{className:"curriculum_type_wrapper"},s.upload_elements.length?s.upload_elements.map(e=>ed("div",{className:p.package_type==e.type?"active curriculum_type":"curriculum_type",onClick:()=>{v({...p,package_type:e.type})}},ed("span",{className:e.icon}),ed("span",null,e.label))):""),p.hasOwnProperty("package_type")&&p.package_type.length?ed("div",{className:"course_upload_package_wrapper"},ed("label",{for:"course_upload_package",className:"upload_box"},ed("span",{className:"vicon vicon-upload"}),p.hasOwnProperty("name")&&p.name.length?p.name:window.wplms_create_course_data.translations.upload_package,i?ed("div",{className:"vibebp_progress_wrapper"},ed("span",{className:"progress_wrapper"},ed("span",{className:"progress_bar",style:{width:i+"%"}})),ed("span",null,i,"%")):""),ed("input",{id:"course_upload_package",type:"file",ref:P,accept:".zip,.rar,.7zip",onChange:()=>{v({...p,name:P.current.files[0].name}),P.current.files[0].size<window.vibebp.settings.upload_limit?(I(!1),O(P.current.files)):ld("vibebp").addNotification({text:window.vibebp.translations.image_size_error})}}),ed("div",{className:"upload_package_actions"},r?ed("div",{className:"existing_packages_wrapper"},ed("div",{className:"existing_packages_header"},ed("input",{type:"text",value:c.s,placeholder:window.wplms_create_course_data.translations.search_package,onChange:e=>d({...c,s:e.target.value})}),ed("span",{className:"vicon vicon-close",onClick:()=>l(!1)})),ed("div",{className:"existing_packages"},h.length?ed(id,null,h.map(e=>ed("div",{className:e==s.value?"package active":"package",onClick:()=>{s.value==e?n({...s,value:!1}):E(e)}},ed("span",{className:s.upload_elements[s.upload_elements.findIndex(t=>t.type==e.type)].icon}),ed("span",null,e.name))),g?ed("span",{className:"link",onClick:()=>{x(!0),d({...c,paged:c.paged+1})}},window.wplms_create_course_data.translations.load_more):""):u.length?ed("div",{className:"vbp_message"},u):"")):ed("a",{className:"button is-link",onClick:()=>l(!0)},window.wplms_create_course_data.translations.select_existing_package),s.hasOwnProperty("value")&&s.value.hasOwnProperty("path")?ed("a",{className:"button is-primary",onClick:()=>{e.update(s,e.fieldIndex,"fieldvaluechanged"),a(!1)}},ed("span",{className:"vicon vicon-check-box"})," ",window.wplms_create_course_data.translations.set_package):ed("a",{className:N?"button is-primary is-loader":"button is-primary",onClick:()=>{if(!C.length)return void ld("vibebp").addNotification({text:window.wplms_create_course_data.translations.package_file_missing});I(!0);let e=C[0].size/1024/1024;if(tus.isSupported&&tus.canStoreURLs&&e>1){const e=window.vibebp.api.url+"/user/upload_media_stream";let t=new tus.Upload(C[0],{endpoint:e,chunkSize:2097152,retryDelays:[0,3e3],metadata:{token:rd("vibebp").getToken(),filename:C[0].name,filetype:C[0].type,args:JSON.stringify(p)},onError:function(e){e.hasOwnProperty("message")&&ld("vibebp").addNotification({text:e.message})},onProgress:function(e,t){console.log("@");var a=(e/t*100).toFixed(2);o(a)},onSuccess:function(){console.log("#"),localStorage.removeItem(t._urlStorageKey),fetch(t.url+"/complete_stream",{method:"post",body:JSON.stringify({token:rd("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.status&&E(e.package),e.hasOwnProperty("message")&&ld("vibebp").addNotification({text:e.message})})}});t.findPreviousUploads().then(e=>{e.length>0&&t.resumeFromPreviousUpload(e[0]),t.start()}),tus.Upload.terminate(e).then((function(){})).catch((function(e){console.log(e)}))}else{var t=new FormData;t.append("body",JSON.stringify({args:p,token:rd("vibebp").getToken()})),t.append("file",C[0]),fetch(window.wplms_create_course_data.api_url+"/uploadPackage",{method:"post",body:t}).then(e=>e.json()).then(e=>{if(I(!1),e.status){let t={...s};t.value=e.package;let a=[...h];a.unshift(e.package),w(a),n(t)}else e.hasOwnProperty("message")&&ld("vibebp").addNotification({text:e.message})})}}},window.wplms_create_course_data.translations.upload_package))):""):ed("div",{className:"uploaded_package"},ed("span",{onClick:()=>{v({}),n({...s,value:{}}),a(!0)}},ed("span",{className:"vicon vicon-pencil-alt"})),ed("i",{className:s.upload_elements.findIndex(e=>e.type==s.value.package_type)>-1?s.upload_elements[s.upload_elements.findIndex(e=>e.type==s.value.package_type)].icon:s.upload_elements[0].icon}),ed("strong",null,s.value.name)))};const{createElement:dd,render:ud,useState:md,useEffect:pd,Fragment:_d,useContext:vd}=wp.element,{dispatch:hd,select:wd}=wp.data;var fd=e=>{const[t,a]=md(!1),[s,n]=md([]),[i,o]=md([]),[r,l]=md(!1),[c,d]=md(!1),[u,m]=md(0),[p,v]=md([]),[h,w]=md("media"),[f,g]=md({posts_per_page:20,paged:1,search_terms:"",orderby:""}),[y,b]=md({name:"",url:"",type:"file"});_(()=>{fetch(window.vibebp.api.url+"/user/fetch_media",{method:"post",body:JSON.stringify({...f,token:wd("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(a(!1),e.status)if(c){let t=[...s];e.data.map(e=>{t.push(e)}),n(t),d(!1),t.length<parseInt(data.total)?l(!0):l(!1)}else n(e.data),e.data.length<parseInt(e.total)?l(!0):l(!1)})},500,[f]);const k=t=>{e.share(t)};pd(()=>{hd("vibebp").setData("mediaTab",h),-1==p.indexOf(h)&&(document.dispatchEvent(new CustomEvent("vibebp_media_tab",{detail:{tab:h}})),document.addEventListener("vibebp_media_tab_submit",t=>{e.share(t.detail.media),e.close(!1)},!1),v([...p,h]))},[h]);const x=e=>{switch(e.type){case"image":return dd("img",{src:e.url,className:"content_to_html_image"});case"video":return dd("video",{class:"video_plyr"},dd("source",{src:e.url,type:"video/mp4"}));case"audio":return dd("audio",{class:"audio_plyr",controls:!0},dd("source",{src:e.url,type:"audio/mp3"}));default:return e.type?dd("div",{className:"embed_block_wrapper"},dd("embed",{width:"200px",height:"300px",controls:!0,type:"application/pdf",src:e.url}),dd("div",{className:"embed_block"})):dd("div",{className:"embed_block_wrapper"},dd("embed",{width:"200px",height:"300px",controls:!0,src:e.url}),dd("div",{className:"embed_block"}))}};return dd("div",{className:"vibe_editor_modal"},dd("span",{onClick:e.close}),dd("div",{className:"ve_modal-content"},dd("div",{className:"ve_modal-header"},dd("div",null,window.vibebp.settings.media_tabs?Object.keys(window.vibebp.settings.media_tabs).map(e=>dd("a",{className:h==e?"active":"",onClick:()=>{w(e)}},window.vibebp.settings.media_tabs[e])):""),dd("span",{className:"vicon vicon-close",onClick:t=>{e.close(!1)}})),dd("div",{className:"ve_modal-body"},"media"===h?dd(_d,null,dd("div",{className:"vibebp_form"},dd("div",{className:"vibebp_form_field"},dd("input",{type:"text",placeholder:window.vibebp.translations.search_text,onChange:e=>g({...f,search_terms:e.target.value})})),dd("div",{className:"vibebp_form_field"},dd("select",{onChange:e=>{g({...f,order:e.target.value})}},Object.keys(window.vibeEditor.media_order).map(e=>dd("option",{value:e},window.vibeEditor.media_order[e]))))),t?dd("div",{className:"loading-roller"},dd("div",null),dd("div",null),dd("div",null),dd("div",null),dd("div",null),dd("div",null),dd("div",null),dd("div",null)):s&&s.length?dd("div",{className:"allMedia"},s.map((t,a)=>dd("div",{className:"single_media"},dd("span",{onClick:a=>{k(t),e.close(!1)}},x(t)),dd("span",{className:"filename",onClick:a=>{k(t),e.close(!1)}},t.name),dd("span",{className:"vicon vicon-close",onClick:()=>(e=>{let t=[...s];t.splice(t.findIndex(t=>t.id==e.id),1),n(t),fetch(window.vibebp.api.url+"/user/delete_media",{method:"post",body:JSON.stringify({token:wd("vibebp").getToken(),media:e})}).then(e=>e.json()).then(e=>{e.hasOwnProperty("message")&&hd("vibebp").addNotification({text:e.message})})})(t)})))):dd("div",{className:"vbp_message"},window.vibebp.translations.no_media),r?dd("a",{className:"link",onClick:()=>{g({...f,paged:f.paged+1}),d(!0)}},window.vibebp.translations.more):""):"upload"===h?dd(_d,null,dd("div",{className:"upload_media"},dd("label",{for:"vibe_editor_upload_media"},u?dd("div",{className:"vibebp_progress_wrapper"},dd("span",{className:"progress_wrapper"},dd("span",{className:"progress_bar",style:{width:u+"%"}})),dd("span",null,u,"%")):dd("span",{className:"vicon vicon-plus"})),dd("input",{type:"file",id:"vibe_editor_upload_media",onChange:e=>(e=>{if(e.target.files[0]){let t=e.target.files[0].size/1024/1024;if(tus.isSupported&&tus.canStoreURLs&&t>4){const t=window.vibebp.api.url+"/user/upload_media_stream";let a=new tus.Upload(e.target.files[0],{endpoint:t,chunkSize:2097152,retryDelays:[0,3e3],metadata:{token:wd("vibebp").getToken(),filename:e.target.files[0].name,filetype:e.target.files[0].type},onError:function(e){e.hasOwnProperty("message")&&hd("vibebp").addNotification({text:e.message})},onProgress:function(e,t){var a=(e/t*100).toFixed(2);m(a),100==a&&setTimeout(()=>{g({posts_per_page:20,paged:1,search_terms:"",orderby:""}),m(0),w("media")},500)},onSuccess:function(){localStorage.removeItem(a._urlStorageKey),fetch(a.url+"/complete_stream",{method:"post",body:JSON.stringify({token:wd("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.status&&(g({posts_per_page:20,paged:1,search_terms:"",orderby:""}),m(0),w("media")),e.hasOwnProperty("message")&&hd("vibebp").addNotification({text:e.message})})}});a.findPreviousUploads().then(e=>{e.length>0&&a.resumeFromPreviousUpload(e[0]),a.start()}),tus.Upload.terminate(t).then((function(){})).catch((function(e){}))}else{let t=new FormData;t.append("file",e.target.files[0]),t.append("body",JSON.stringify({token:wd("vibebp").getToken()})),fetch(window.vibebp.api.url+"/user/upload_media",{method:"post",body:t}).then(e=>e.json()).then(e=>{if(e.status){let t=[...s];t.unshift(e.data),n(t),w("media")}else e.hasOwnPropoerty("message")&&hd("vibebp").addNotification({text:e.message})})}}})(e)}),i&&i.length?dd("div",{className:"uploaded"},dd("strong",null,window.vibebp.translations.uploaded_media),dd("div",{className:"uploaded_files"},i.map((e,t)=>dd("div",{className:"single_media",onClick:t=>{k(e)}},x(e))))):"")):"embed"===h?dd(_d,null,dd("div",{className:"embed_media"},dd("label",{for:"vibe_editor_embed_name"}," ",window.vibebp.translations.enter_emabed_name," "),dd("input",{type:"text",id:"vibe_editor_embed_name",onChange:e=>b({...y,name:e.target.value})}),dd("label",{for:"vibe_editor_embed_url"}," ",window.vibebp.translations.enter_embed_url," "),dd("input",{type:"text",id:"vibe_editor_embed_url",onChange:e=>b({...y,url:e.target.value})}),dd("select",{onChange:e=>b({...y,type:e.target.value}),value:y.type},Object.keys(window.vibeEditor.embed_types).map(e=>dd("option",{value:e},window.vibeEditor.embed_types[e]))),Object.values(y).findIndex(e=>""==e||null==e)>-1?"":dd("button",{className:"button is-primary",onClick:()=>{k(y),e.close(!1)}},window.vibebp.translations.embed))):dd("div",null,(N=new CustomEvent("vibebp_media_tab",{detail:{tab:h}}),document.dispatchEvent(N),dd("div",{className:h}))))));var N};const{createElement:gd,render:yd,useState:bd,useEffect:kd,Fragment:xd,useContext:Nd,useRef:Id}=wp.element,{dispatch:Cd,select:Od}=wp.data;var Sd=e=>{Nd(y);const[t,a]=bd(!1),[s,n]=bd({}),[i,o]=bd(!1),[r,l]=bd(!1),[c,d]=bd([]),[u,m]=bd(null),[p,_]=bd(null);kd(()=>{e.hasOwnProperty("media")&&(e.field.value=e.media),e.field.hasOwnProperty("type")&&n(e.field)},[e.field]);kd(()=>{if(s.hasOwnProperty("value")&&s.value&&s.value.hasOwnProperty("type")&&u){if("audio"==s.value.type||"video"==s.value.type){let e=new Plyr(u);_(e)}if("youtube"==s.value.type){let e=new Plyr(u);_(e)}if("vimeo"==s.value.type){let e=new Plyr(u);_(e)}if("dash"==s.value.type){dashjs.MediaPlayer().create().initialize(u,s.value.url,!0);let e=new Plyr(u,{captions:{active:!0,update:!0}});_(e)}if("hls"==s.value.type){const e=new Plyr(u,{captions:{active:!0,update:!0}});if(Hls.isSupported()){const e=new Hls;e.loadSource(s.value.url),e.attachMedia(u)}else u.src=s.value.url;_(e)}}},[u,s]);const v=e=>{e&&m(e)};return gd("div",{className:"media_wrapper"},s&&s.hasOwnProperty("value")&&s.value&&s.value.hasOwnProperty("url")?gd("div",{className:"media_file"},gd("span",{className:"vicon vicon-close",onClick:()=>{let t={...s};o(!1),l(!1),p&&(p.destroy(),_(null)),t.value=null,n(t),e.update(t,e.fieldIndex,"fieldvaluechanged")}}),gd("div",null," ",(()=>{if(s.hasOwnProperty("value")&&s.value&&s.value.hasOwnProperty("type")&&s.value.hasOwnProperty("url"))switch(s.value.type){case"image":return gd("img",{src:s.value.url,className:"content_to_html_image"});case"video":return gd("div",{className:"video_wrapper"},gd("video",{className:"content_to_html_video",ref:e=>{e&&m(e)}},gd("source",{src:s.value.url,type:"video/mp4"})));case"audio":return gd("div",{className:"video_wrapper"},gd("audio",{className:"content_to_html_audio",ref:e=>{e&&m(e)}},gd("source",{src:s.value.url,type:"audio/mp3"}))," ");case"youtube":let e=(e=>{var t=e.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&|?]+)/);return!(!t||!t.length)&&t[1]})(s.value.url);return e?gd("div",{className:"video_wrapper"},gd("div",{ref:e=>{e&&m(e)},"data-plyr-provider":"youtube","data-plyr-embed-id":e})):gd("div",{className:"video_wrapper"}," ",gd("span",{className:"vicon vicon-alert"},window.wplms_course_data.translations.invalid_url));case"vimeo":let t=s.value.url.match(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/);return gd("div",{className:"video_wrapper"}," ",gd("div",{ref:e=>{e&&m(e)},"data-plyr-provider":"vimeo","data-plyr-embed-id":t[4]}));case"hls":if("m3u8"==s.value.url.split(".").pop())return gd("div",{className:"video_wrapper"},gd("video",{ref:v,controls:!0,crossorigin:!0,playsinline:!0}));break;case"dash":if("mpd"==s.value.url.split(".").pop())return gd("div",{className:"video_wrapper"},gd("video",{ref:v,controls:!0,crossorigin:!0,playsinline:!0}));break;default:return s.value.hasOwnProperty("type")?gd("embed",{width:"200px",height:"300px",controls:!0,type:"application/pdf",src:s.value.url}):gd("embed",{width:"200px",height:"300px",controls:!0,src:s.value.url})}})()," ")):"course_featured"==s.type?gd("div",{onClick:()=>{a(!0)}},gd("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-image"},gd("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),gd("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),gd("polyline",{points:"21 15 16 10 5 21"}))):"featured_video"==s.type?gd("div",{className:"featured_video"},gd("span",{onClick:()=>{o(!1)}},s.label),i&&!r?gd("input",{type:"text",placeholder:window.wplms_create_course_data.translations.enter_video_link+" ("+i+")",value:s.value?s.value.url:"",className:r?"is-success":"is-danger",onChange:t=>{if("youtube"==i){if(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&|?]+)/.test(t.target.value)){l(!0);let a={...s};a.value={type:"youtube",url:t.target.value},n(a),e.update(a,e.fieldIndex,"fieldvaluechanged")}else l(!1)}if("vimeo"==i){if(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/.test(t.target.value)){l(!0);let a={...s};a.value={type:"vimeo",url:t.target.value},n(a),e.update(a,e.fieldIndex,"fieldvaluechanged")}else l(!1)}if("hls"==i)if("m3u8"==t.target.value.split(".").pop()){l(!0);let a={...s};a.value={type:"hls",url:t.target.value},n(a),e.update(a,e.fieldIndex,"fieldvaluechanged")}else l(!1);if("dash"==i)if("mpd"==t.target.value.split(".").pop()){l(!0);let a={...s};a.value={type:"dash",url:t.target.value},n(a),e.update(a,e.fieldIndex,"fieldvaluechanged")}else l(!1)}}):gd("div",{className:"featured_video_options"},gd("span",{className:"vicon vicon-control-play",onClick:()=>a(!0)}),gd("span",{className:"vicon vicon-youtube",onClick:()=>o("youtube")}),gd("span",{className:"vicon vicon-vimeo-alt",onClick:()=>o("vimeo")}),window.wplms_create_course_data.settings.advanced_video_format_hls?gd("span",{className:"vicon vicon-video-clapper",onClick:()=>o("hls")}):"",window.wplms_create_course_data.settings.advanced_video_format_dash?gd("span",{className:"vicon vicon-video-clapper",onClick:()=>o("dash")}):"")):"featured_audio"==s.type?gd("div",{className:"featured_video",onClick:()=>{a(!0)}},s.label,gd("span",{className:"vicon vicon-control-play"})):gd("div",{className:"vicon vicon-plus",onClick:()=>{a(!0)}}),t?gd("div",null,(()=>{document.querySelector("#vibemediamodal")&&document.querySelector("#vibemediamodal").remove();let t=document.createElement("div");t.setAttribute("id","vibemediamodal"),document.body.appendChild(t),yd(gd(fd,{type:e.type,close:()=>{a(!1),document.querySelector("#vibemediamodal").remove()},share:t=>{(t=>{let a={...s};a.value=t,n(a),e.update(a,e.fieldIndex,"fieldvaluechanged")})(t)}}),document.getElementById("vibemediamodal"))})()):"")};const{createElement:qd,render:Pd,useState:Ed,useEffect:zd,Fragment:Td,useContext:Md}=wp.element,{dispatch:jd,select:Ld}=wp.data;var Hd=e=>{const[t,a]=Ed({});zd(()=>{a(e.field)},[e.field]);const s=(s,n,i)=>{if("fieldvaluechanged"==i){let i={...t};s.value&&s.value.hasOwnProperty("url")?i.value[n]=s.value:i.value.splice(n,1),a(i),e.update(i,e.fieldIndex,"fieldvaluechanged")}};return qd("div",{className:"multimedia"},qd("span",{className:"vicon vicon-plus button",onClick:()=>{let e={...t};e.hasOwnProperty("value")&&Array.isArray(e.value)||(e.value=[]),e.value.push({}),a(e)}}),t.value&&t.value.length?qd("div",{className:"attachments"},t.value.map((e,a)=>qd("div",{className:"attachment"},qd(Sd,{field:{type:t.id},media:e,fieldIndex:a,update:s})))):"")};const{createElement:Ad,render:Fd,useState:Dd,useEffect:Rd,useContext:Jd,Fragment:Bd,RawHTML:$d}=wp.element;var Ud=e=>{Jd(y);const[t,a]=Dd(!1),[s,n]=Dd({});Rd(()=>{let t={...e.field};m(t.value)&&(t.value={...t.default},e.update(t,e.fieldIndex,"fieldvaluechanged")),n(t)},[e.field]);const i=t=>{let a={...s};a.value=t,n(a),e.update(a,e.fieldIndex,"fieldvaluechanged")};return Ad("div",{className:"duration_field_wrapper"},t?Ad("div",{className:"duration_field"},Ad("input",{type:"text",value:s.value&&s.value.hasOwnProperty("value")?s.value.value:"",onChange:e=>i({...s.value,value:e.target.value})}),Ad("select",{value:s.value&&s.value.hasOwnProperty("parameter")?s.value.parameter:86400,onChange:e=>{i({...s.value,parameter:e.target.value})}},window.wplms_create_course_data.duration.map(e=>Ad("option",{value:e.value},e.label))),Ad("span",{className:"vicon vicon-close",onClick:()=>{s.value.hasOwnProperty("parameter")||i({...s.value,parameter:86400}),a(!t)}})):m(s.value)?"number"==typeof s.default&&9999==s.default&&"object"==typeof s.default&&9999==s.default.value?Ad("div",{className:"duration_field"},Ad("span",null,window.wplms_create_course_data.translations.unlimited_duration),Ad("span",{className:"vicon vicon-pencil",onClick:()=>{a(!0),i({value:9999,parameter:86400})}})):Ad("div",{className:"duration_field"},Ad("span",null,Ad("label",null,s.label),"object"==typeof s.default?Ad("span",null,Ad("span",null,s.default.value),Ad("span",null,window.wplms_create_course_data.duration[window.wplms_create_course_data.duration.findIndex(e=>e.value==s.default.parameter)].label)):Ad("span",null,Ad("span",null,s.default),Ad("select",{onChange:e=>{i({value:s.default,parameter:e.target.value})}},window.wplms_create_course_data.duration.map(e=>Ad("option",{value:e.value},e.label))))),Ad("span",{className:"vicon vicon-pencil",onClick:()=>a(!0)})):"object"==typeof s.value&&9999==s.value.value?Ad("div",{className:"duration_field"},Ad("span",null,window.wplms_create_course_data.translations.unlimited_duration),Ad("span",{className:"vicon vicon-pencil",onClick:()=>{a(!0),i({value:9999,parameter:86400})}})):Ad("div",{className:"duration_field"},Ad("span",null,"object"==typeof s.value?Ad("span",null,Ad("span",null,s.value.value),Ad("span",null,window.wplms_create_course_data.duration[window.wplms_create_course_data.duration.findIndex(e=>e.value==s.value.parameter)].label)):Ad("span",null,Ad("span",null,s.value),Ad("select",{onChange:e=>{i({value:s.default,parameter:e.target.value})}},window.wplms_create_course_data.duration.map(e=>Ad("option",{value:e.value},e.label))))),Ad("span",{className:"vicon vicon-pencil",onClick:()=>a(!0)})))};const{createElement:Vd,render:Wd,useState:Yd,useEffect:Xd,useContext:Qd,Fragment:Kd,RawHTML:Gd}=wp.element;var Zd=e=>{const t=Qd(y),[a,s]=Yd({});Xd(()=>{s(e.field)},[e.field]);const n=(t,a,s)=>{"fieldvaluechanged"==s&&(e.hasOwnProperty("ufieldIndex")?e.update({field:t,index:a,ufieldIndex:e.ufieldIndex},"fieldvaluechanged"):e.update({field:t,index:a},"fieldvaluechanged")),"curriculumchanged"==s&&e.update({field:t,cindex:a},"curriculumchanged")};return Vd(Kd,null,void 0!==a?Vd("div",{className:"field_wrapper field_"+a.type},"next_button"!=a.type&&"prev_button"!=a.type?Vd("span",null,a.label&&"title"!=a.type&&"course_featured"!=a.type&&"next_button"!=a.type&&"prev_button"!=a.type&&"taxonomy"!=a.type&&"featured_video"!=a.type&&"group"!=a.type&&"forum"!=a.type?Vd("label",null,a.label,a.desc?Vd("a",{className:"tip_trigger",onMouseEnter:e=>{t.update({text:a.desc,position:{screenX:e.screenX,screenY:e.screenY,x:e.clientX,y:e.clientY}},"help")},onMouseLeave:()=>{t.update({},"help")}},Vd("i",{className:"vicon vicon-help-alt"})):""):"",a.text?Vd("strong",null,a.text):""):"",Vd("div",{className:"field_value"},((a,s,i)=>{switch(a.type){case"title":return Vd(ve,{field:a,fieldIndex:s,tabIndex:i,update:n});case"taxonomy":return Vd(Ca,{field:a,fieldIndex:s,tabIndex:i,update:n});case"course_featured":case"featured_image":return Vd(Sd,{field:a,type:"image",fieldIndex:s,tabIndex:i,update:n});case"featured_video":return Vd(Sd,{field:a,type:"video",fieldIndex:s,tabIndex:i,update:n});case"featured_audio":return Vd(Sd,{field:a,type:"audio",fieldIndex:s,tabIndex:i,update:n});case"textarea":return Vd(L,{field:a,fieldIndex:s,tabIndex:i,update:n});case"editor":return Vd(Ds,{field:a,fieldIndex:s,tabIndex:i,update:n});case"next_button":return Vd("a",{className:"button major is-primary",onClick:()=>{let e=t.course[t.activeTab].fields.findIndex(e=>"post_title"==e.id);if(e>-1)if(t.course[t.activeTab].fields[e].value&&t.course[t.activeTab].fields[e].value.length)t.update(t.activeTab+1,"setTab");else{let a=t.course[t.activeTab].fields[e];a.isEmpty=1,a.random=Math.random(),t.update({index:e,field:a},"fieldvaluechanged")}else t.update(t.activeTab+1,"setTab")}},a.label,Vd("span",null,t.course[t.activeTab+1].fields.filter(e=>e&&e.hasOwnProperty("is_changed")&&e.is_changed).length+" / "+t.course[t.activeTab+1].fields.length," ",window.wplms_create_course_data.translations.changes));case"prev_button":return Vd(Kd,null,t.activeTab?Vd("a",{className:"button major",onClick:()=>{t.update(t.activeTab-1,"setTab")}},a.label,Vd("span",null,t.course[t.activeTab-1].fields.filter(e=>e.hasOwnProperty("is_changed")&&e.is_changed).length+" / "+t.course[t.activeTab-1].fields.length," ",window.wplms_create_course_data.translations.changes)):"");case"publish_button":return Vd("a",{className:"button major",onClick:()=>{t.update({},"createthecourse")}},p()?a.label:window.wplms_course_data.course.hasOwnProperty("admin_approval")&&window.wplms_course_data.course.admin_approval&&!t.courseID||window.wplms_course_data.course.hasOwnProperty("admin_approval")&&window.wplms_course_data.course.admin_approval&&t.isDraft?window.wplms_create_course_data.translations.send_for_approval:a.label);case"unlimited_number":return Vd($,{field:a,fieldIndex:s,tabIndex:i,update:n});case"number":return Vd(G,{field:a,fieldIndex:s,tabIndex:i,update:n});case"duration":return Vd(Ud,{field:a,fieldIndex:s,tabIndex:i,update:n});case"select":return Vd(xe,{field:a,fieldIndex:s,tabIndex:i,update:n});case"selectmulticpt":return Vd(In,{field:a,fieldIndex:s,tabIndex:i,update:n});case"multiselect":return Vd(Tn,{field:a,fieldIndex:s,tabIndex:i,update:n});case"showhide":case"switch":case"yesno":case"conditionalswitch":case"reverseconditionalswitch":return Vd(S,{field:a,fieldIndex:s,tabIndex:i,update:n});case"selectcpt":return Vd(vn,{field:a,fieldIndex:s,tabIndex:i,update:n});case"text":return Vd(oe,{field:a,fieldIndex:s,tabIndex:i,update:n});case"media":return Vd(Sd,{field:a,type:"image",fieldIndex:s,tabIndex:i,update:n});case"multiattachments":return Vd(Hd,{field:a,type:"image",fieldIndex:s,tabIndex:i,update:n});case"time":return Vd(De,{field:a,fieldIndex:s,tabIndex:i,update:n});case"date":return Vd(ze,{field:a,fieldIndex:s,tabIndex:i,update:n});case"group":return Vd(jt,{ufieldIndex:e.ufieldIndex,field:a,fieldIndex:s,cindex:e.cindex,tabIndex:i,update:n});case"forum":return Vd($t,{ufieldIndex:e.ufieldIndex,field:a,fieldIndex:s,cindex:e.cindex,tabIndex:i,update:n});case"curriculum":return Vd(Zc,{field:a,fieldIndex:s,tabIndex:i,update:n});case"upload_package":return Vd(cd,{field:a,fieldIndex:s,tabIndex:i,update:n});case"assignment":return Vd(ht,{ufieldIndex:e.ufieldIndex,field:a,fieldIndex:s,cindex:e.cindex,tabIndex:i,update:n});case"quiz_questions":return Vd(La,{question:e.question,ufieldIndex:e.ufieldIndex,field:a,fieldIndex:s,cindex:e.cindex,tabIndex:i,update:n});case"practice_questions":return Vd(zs,{question:e.question,ufieldIndex:e.ufieldIndex,field:a,fieldIndex:s,cindex:e.cindex,tabIndex:i,update:n});case"unit_questions":return Vd(La,{question:e.question,ufieldIndex:e.ufieldIndex,field:a,fieldIndex:s,cindex:e.cindex,tabIndex:i,update:n});case"dynamic_quiz_questions":return Vd(nn,{ufieldIndex:e.ufieldIndex,field:a,fieldIndex:s,cindex:e.cindex,tabIndex:i,update:n});case"repeatable":case"repeatable_count":return Vd(Ys,{ufieldIndex:e.ufieldIndex,field:a,fieldIndex:s,cindex:e.cindex,tabIndex:i,update:n});case"selectproduct":return Vd(Zt,{ufieldIndex:e.ufieldIndex,field:a,fieldIndex:s,cindex:e.cindex,tabIndex:i,update:n});case"course_live":case"save_course_creation_template":break;default:var o=new CustomEvent("wplms_custom_field",{detail:{field:a,index:s,courseContext:t,props:e,update:n}});if(document.dispatchEvent(o),a&&a.hasOwnProperty("id"))return Vd("div",{id:"wplms_custom_field_"+a.id})}return""})(a,e.fieldIndex,e.tabIndex))):"")};const{createElement:eu,render:tu,useState:au,useEffect:su,useContext:nu,Fragment:iu}=wp.element,{dispatch:ou,select:ru}=wp.data;var lu=e=>{const t=nu(y),[a,s]=au(!1),[n,i]=au({}),[o,r]=au({}),[l,c]=au({});su(()=>{i(t.course[t.activeTab]),s(!0)},[t.course[t.activeTab]]),su(()=>{fetch(window.wplms_course_data.api_url+"/getDraft/",{method:"post",body:JSON.stringify({token:ru("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.status&&(ou("vibebp").addNotification({text:window.wplms_course_data.translations.draft_found}),r(e.draft))}),window.wplms_course_data.course.hasOwnProperty("admin_approval")&&window.wplms_course_data.course.admin_approval&&t.courseID&&fetch(window.wplms_course_data.api_url+"/getapproval/",{method:"post",body:JSON.stringify({token:ru("vibebp").getToken(),courseid:t.courseID})}).then(e=>e.json()).then(e=>{e.status&&(ou("vibebp").addNotification({text:window.wplms_course_data.translations.draft_found}),c(e.approval)),e.hasOwnProperty("is_draft")&&t.update(e.is_draft,"setdraftstatus")})},[]);const d=(a,s)=>{"fieldvaluechanged"==s&&(t.update({field:a.field,index:a.index},"fieldvaluechanged"),v(e.fieldIndex)||t.update({field:a.field,fieldIndex:e.fieldIndex,index:e.index},"curriculumchangedunit"))};return a?eu("div",{id:"create_course",className:"tab_content"},eu("ul",{className:"create_course"},n.fields.map((e,a)=>{if(!e.hasOwnProperty("is_child")||!e.is_child)return eu("li",{class:"vibe_"+e.id},eu("div",{className:e.style},eu(Zd,{field:e,fieldIndex:a,update:d,tabIndex:t.activeTab}),e.hasOwnProperty("children")&&e.children.length?e.children.map(e=>{let a=n.fields.findIndex(t=>t&&t.hasOwnProperty("id")&&t.id==e);return eu(Zd,{field:n.fields[a],fieldIndex:a,update:d,tabIndex:t.activeTab})}):""))}),m(o)?eu("li",{className:"course_drafts"}):eu("li",{className:"course_drafts"},eu("span",{onClick:()=>{e.loadDraft(o),r(!1)}},eu("span",{className:"vicon vicon-notepad"}),window.wplms_create_course_data.translations.load_draft),m(l)?"":eu("span",{onClick:()=>{e.loadDraft(l.object),c(!1)}},eu("span",{className:"vicon vicon-user"}),window.wplms_create_course_data.translations.load_instrcutor_edit)))):""};const{createElement:cu,render:du,useState:uu,useEffect:mu,useContext:pu,Fragment:_u}=wp.element;var vu=e=>{const t=pu(y),[a,s]=uu(!1),[n,i]=uu(""),[o,r]=uu({}),[l,c]=uu({});console.log(o),mu(()=>{r(t.course[t.activeTab]),s(!0);let e={...l};t.course[t.activeTab]&&t.course[t.activeTab].fields&&t.course[t.activeTab].fields.length&&(t.course[t.activeTab].fields.map((t,a)=>{"conditionalswitch"!=t.type&&"reverseconditionalswitch"!=t.type||t&&t.hide_nodes&&t.hide_nodes.length&&t.hide_nodes.map(a=>{t.value?e[a]={value:t.value,pid:t.id}:e[a]={value:null,pid:t.id}})}),console.log(e),c(e))},[t.course]);const d=(a,s)=>{"fieldvaluechanged"==s&&(t.update({field:a.field,index:a.index},"fieldvaluechanged"),v(e.fieldIndex)||t.update({field:a.field,fieldIndex:e.fieldIndex,index:e.index},"curriculumchangedunit"))};return a?cu("div",{id:"course_settings",className:"tab_content"},cu("div",{className:"course_settings"},o.fields.map((e,a)=>{if(!e.hasOwnProperty("is_child")||!e.is_child){let s="";return l&&l[e.id]&&(s="conditional_display",!l[e.id].value||"H"==l[e.id].value)?"":cu("div",{className:"vibe_field vibe_"+e.id+" "+s},cu("div",{className:e.style?e.style+" field_wrapper type_"+e.type+" ":"field_wrapper type_"+e.type+" "},cu(Zd,{field:e,fieldIndex:a,update:d,tabIndex:t.activeTab}),e.hasOwnProperty("children")&&e.children.length&&!v(e.value)&&"H"!=e.value?e.children.map(e=>{let a=o.fields.findIndex(t=>t&&t.hasOwnProperty("id")&&t.id==e);return cu(Zd,{field:o.fields[a],fieldIndex:a,update:d,tabIndex:t.activeTab})}):""))}}))):""};const{createElement:hu,render:wu,useState:fu,useEffect:gu,useContext:yu,Fragment:bu}=wp.element;var ku=e=>{const t=yu(y),[a,s]=fu(!1),[n,i]=fu(""),[o,r]=fu({}),[l,c]=fu({});console.log(o),gu(()=>{r(t.course[t.activeTab]),s(!0);let e={...l};t.course[t.activeTab]&&t.course[t.activeTab].fields&&t.course[t.activeTab].fields.length&&(t.course[t.activeTab].fields.map((t,a)=>{"conditionalswitch"!=t.type&&"reverseconditionalswitch"!=t.type||t&&t.hide_nodes&&t.hide_nodes.length&&t.hide_nodes.map(a=>{t.value?e[a]={value:t.value,pid:t.id}:e[a]={value:null,pid:t.id}})}),c(e))},[t.course]);const d=(a,s)=>{"fieldvaluechanged"==s&&(t.update({field:a.field,index:a.index},"fieldvaluechanged"),v(e.fieldIndex)||t.update({field:a.field,fieldIndex:e.fieldIndex,index:e.index},"curriculumchangedunit"))};return a?hu("div",{id:"course_components",className:"tab_content"},hu("div",{className:"course_components"},o.fields.map((a,s)=>{if(!a.hasOwnProperty("is_child")||!a.is_child)return hu("div",{className:"vibe_field vibe_"+a.id},hu("div",{className:a.style?"component_field_wrapper "+a.style:"component_field_wrapper"},hu(Zd,{field:a,fieldIndex:s,update:d,tabIndex:t.activeTab,course:e.course}),a.hasOwnProperty("children")&&a.children.length&&!v(a.value)?a.children.map(e=>{let a=o.fields.findIndex(t=>t&&t.hasOwnProperty("id")&&t.id==e);if(a>-1)return hu(Zd,{field:o.fields[a],fieldIndex:a,update:d,tabIndex:t.activeTab})}):""))}))):""};const{createElement:xu,render:Nu,useState:Iu,useEffect:Cu,useContext:Ou,Fragment:Su,useRef:qu}=wp.element,{select:Pu,dispatch:Eu}=wp.data;var zu=e=>{const t=Ou(y),[a,s]=Iu(!1),[n,i]=Iu({}),[o,r]=Iu({}),[l,c]=Iu(!1),[d,u]=Iu(!1),m=(a,s)=>{"fieldvaluechanged"==s&&(t.update({field:a.field,index:a.index},"fieldvaluechanged"),v(e.fieldIndex)||t.update({field:a.field,fieldIndex:e.fieldIndex,index:e.index},"curriculumchangedunit"))};return Cu(()=>{const e=e=>{let t=e.detail.courseContext.course;i(t[e.detail.courseContext.activeTab]),s(!1),setTimeout(()=>{s(!0),document.dispatchEvent(new CustomEvent("course_edit_curriculum_ready",{detail:{courseContext:e.detail.courseContext}}))},200)};return document.addEventListener("wplms_custom_field_value_changed",e),()=>{document.removeEventListener("wplms_custom_field_value_changed",e)}},[a,s]),Cu(()=>{i(t.course[t.activeTab]),s(!0),document.dispatchEvent(new CustomEvent("course_edit_curriculum_ready",{detail:{courseContext:t}})),void 0!==t.course[t.activeTab].fields[0].curriculum&&t.course[t.activeTab].fields[0].curriculum.length&&c("curriculum"),void 0!==t.course[t.activeTab].fields[1].value&&t.course[t.activeTab].fields[1].value.name&&c("upload_package");let e={...o};t.course[t.activeTab]&&t.course[t.activeTab].fields&&t.course[t.activeTab].fields.length&&(t.course[t.activeTab].fields.map((t,a)=>{"conditionalswitch"!=t.type&&"reverseconditionalswitch"!=t.type||t&&t.hide_nodes&&t.hide_nodes.length&&t.hide_nodes.map(a=>{t.value?e[a]={value:t.value,pid:t.id}:e[a]={value:null,pid:t.id}})}),r(e))},[t.course]),console.log("render"),a?xu("div",{className:"course_curriculum_builder_wrapper"},l?xu("div",{className:"course_curriculum_builder"},xu("span",null,xu("a",{className:"tip",title:window.wplms_create_course_data.translations.change_curriculum_type,onClick:()=>c(!1)},xu("span",{className:"vicon vicon-control-shuffle"})),"curriculum"==l?xu("a",{className:"tip",title:window.wplms_create_course_data.translations.collapse_into_sections,onClick:()=>{t.adHocSettings&&t.adHocSettings.collapse_into_sections?(t.update(!1,"collapse_into_sections"),u(!1)):(u(!0),t.update(!0,"collapse_into_sections"))}},xu("span",{className:d?"vicon vicon-plus":"vicon vicon-minus"})):"",window.wplms_create_course_data.settings.hasOwnProperty("curriculum_icons")?window.wplms_create_course_data.settings.curriculum_icons.map(e=>xu("div",{className:e.key+" tip",title:e.label})):""),xu("ul",{className:"course_curriculum_builder_list"},n.fields.map((e,a)=>{if(!(e.type!=l&&"next_button"!=e.type||e.hasOwnProperty("is_child")&&e.is_child)){let s="";return o&&o[e.id]&&(s="conditional_display",!o[e.id].value||"H"==o[e.id].value)?"":xu("li",{class:"vibe_"+e.id+" "+s},xu("div",{className:e.style},xu(Zd,{field:e,fieldIndex:a,update:m,tabIndex:t.activeTab}),e.hasOwnProperty("children")&&e.children.length&&!v(e.value)?e.children.map(e=>{let a=n.fields.findIndex(t=>t&&t.hasOwnProperty("id")&&t.id==e);return xu(Zd,{field:n.fields[a],fieldIndex:a,update:m,tabIndex:t.activeTab})}):""))}}))):xu("div",{className:"curriculum_type_wrapper"},xu("div",{className:"curriculum_type",onClick:()=>{c("curriculum")}},xu("span",{className:"vicon vicon-layout-menu-v"}),window.wplms_create_course_data.translations.build_curriculum),xu("div",{className:"curriculum_type",onClick:()=>{c("upload_package")}},xu("span",{className:"vicon vicon-upload"}),window.wplms_create_course_data.translations.upload_package))):""};const{createElement:Tu,render:Mu,useState:ju,useEffect:Lu,useContext:Hu,Fragment:Au}=wp.element;var Fu=e=>{const t=Hu(y),[a,s]=ju(!1),[n,i]=ju(""),[o,r]=ju({}),[l,c]=ju({});Lu(()=>{r(t.course[t.activeTab]),s(!0);let e={...l};t.course[t.activeTab]&&t.course[t.activeTab].fields&&t.course[t.activeTab].fields.length&&(t.course[t.activeTab].fields.map((t,a)=>{"conditionalswitch"!=t.type&&"reverseconditionalswitch"!=t.type||t&&t.hide_nodes&&t.hide_nodes.length&&t.hide_nodes.map(a=>{t.value?e[a]={value:t.value,pid:t.id}:e[a]={value:null,pid:t.id}})}),console.log(e),c(e))},[t.course]);const d=(a,s)=>{"fieldvaluechanged"==s&&(t.update({field:a.field,index:a.index},"fieldvaluechanged"),v(e.fieldIndex)||t.update({field:a.field,fieldIndex:e.fieldIndex,index:e.index},"curriculumchangedunit"))};return a?Tu("div",{id:"course_pricing",className:"tab_content"},Tu("div",{className:"course_pricing"},o.fields.map((a,s)=>{if(!a.hasOwnProperty("is_child")||!a.is_child){let n="";return l&&l[a.id]&&(n="conditional_display",!l[a.id].value||"H"==l[a.id].value)?"":Tu("div",{class:"vibe_"+a.id+" "+n},Tu("div",{className:a.style},Tu(Zd,{field:a,fieldIndex:s,update:d,tabIndex:t.activeTab}),a.hasOwnProperty("children")&&a.children.length&&!v(a.value)?a.children.map(a=>{let s=o.fields.findIndex(e=>e&&e.hasOwnProperty("id")&&e.id==a);return Tu(Zd,{field:o.fields[s],fieldIndex:s,update:d,tabIndex:t.activeTab,back:e.back})}):""))}}))):""};const{createElement:Du,render:Ru,useState:Ju,useEffect:Bu,useContext:$u,Fragment:Uu}=wp.element;var Vu=Vu||function(e,t){var a={},s=a.lib={},n=function(){},i=s.Base={extend:function(e){n.prototype=this;var t=new n;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=s.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,a=e.words,s=this.sigBytes;if(e=e.sigBytes,this.clamp(),s%4)for(var n=0;n<e;n++)t[s+n>>>2]|=(a[n>>>2]>>>24-n%4*8&255)<<24-(s+n)%4*8;else if(65535<a.length)for(n=0;n<e;n+=4)t[s+n>>>2]=a[n>>>2];else t.push.apply(t,a);return this.sigBytes+=e,this},clamp:function(){var t=this.words,a=this.sigBytes;t[a>>>2]&=4294967295<<32-a%4*8,t.length=e.ceil(a/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var a=[],s=0;s<t;s+=4)a.push(4294967296*e.random()|0);return new o.init(a,t)}}),r=a.enc={},l=r.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var a=[],s=0;s<e;s++){var n=t[s>>>2]>>>24-s%4*8&255;a.push((n>>>4).toString(16)),a.push((15&n).toString(16))}return a.join("")},parse:function(e){for(var t=e.length,a=[],s=0;s<t;s+=2)a[s>>>3]|=parseInt(e.substr(s,2),16)<<24-s%8*4;return new o.init(a,t/2)}},c=r.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var a=[],s=0;s<e;s++)a.push(String.fromCharCode(t[s>>>2]>>>24-s%4*8&255));return a.join("")},parse:function(e){for(var t=e.length,a=[],s=0;s<t;s++)a[s>>>2]|=(255&e.charCodeAt(s))<<24-s%4*8;return new o.init(a,t)}},d=r.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},u=s.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var a=this._data,s=a.words,n=a.sigBytes,i=this.blockSize,r=n/(4*i);if(t=(r=t?e.ceil(r):e.max((0|r)-this._minBufferSize,0))*i,n=e.min(4*t,n),t){for(var l=0;l<t;l+=i)this._doProcessBlock(s,l);l=s.splice(0,t),a.sigBytes-=n}return new o.init(l,n)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});s.Hasher=u.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,a){return new e.init(a).finalize(t)}},_createHmacHelper:function(e){return function(t,a){return new m.HMAC.init(e,a).finalize(t)}}});var m=a.algo={};return a}(Math);!function(){var e=Vu,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,a=e.sigBytes,s=this._map;e.clamp(),e=[];for(var n=0;n<a;n+=3)for(var i=(t[n>>>2]>>>24-n%4*8&255)<<16|(t[n+1>>>2]>>>24-(n+1)%4*8&255)<<8|t[n+2>>>2]>>>24-(n+2)%4*8&255,o=0;4>o&&n+.75*o<a;o++)e.push(s.charAt(i>>>6*(3-o)&63));if(t=s.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var a=e.length,s=this._map;(n=s.charAt(64))&&(-1!=(n=e.indexOf(n))&&(a=n));for(var n=[],i=0,o=0;o<a;o++)if(o%4){var r=s.indexOf(e.charAt(o-1))<<o%4*2,l=s.indexOf(e.charAt(o))>>>6-o%4*2;n[i>>>2]|=(r|l)<<24-i%4*8,i++}return t.create(n,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,a,s,n,i,o){return((e=e+(t&a|~t&s)+n+o)<<i|e>>>32-i)+t}function a(e,t,a,s,n,i,o){return((e=e+(t&s|a&~s)+n+o)<<i|e>>>32-i)+t}function s(e,t,a,s,n,i,o){return((e=e+(t^a^s)+n+o)<<i|e>>>32-i)+t}function n(e,t,a,s,n,i,o){return((e=e+(a^(t|~s))+n+o)<<i|e>>>32-i)+t}for(var i=Vu,o=(l=i.lib).WordArray,r=l.Hasher,l=i.algo,c=[],d=0;64>d;d++)c[d]=4294967296*e.abs(e.sin(d+1))|0;l=l.MD5=r.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,i){for(var o=0;16>o;o++){var r=e[l=i+o];e[l]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8)}o=this._hash.words;var l=e[i+0],d=(r=e[i+1],e[i+2]),u=e[i+3],m=e[i+4],p=e[i+5],_=e[i+6],v=e[i+7],h=e[i+8],w=e[i+9],f=e[i+10],g=e[i+11],y=e[i+12],b=e[i+13],k=e[i+14],x=e[i+15],N=t(N=o[0],O=o[1],C=o[2],I=o[3],l,7,c[0]),I=t(I,N,O,C,r,12,c[1]),C=t(C,I,N,O,d,17,c[2]),O=t(O,C,I,N,u,22,c[3]);N=t(N,O,C,I,m,7,c[4]),I=t(I,N,O,C,p,12,c[5]),C=t(C,I,N,O,_,17,c[6]),O=t(O,C,I,N,v,22,c[7]),N=t(N,O,C,I,h,7,c[8]),I=t(I,N,O,C,w,12,c[9]),C=t(C,I,N,O,f,17,c[10]),O=t(O,C,I,N,g,22,c[11]),N=t(N,O,C,I,y,7,c[12]),I=t(I,N,O,C,b,12,c[13]),C=t(C,I,N,O,k,17,c[14]),N=a(N,O=t(O,C,I,N,x,22,c[15]),C,I,r,5,c[16]),I=a(I,N,O,C,_,9,c[17]),C=a(C,I,N,O,g,14,c[18]),O=a(O,C,I,N,l,20,c[19]),N=a(N,O,C,I,p,5,c[20]),I=a(I,N,O,C,f,9,c[21]),C=a(C,I,N,O,x,14,c[22]),O=a(O,C,I,N,m,20,c[23]),N=a(N,O,C,I,w,5,c[24]),I=a(I,N,O,C,k,9,c[25]),C=a(C,I,N,O,u,14,c[26]),O=a(O,C,I,N,h,20,c[27]),N=a(N,O,C,I,b,5,c[28]),I=a(I,N,O,C,d,9,c[29]),C=a(C,I,N,O,v,14,c[30]),N=s(N,O=a(O,C,I,N,y,20,c[31]),C,I,p,4,c[32]),I=s(I,N,O,C,h,11,c[33]),C=s(C,I,N,O,g,16,c[34]),O=s(O,C,I,N,k,23,c[35]),N=s(N,O,C,I,r,4,c[36]),I=s(I,N,O,C,m,11,c[37]),C=s(C,I,N,O,v,16,c[38]),O=s(O,C,I,N,f,23,c[39]),N=s(N,O,C,I,b,4,c[40]),I=s(I,N,O,C,l,11,c[41]),C=s(C,I,N,O,u,16,c[42]),O=s(O,C,I,N,_,23,c[43]),N=s(N,O,C,I,w,4,c[44]),I=s(I,N,O,C,y,11,c[45]),C=s(C,I,N,O,x,16,c[46]),N=n(N,O=s(O,C,I,N,d,23,c[47]),C,I,l,6,c[48]),I=n(I,N,O,C,v,10,c[49]),C=n(C,I,N,O,k,15,c[50]),O=n(O,C,I,N,p,21,c[51]),N=n(N,O,C,I,y,6,c[52]),I=n(I,N,O,C,u,10,c[53]),C=n(C,I,N,O,f,15,c[54]),O=n(O,C,I,N,r,21,c[55]),N=n(N,O,C,I,h,6,c[56]),I=n(I,N,O,C,x,10,c[57]),C=n(C,I,N,O,_,15,c[58]),O=n(O,C,I,N,b,21,c[59]),N=n(N,O,C,I,m,6,c[60]),I=n(I,N,O,C,g,10,c[61]),C=n(C,I,N,O,d,15,c[62]),O=n(O,C,I,N,w,21,c[63]);o[0]=o[0]+N|0,o[1]=o[1]+O|0,o[2]=o[2]+C|0,o[3]=o[3]+I|0},_doFinalize:function(){var t=this._data,a=t.words,s=8*this._nDataBytes,n=8*t.sigBytes;a[n>>>5]|=128<<24-n%32;var i=e.floor(s/4294967296);for(a[15+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),a[14+(n+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),t.sigBytes=4*(a.length+1),this._process(),a=(t=this._hash).words,s=0;4>s;s++)n=a[s],a[s]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return t},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}}),i.MD5=r._createHelper(l),i.HmacMD5=r._createHmacHelper(l)}(Math),function(){var e,t=Vu,a=(e=t.lib).Base,s=e.WordArray,n=(e=t.algo).EvpKDF=a.extend({cfg:a.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var a=(r=this.cfg).hasher.create(),n=s.create(),i=n.words,o=r.keySize,r=r.iterations;i.length<o;){l&&a.update(l);var l=a.update(e).finalize(t);a.reset();for(var c=1;c<r;c++)l=a.finalize(l),a.reset();n.concat(l)}return n.sigBytes=4*o,n}});t.EvpKDF=function(e,t,a){return n.create(a).compute(e,t)}}(),Vu.lib.Cipher||function(e){var t=(p=Vu).lib,a=t.Base,s=t.WordArray,n=t.BufferedBlockAlgorithm,i=p.enc.Base64,o=p.algo.EvpKDF,r=t.Cipher=n.extend({cfg:a.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,a){this.cfg=this.cfg.extend(a),this._xformMode=e,this._key=t,this.reset()},reset:function(){n.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,a,s){return("string"==typeof a?_:m).encrypt(e,t,a,s)},decrypt:function(t,a,s){return("string"==typeof a?_:m).decrypt(e,t,a,s)}}}});t.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var l=p.mode={},c=function(e,t,a){var s=this._iv;s?this._iv=void 0:s=this._prevBlock;for(var n=0;n<a;n++)e[t+n]^=s[n]},d=(t.BlockCipherMode=a.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();d.Encryptor=d.extend({processBlock:function(e,t){var a=this._cipher,s=a.blockSize;c.call(this,e,t,s),a.encryptBlock(e,t),this._prevBlock=e.slice(t,t+s)}}),d.Decryptor=d.extend({processBlock:function(e,t){var a=this._cipher,s=a.blockSize,n=e.slice(t,t+s);a.decryptBlock(e,t),c.call(this,e,t,s),this._prevBlock=n}}),l=l.CBC=d,d=(p.pad={}).Pkcs7={pad:function(e,t){for(var a,n=(a=(a=4*t)-e.sigBytes%a)<<24|a<<16|a<<8|a,i=[],o=0;o<a;o+=4)i.push(n);a=s.create(i,a),e.concat(a)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=r.extend({cfg:r.cfg.extend({mode:l,padding:d}),reset:function(){r.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var a=t.createEncryptor;else a=t.createDecryptor,this._minBufferSize=1;this._mode=a.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var u=t.CipherParams=a.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),m=(l=(p.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?s.create([1398893684,1701076831]).concat(e).concat(t):t).toString(i)},parse:function(e){var t=(e=i.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var a=s.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return u.create({ciphertext:e,salt:a})}},t.SerializableCipher=a.extend({cfg:a.extend({format:l}),encrypt:function(e,t,a,s){s=this.cfg.extend(s);var n=e.createEncryptor(a,s);return t=n.finalize(t),n=n.cfg,u.create({ciphertext:t,key:a,iv:n.iv,algorithm:e,mode:n.mode,padding:n.padding,blockSize:e.blockSize,formatter:s.format})},decrypt:function(e,t,a,s){return s=this.cfg.extend(s),t=this._parse(t,s.format),e.createDecryptor(a,s).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),p=(p.kdf={}).OpenSSL={execute:function(e,t,a,n){return n||(n=s.random(8)),e=o.create({keySize:t+a}).compute(e,n),a=s.create(e.words.slice(t),4*a),e.sigBytes=4*t,u.create({key:e,iv:a,salt:n})}},_=t.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:p}),encrypt:function(e,t,a,s){return a=(s=this.cfg.extend(s)).kdf.execute(a,e.keySize,e.ivSize),s.iv=a.iv,(e=m.encrypt.call(this,e,t,a.key,s)).mixIn(a),e},decrypt:function(e,t,a,s){return s=this.cfg.extend(s),t=this._parse(t,s.format),a=s.kdf.execute(a,e.keySize,e.ivSize,t.salt),s.iv=a.iv,m.decrypt.call(this,e,t,a.key,s)}})}(),function(){for(var e=Vu,t=e.lib.BlockCipher,a=e.algo,s=[],n=[],i=[],o=[],r=[],l=[],c=[],d=[],u=[],m=[],p=[],_=0;256>_;_++)p[_]=128>_?_<<1:_<<1^283;var v=0,h=0;for(_=0;256>_;_++){var w=(w=h^h<<1^h<<2^h<<3^h<<4)>>>8^255&w^99;s[v]=w,n[w]=v;var f=p[v],g=p[f],y=p[g],b=257*p[w]^16843008*w;i[v]=b<<24|b>>>8,o[v]=b<<16|b>>>16,r[v]=b<<8|b>>>24,l[v]=b,b=16843009*y^65537*g^257*f^16843008*v,c[w]=b<<24|b>>>8,d[w]=b<<16|b>>>16,u[w]=b<<8|b>>>24,m[w]=b,v?(v=f^p[p[p[y^f]]],h^=p[p[h]]):v=h=1}var k=[0,1,2,4,8,16,32,64,128,27,54];a=a.AES=t.extend({_doReset:function(){for(var e=(a=this._key).words,t=a.sigBytes/4,a=4*((this._nRounds=t+6)+1),n=this._keySchedule=[],i=0;i<a;i++)if(i<t)n[i]=e[i];else{var o=n[i-1];i%t?6<t&&4==i%t&&(o=s[o>>>24]<<24|s[o>>>16&255]<<16|s[o>>>8&255]<<8|s[255&o]):(o=s[(o=o<<8|o>>>24)>>>24]<<24|s[o>>>16&255]<<16|s[o>>>8&255]<<8|s[255&o],o^=k[i/t|0]<<24),n[i]=n[i-t]^o}for(e=this._invKeySchedule=[],t=0;t<a;t++)i=a-t,o=t%4?n[i]:n[i-4],e[t]=4>t||4>=i?o:c[s[o>>>24]]^d[s[o>>>16&255]]^u[s[o>>>8&255]]^m[s[255&o]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,o,r,l,s)},decryptBlock:function(e,t){var a=e[t+1];e[t+1]=e[t+3],e[t+3]=a,this._doCryptBlock(e,t,this._invKeySchedule,c,d,u,m,n),a=e[t+1],e[t+1]=e[t+3],e[t+3]=a},_doCryptBlock:function(e,t,a,s,n,i,o,r){for(var l=this._nRounds,c=e[t]^a[0],d=e[t+1]^a[1],u=e[t+2]^a[2],m=e[t+3]^a[3],p=4,_=1;_<l;_++){var v=s[c>>>24]^n[d>>>16&255]^i[u>>>8&255]^o[255&m]^a[p++],h=s[d>>>24]^n[u>>>16&255]^i[m>>>8&255]^o[255&c]^a[p++],w=s[u>>>24]^n[m>>>16&255]^i[c>>>8&255]^o[255&d]^a[p++];m=s[m>>>24]^n[c>>>16&255]^i[d>>>8&255]^o[255&u]^a[p++],c=v,d=h,u=w}v=(r[c>>>24]<<24|r[d>>>16&255]<<16|r[u>>>8&255]<<8|r[255&m])^a[p++],h=(r[d>>>24]<<24|r[u>>>16&255]<<16|r[m>>>8&255]<<8|r[255&c])^a[p++],w=(r[u>>>24]<<24|r[m>>>16&255]<<16|r[c>>>8&255]<<8|r[255&d])^a[p++],m=(r[m>>>24]<<24|r[c>>>16&255]<<16|r[d>>>8&255]<<8|r[255&u])^a[p++],e[t]=v,e[t+1]=h,e[t+2]=w,e[t+3]=m},keySize:8});e.AES=t._createHelper(a)}();const{createElement:Wu,render:Yu,useState:Xu,useEffect:Qu,Fragment:Ku,RawHTML:Gu}=wp.element;const{createElement:Zu,render:em,useState:tm,useEffect:am,useContext:sm,Fragment:nm}=wp.element,{dispatch:im,select:om}=wp.data;var rm=e=>{const t=sm(y),[a,s]=tm({});return am(()=>{t.hasOwnProperty("help")&&s(t.help)},[t]),a.hasOwnProperty("position")&&a.position.screenX?Zu("div",{className:"wplms_create_course_help",style:window.innerWidth<1920?{position:"fixed",left:0,top:0,width:"240px",transform:"translate("+(a.position.x+10)+"px,"+(a.position.y+10)+"px)"}:{transform:"translate(0,"+a.position.y+"px)"}},Zu("div",{className:"wplms_create_course_help_text"},a.text)):""};const{createElement:lm,render:cm,useState:dm,useEffect:um,Fragment:mm}=wp.element,{dispatch:pm,select:_m}=wp.data;var vm=e=>{let t=_m("vibebp").getUser();t.token=_m("vibebp").getToken();const[a,s]=dm(!1),[n,i]=dm(0),[o,r]=dm(!1),[l,c]=dm(!1),[d,u]=dm(()=>{let t=0;return e.course&&(t=e.course),t}),[m,p]=dm(!1),[v,h]=dm({}),[w,g]=dm({}),[b,k]=dm(null),[x,N]=dm([]);um(()=>{fetch(`${window.wplms_course_data.api_url}/gettabs/${d}?client_id=${window.wplms_course_data.client_id}`,{method:"post",body:JSON.stringify({token:t.token,course:x})}).then(e=>e.json()).then(e=>{e&&e.length&&N(e)})},[d]),um(()=>{const e=e=>{let t=e.detail.courseContext.course;t[e.detail.courseContext.activeTab].fields[e.detail.index]=e.detail.field,t[e.detail.courseContext.activeTab].fields[e.detail.index].is_changed=!0,pm("vibebp").setData("CreateCourse",t),N(t)};return document.addEventListener("wplms_custom_field_value_changed",e),()=>{document.removeEventListener("wplms_custom_field_value_changed",e)}},[a,s]);_(()=>{o&&fetch(window.wplms_course_data.api_url+"/saveDraft/",{method:"post",body:JSON.stringify({token:t.token,course:x,course_id:d})}).then(e=>e.json()).then(e=>{r(!1),e.status&&pm("vibebp").addNotification({text:e.message})})},1500,[x]);return lm(mm,null,x&&x.length?lm(y.Provider,{value:{course:x,courseID:d,activeTab:n,help:v,adHocSettings:w,update:(a,s)=>{let o=[...x];switch(s){case"fieldvaluechanged":a.field&&(o[n].fields[a.index]=a.field,o[n].fields[a.index].is_changed=!0,N(o)),r(!0);break;case"curriculumchanged":a.field&&(o[n].fields[a.fieldIndex].is_changed=!0,o[n].fields[a.fieldIndex].curriculum[a.cindex]=a.field,a.hasOwnProperty("setting_index")&&o[n].fields[a.fieldIndex].curriculum[a.cindex].hasOwnProperty("settings")&&(o[n].fields[a.fieldIndex].curriculum[a.cindex].settings[a.setting_index].is_changed=!0),N(o),r(!0));break;case"curriculumchangedunitdata":a.field&&(console.log(o),o[n].fields[a.fieldIndex].hasOwnProperty("curriculum")||(o[n].fields[a.fieldIndex].curriculum=[]),void 0===o[n].fields[a.fieldIndex].curriculum[a.cindex]&&(o[n].fields[a.fieldIndex].curriculum[a.cindex]={settings:[]}),o[n].fields[a.fieldIndex].is_changed=!0,a.hasOwnProperty("child_index")&&!f(a.child_index)&&a.hasOwnProperty("value_index")&&!f(a.value_index)&&o[n].fields[a.fieldIndex].curriculum[a.cindex].settings[a.ufieldIndex].value[a.value_index]&&o[n].fields[a.fieldIndex].curriculum[a.cindex].settings[a.ufieldIndex].value[a.value_index].hasOwnProperty("settings")&&(o[n].fields[a.fieldIndex].curriculum[a.cindex].settings[a.ufieldIndex].value[a.value_index].settings[a.child_index].is_changed=!0),r(!0),N(o));break;case"curriculumchangedunit":a.field&&(o[n].fields[a.fieldIndex].is_changed=!0,o[n].fields[a.fieldIndex].curriculum[a.index]=a.field,o[n].fields[a.fieldIndex].curriculum[a.index].is_changed=!0,N(o),r(!0));break;case"currentEditingassignmentIndex":o[n].fields[a.fieldIndex].curriculum[a.cindex].settings[a.ufieldIndex].currentEditingassignmentIndex=a.field,N(o),r(!0);break;case"currentEditingquestionIndex":o[n].fields[a.fieldIndex].curriculum[a.cindex].settings[a.ufieldIndex].currentEditingquestionIndex=a.field,N(o),r(!0);break;case"currentEditingunitIndex":o[n].fields[a.fieldIndex].currentEditingunitIndex=a.field,N(o);break;case"removecurriculum":if(o[n].fields[a.fieldIndex].curriculum&&o[n].fields[a.fieldIndex].curriculum.length){let e=[...o[n].fields[a.fieldIndex].curriculum],t=-1;parseInt(a.index)==parseInt(e.length-1)&&parseInt(e.length)>=2?t=a.index-1:e[parseInt(a.index+1)]&&(t=a.index),o[n].fields[a.fieldIndex].curriculum.splice(a.index,1),o[n].fields[a.fieldIndex].currentEditingunitIndex=t,o[n].fields[a.fieldIndex].is_changed=!0,r(!0)}N(o);break;case"removeassigmentfromunit":o[n].fields[a.fieldIndex].curriculum[a.cindex].settings[a.ufieldIndex].value&&o[n].fields[a.fieldIndex].curriculum[a.cindex].settings[a.ufieldIndex].value.length&&(o[n].fields[a.fieldIndex].curriculum[a.cindex].settings[a.ufieldIndex].value.splice(a.index,1),o[n].fields[a.fieldIndex].is_changed=!0,o[n].fields[a.fieldIndex].curriculum[a.cindex].settings[a.ufieldIndex].is_changed=!0,r(!0)),N(o);break;case"loadfull":N(a);break;case"savethecourse":case"createthecourse":(()=>{p(1);let a={post_title:"",post_excerpt:"",post_content:"",meta:[],taxonomy:[]};new Promise(e=>{x.map((t,s)=>{t.fields.map(e=>{if(e.hasOwnProperty("from")&&void 0!==e.value||"curriculum"==e.type){if("post"==e.from&&(console.log("post",e.id),a[e.id]=e.value,"post_content"==e.id&&e.hasOwnProperty("raw")&&a.meta.push({meta_key:"raw",meta_value:e.raw})),"meta"==e.from){let t=a.meta.findIndex(t=>t.meta_key==e.id);if("duration"==e.type&&"object"==typeof e.value){let t=a.meta.findIndex(t=>t.meta_key==e.id+"_parameter");t>-1&&e.value.hasOwnProperty("parameter")?a.meta[t].meta_value=e.value.parameter:e.value.hasOwnProperty("parameter")&&a.meta.push({meta_key:e.id+"_parameter",meta_value:e.value.parameter}),e.value=e.value.value}"media"==e.type&&"object"==typeof e.value&&(e.value=e.value.id),t>-1?a.meta[t].meta_value=e.value:a.meta.push({meta_key:e.id,meta_value:e.value})}if("taxonomy"==e.type){let t=a.taxonomy.findIndex(t=>t.taxonomy==e.taxonomy);-1==t?a.taxonomy.push({taxonomy:e.taxonomy,value:e.value}):a.taxonomy[t].value=e.value}if("upload_package"==e.type&&a.meta.push({meta_key:e.id,meta_value:e.value}),"curriculum"==e.type&&e.hasOwnProperty("curriculum")&&e.curriculum.length){let t=[];e.curriculum.map(e=>{"section"==e.type?t.push(e.data):e.data.hasOwnProperty("id")&&t.push(e.data.id)}),console.log("curriculum",t),a.meta.push({meta_key:e.id,meta_value:t})}}}),s==x.length-1&&e()})}).then(()=>{console.log(a),p(2),fetch(`${window.wplms_create_course_data.api_url}/create/${d}`,{method:"post",body:JSON.stringify({course:a,object:x,token:t.token,course_id:d})}).then(e=>e.json()).then(t=>{t.status?(u(t.course_id),p(x.length),setTimeout(()=>{p(!1),e.back()},500)):t.hasOwnProperty("message")&&pm("vibebp").addNotification({text:t.message})})})})();break;case"setTab":i(a);break;case"help":h(a);break;case"setdraftstatus":c(a);break;default:let l={...w};l[s]=a,g(l)}},isDraft:l}},lm("div",{className:"wplms_create_course_overlay"},lm("div",{className:"wplms_create_course_wrapper"},lm("div",{className:"wplms_course_creation_tabs"},lm("ul",null,(()=>{let e=[];return x.map((t,a)=>{let s="";n>=a&&(s="active"),n==a&&(s+=" current"),e.push(lm("li",{className:t.id+" "+s,onClick:e=>{if(e.preventDefault(),a>0){let e=x[0].fields.findIndex(e=>"post_title"==e.id);if(e>-1)if(x[0].fields[e].hasOwnProperty("value")&&x[0].fields[e].value.length)i(a);else{let t=[...x];t[0].fields[e].isEmpty=1,t[0].fields[e].random=Math.random(),N(t)}else i(a)}else i(a)}},lm("i",{className:t.icon}),lm("a",{href:"#"+t.id},lm("strong",null,t.title),lm("span",null,t.subtitle))))}),e})())),lm("div",{className:"wplms_edit_course_content"},"create_course"==x[n].id?lm(lu,{loadDraft:e=>{N(e)},back:()=>e.back()}):"course_settings"==x[n].id?lm(vu,null):"course_components"==x[n].id?lm(ku,{course:d}):"course_curriculum"==x[n].id?lm(zu,null):"course_pricing"==x[n].id?lm(Fu,null):"")),lm("div",{className:"wplms_create_course_help_wrapper"},lm(rm,null)))):"",m?lm("div",{className:"saving_course_wrapper"},lm("div",{className:"saving_course"},lm("h2",null,window.wplms_create_course_data.translations.saving_course),lm("div",{className:"saving_course_elements"},x.map((e,t)=>lm("div",{className:"saving_course_element"},lm("strong",null,e.title),lm("i",{className:m>=t?"vicon vicon-check-box":"vicon vicon-check"})))))):"")};const{createElement:hm,render:wm,useState:fm,useEffect:gm,useContext:ym,Fragment:bm,RawHTML:km}=wp.element;var xm=e=>{const[t,a]=fm({}),[s,n]=fm(!0);return gm(()=>{a(e.course),n(!1)},[e.course]),s?hm(tl,null):hm(bm,null,hm("div",null,hm("div",{className:"course_featured_image"},hm("img",{src:t.featured_image,alt:t.name,width:"460",height:"300"})),hm("div",{className:"course_block_content_wrapper"},hm("div",{className:"course_title_wrapper"},hm("div",{className:"course_title"},hm("h3",{dangerouslySetInnerHTML:{__html:t.name}})),hm("div",{className:"course_instructor"},hm("img",{src:t.instructor.avatar}),hm("span",null,t.instructor.name)),hm("div",{className:"course_categories"},t.categories.length?t.categories.map(e=>hm("span",null,e.name)):"")))),hm("div",{className:"course_meta"},hm("span",null,hm("span",{className:"vicon vicon-user"})," ",t.total_students),t.start_date?hm("span",null,hm("span",{className:"vicon vicon-alarm-clock"})," ",t.total_students):"",t.seats?hm("span",null,hm("span",{className:"vicon vicon-view-grid"})," ",t.seats):"",hm("span",null,hm("span",{className:"vicon vicon-star"})," ",t.average_rating," (",t.rating_count,")")))};const{createElement:Nm,useState:Im,useEffect:Cm,useRef:Om,Fragment:Sm,render:qm}=wp.element,{dispatch:Pm,select:Em}=wp.data,zm=Math.round(100*Math.random());var Tm=e=>{const t=Om(null),[a,s]=Im(!0),[n,i]=Im(!1),[o,r]=Im(!1),[l,c]=Im(""),[d,u]=Im(""),[m,p]=Im(""),[_,v]=Im(""),[h,w]=Im({x:0,y:0,width:0,height:0,type:"image"}),[f,g]=Im(""),[y,b]=Im(window.vibebp.translations.select_image);Cm(()=>{e.hasOwnProperty("crop")&&e.crop&&i(!0)},[]),Cm(()=>{if(o&&f&&n)new vl.a(f,{returnMode:"ratio",onCropEnd:function(t){let a={...h};a.x=100*t.x,a.y=100*t.y,a.height=100*t.height,a.width=100*t.width,w(a);let s={x:f.naturalWidth*t.x,y:f.naturalHeight*t.y,width:f.naturalWidth*t.width,height:f.naturalHeight*t.height};e.update(_,s)}})},[o,f]);let k={backgroundPosition:h.x+"% "+h.y+"%",backgroundSize:1e4/h.width+"% "+1e4/h.height+"% ",backgroundImage:"url("+l+")"};return Nm("div",{className:"uploader"},a?Nm("label",{for:"fileupload_"+zm,className:"upload_file"},y,"image"==e.type?Nm("input",{id:"fileupload_"+zm,"data-type":e.type,ref:t,type:"file",accept:"image/*",onChange:a=>{t.current.files[0].size<window.vibebp.settings.upload_limit?(c(window.URL.createObjectURL(t.current.files[0])),s(!1),v(t.current.files),e.update(t.current.files,{...h,key:"image"})):(b(window.vibebp.translations.image_size_error),setTimeout(()=>{b(window.vibebp.translations.select_image)},3500))}}):"video"==e.type?Nm("input",{id:"fileupload_"+zm,"data-type":e.type,ref:t,type:"file",accept:"video/*",onChange:a=>{t.current.files[0].size<window.vibebp.settings.upload_limit?(u(window.URL.createObjectURL(t.current.files[0])),s(!1),v(t.current.files),e.update(t.current.files,{...h,key:"video"})):(b(window.vibebp.translations.image_size_error),setTimeout(()=>{b(window.vibebp.translations.select_image)},3500))}}):Nm("input",{id:"fileupload_"+zm,"data-type":e.type,ref:t,type:"file",onChange:a=>{t.current.files[0].size<window.vibebp.settings.upload_limit?(p(window.URL.createObjectURL(t.current.files[0])),s(!1),v(t.current.files),e.update(t.current.files,{...h,key:"attachment"})):(b(window.vibebp.translations.image_size_error),setTimeout(()=>{b(window.vibebp.translations.select_image)},3500))}})):Nm("div",{className:"uploaded_src"},"image"==e.type?Nm(Sm,null,n?Nm(Sm,null,Nm("div",{className:"uploaded_image",style:k}),Nm("span",null,Nm("span",{className:"vicon vicon-pencil",onClick:()=>{r(!o)}}),Nm("span",{className:"vicon vicon-close",onClick:()=>{i(!1),s(!0),g(""),c(""),w({x:0,y:0,width:0,height:0})}})),o?Nm("div",{className:"cropimage",id:"cropper"},Nm("img",{src:l,ref:e=>{g(e)}})):""):Nm("img",{src:l})):"video"==e.type?Nm(Sm,null,Nm("video",{src:d})):Nm(Sm,null,Nm("i",{className:"vicon vicon-clip"}))))};const{createElement:Mm,useState:jm,useEffect:Lm,Fragment:Hm,render:Am}=wp.element,{dispatch:Fm,select:Dm}=wp.data;var Rm=e=>{const[t,a]=jm([]),[s,n]=jm([]),[i,o]=jm(""),[r,l]=jm({content:"",component:"activity",component_id:"",parent_id:"",meta:[]});Lm(()=>{e.hasOwnProperty("activity_id")&&l({content:"",component:"activity_comment",component_id:e.comment_id,parent_id:e.activity_id,meta:[]}),e.hasOwnProperty("component")&&"personal"!=e.component&&l({...r,component:e.component,component_id:e.id})},[]),Lm(()=>{r.component.length&&"activity"!==r.component&&"activity_comment"!==r.component&&fetch(`${window.vibebp.api.url}/${r.component}/user/${Dm("vibebp").getUser().id}/get_items`,{method:"post",body:JSON.stringify({token:Dm("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.status&&Array.isArray(e.groups)&&a(e.groups)})},[r.component]);return Mm("div",{className:"portal activity_post"},Mm("div",{className:"portal_body"},Mm("textarea",{placeholder:window.vibebp.translations.whats_new,onChange:e=>{let t={...r};t.content=e.target.value,l(t)}},r.content)),Mm("div",{className:"portal_footer"},e.hasOwnProperty("activity_id")||"activity"!==r.component?"":Mm("div",{className:"footer_main"},Mm("select",{value:r.component,onChange:e=>{let t={...r};t.component=e.target.value,l(t)}},Object.keys(window.vibebp.components.activity.post.components).map(e=>Mm("option",{value:e},window.vibebp.components.activity.post.components[e]))),t.length?Mm("select",{value:r.component_id,onChange:e=>{let t={...r};t.component_id=e.target.value,l(t)}},Mm("option",null,window.vibebp.translations.select_component),t.map(e=>Mm("option",{value:e.id},e.label))):""),Mm("div",{className:"footer_links"},s.length?s.map((e,t)=>Mm(Hm,null,Mm("a","image"==e?{className:"vicon vicon-image upload_type"}:"video"==e?{className:"vicon vicon-video-camera upload_type"}:{className:"vicon vicon-clip upload_type"}),Mm(Tm,{type:e,update:(a,s)=>{let n=[...i];n[t]=new File([a[0]],a[0].name),o(n),l({...r,meta:[...r.meta,{key:e,value:t}]})}}),Mm("a",{className:"vicon vicon-close",onClick:()=>{let e=[...s];e.splice(t,1);let a=[...i];a.splice(t,1),o(a),n(e)}}))):"",Mm(Hm,null,Mm("a",{className:"vicon vicon-clip",onClick:()=>{let e=[...s];e.push("attachment"),n(e)}}),Mm("a",{className:"vicon vicon-video-camera",onClick:()=>{let e=[...s];e.push("video"),n(e)}}),Mm("a",{className:"vicon vicon-image",onClick:()=>{let e=[...s];e.push("image"),n(e)}})),Mm("a",{className:"button is-primary",onClick:()=>{if(r.content.length){var t=new FormData;t.append("body",JSON.stringify({args:r,token:Dm("vibebp").getToken()})),i.length&&i.map((e,a)=>{t.append("files_"+a,e)}),fetch(`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}/add`,{method:"post",body:t}).then(e=>e.json()).then(t=>{t.status&&(e.update(t.activity,"add"),l({...r,content:"",meta:[]}),o([]),Fm("vibebp").addNotification({text:t.activity.action}))})}}},window.vibebp.translations.post_update),e.hasOwnProperty("activity_id")?Mm("a",{className:"button is-text",onClick:()=>{e.update("","cancel")}},window.vibebp.translations.cancel):"")))};const{createElement:Jm,useState:Bm,useEffect:$m,Fragment:Um,render:Vm}=wp.element,{dispatch:Wm,select:Ym}=wp.data,Xm=e=>{const[t,a]=Bm({}),[s,n]=Bm(!1),[o,r]=Bm(!1),[l,c]=Bm(!1),[d,u]=Bm([]);$m(()=>{a(e.activity),localforage.getItem("favorite_activities_"+Ym("vibebp").getUser().id).then(e=>{e&&(e=JSON.parse(e),c(e))}),localforage.getItem("liked_activities_"+Ym("vibebp").getUser().id).then(e=>{e&&(e=JSON.parse(e),u(e))})},[e.activity]);t.hasOwnProperty("date_recorded")||(t.date_recorded=(new Date).getTime());let m="activity_item "+t.type+" "+t.component;if(t.hasOwnProperty("content")&&t.content.length&&(m+=" with_activity_content"),s&&(m+=" removed"),"string"==typeof t.date_recorded){t.date_recorded=Date.parse(t.date_recorded),t.date_recorded=t.date_recorded/1e3;let e=(new Date).getTimezoneOffset();t.date_recorded=t.date_recorded+60*e}return Jm("div",{className:m,"data-activity-id":t.id},Jm("div",{className:"activity_avatar"},Jm("img",{src:t.avatar})),Jm("div",{className:"activity_body"},Jm("div",{className:"activity_header"},Jm("span",{dangerouslySetInnerHTML:{__html:t.action}})),t.hasOwnProperty("content")&&t.content.length?Jm("div",{className:"activity_content"},Jm("span",{dangerouslySetInnerHTML:{__html:t.content}}),Jm("div",{className:"activity_attachments"},t.hasOwnProperty("meta")&&Object.keys(t.meta).length?Object.keys(t.meta).map(e=>Jm(Um,null,t.meta[e].map(t=>{if(t.length>3){if("image"==e)return Jm("img",{src:t,className:"activity_meta image"});if("video"==e)return Jm("video",{className:"activity_meta video",ref:e=>{e&&new Plyr(e)}},Jm("source",{src:t,type:"video/mp4"}));if("audio"==e)return Jm("audio",{className:"activity_meta audio",ref:e=>{e&&new Plyr(e)}},Jm("source",{src:videoUrl,type:"audio/mp3"}));if("attachment"==e)return Jm("a",{href:t,target:"_blank",className:"vicon vicon-clip activity_meta"})}}))):"")):"",Jm("span",{className:"datetime"},Jm(Ct,{timestamp:t.date_recorded})),Jm("div",{className:"activity_actions"},window.vibebp.settings.likes?Jm("a",{className:-1===d.indexOf(t.id)?"vicon vicon-thumb-up":"vicon vicon-thumb-up filled",onClick:()=>{let a=[],s=-1;d&&(a=[...d],s=d.indexOf(t.id));let n="add-like";-1===s?a.push(t.id):(n="remove-like",e.update(t,"remove-like"),a.splice(s,1)),fetch(`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}/${n}`,{method:"post",body:JSON.stringify({activity_id:t.id,token:Ym("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.hasOwnProperty("message")&&Ym("vibebp").addNotification({text:e.message}),localforage.setItem("liked_activities_"+Ym("vibebp").getUser().id,JSON.stringify(a))}),u(a)}}):"",Jm("a",{className:t.hasOwnProperty("children")&&t.children?"vicon vicon-comment-alt":"vicon vicon-comment",onClick:()=>{r(!o)}}),Jm("a",{className:l&&-1!==l.indexOf(t.id)?"vicon vicon-star filled":"vicon vicon-star",onClick:()=>{let a=[],s=-1;l&&(a=[...l],s=l.indexOf(t.id));let n="add-favorite";-1===s?a.push(t.id):(n="remove-favorite",e.update(t,"remove-favorite"),a.splice(s,1)),fetch(`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}/${n}`,{method:"post",body:JSON.stringify({activity_id:t.id,token:Ym("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.hasOwnProperty("message")&&Ym("vibebp").addNotification({text:e.message}),localforage.setItem("liked_activities_"+Ym("vibebp").getUser().id,JSON.stringify(a))})}}),Jm("a",{className:"vicon vicon-trash",onClick:()=>{fetch(`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}/remove`,{method:"post",body:JSON.stringify({activity_id:t.id,parent_id:e.rootActivityId,token:Ym("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.hasOwnProperty("message")&&Ym("vibebp").addNotification({text:e.message})}),n(!0),e.update(t,"remove")}})),o?Jm(Rm,{activity_id:e.rootActivityId,update:(e,s)=>{let n={...t};if("add"===s&&(n.children?n.children[Object.keys(n.children).length]=e:("object"==typeof n.children&&null!==n.children||(n.children={}),n.children[0]=e),r(!1),a(n)),"remove"===s){-1!==Object.keys(n.children).findIndex(t=>n.children[t].id===e.id)&&(delete n.children[i],a(n))}"cancel"===s&&r(!1)},comment_id:t.id}):"",t.hasOwnProperty("children")&&t.children?Jm("div",{class:"activity_list"},Object.keys(t.children).map(a=>Jm(Xm,{activity:t.children[a],rootActivityId:e.rootActivityId}))):""))};var Qm=Xm;const{createElement:Km,render:Gm,useState:Zm,useEffect:ep,useContext:tp,Fragment:ap,RawHTML:sp}=wp.element,{dispatch:np,select:ip}=wp.data;var op=e=>{const[t,a]=Zm(!1),[s,n]=Zm(!1),[i,o]=Zm(),r=parseInt(e.member),[l,c]=Zm({paged:1,search_terms:"",per_page:20,action:"",order:"DESC",scope:r}),[d,u]=Zm(""),[m,p]=Zm(!1),[v,h]=Zm(!1),[w,f]=Zm(!1);let g=ip("vibebp").getUser();g.token=ip("vibebp").getToken();const y=window.wplms_course_data.api_url;_(()=>{a(!0);let t={method:"POST",body:JSON.stringify({id:e.id,filter:l,token:g.token})};fetch(`${y}/instructor/${e.cpt}/activity`,t).then(e=>e.json()).then(e=>{if(a(!1),e.status){if(m){let t=[...i,...e.data.activities];o(t),p(!1)}else o(e.data.activities);e.data.has_more_items?h(!0):h(!1),e.is_instructor&&f(e.is_instructor)}else e.hasOwnProperty("message")&&np("vibebp").addNotification({text:e.message})})},500,[l]);const b=(e,t)=>{let a=[...i];if("remove"===t||"remove-favorite"==t&&"activity-favs"==args.filter){let t=a.findIndex(t=>t.id===e.id);-1!==t&&(a.splice(t,1),o(a))}"add"===t&&(a.unshift(e),o(a))};return Km("div",{className:"course_activity_wrapper"},Km("div",{className:"portal"},Km("div",{className:"portal_header"},Km("div",{className:"header_links"},Km("div",{className:"searchbox active"},Km("span",{className:"vicon vicon-search"}),Km("input",{type:"text",placeholder:window.wplms_course_data.translations.search,value:l.search_terms,onChange:e=>{c({...l,search_terms:e.target.value})}}))),Km("div",{className:"header_extras"},Km("select",{value:l.scope,onChange:e=>{c({...l,scope:e.target.value})}},Km("option",{value:"all"},"All"),Km("option",{value:"personal"},"personal")),Km("div",{className:"filter_by"},Km("select",{value:l.action,onChange:e=>{c({...l,action:e.target.value})}},Km("option",null,window.wplms_course_data.translations.filter_by),Object.keys(window.wplms_course_data.course.admin.activity_sorters).length?Object.keys(window.wplms_course_data.course.admin.activity_sorters).map(e=>Km("option",{value:e},window.wplms_course_data.course.admin.activity_sorters[e])):""),Km("span",null,Km("span",{className:"ASC"==l.order?"vicon vicon-angle-up active":"vicon vicon-angle-up",onClick:()=>{c({...l,order:"ASC"})}}),Km("span",{className:"DESC"==l.order?"vicon vicon-angle-down active":"vicon vicon-angle-down",onClick:()=>{c({...l,order:"DESC"})}}))))),Km("div",{className:"portal_body"},t?Km(tl,null):"",i&&i.length?Km("div",{className:"activity_list"},i.map(e=>Km(Qm,{activity:e,rootActivityId:e.id,update:b}))):Km("div",{className:"vbp_message"},window.wplms_course_data.translations.no_activity),v?Km("a",{className:"link",onClick:()=>{p(!0),c({...l,paged:l.paged+1})}},window.wplms_course_data.translations.load_more):null)))};const{createElement:rp,render:lp,useState:cp,useEffect:dp,useContext:up,Fragment:mp,RawHTML:pp}=wp.element;var _p=e=>{const[t,a]=cp(e.member);return dp(()=>{a(e.member)},[e.member]),t?rp(mp,null,rp("div",{className:"user_credentials"},t.image?rp("img",{className:"user_image",src:t.image}):"",t.nickname?rp("span",{dangerouslySetInnerHTML:{__html:t.nickname}}):"",t.hasOwnProperty("progress")?rp("div",{class:"course_progress_wrapper"},rp("div",{class:"course_progress"},rp("span",{style:{width:t.progress+"%"}})),rp("span",null,t.progress,"%")):"",t.hasOwnProperty("expiry")?rp(Ct,{timestamp:t.expiry,notimediff:1}):"",t.hasOwnProperty("meta")?t.meta.map(e=>{rp("span",null,e.label," ",rp("span",null),e.value)}):""),rp("div",null,e.is_instructor?rp(mp,null,e.onReset?rp("span",{onClick:()=>e.onReset(t.user_id),className:"tip",title:window.wplms_course_data.translations.reset_course},rp("i",{className:"vicon vicon-reload"})):"",e.onMemberActivity?rp("span",{onClick:()=>e.onMemberActivity(t.user_id),className:"tip",title:window.wplms_course_data.translations.user_activity},rp("i",{className:"vicon vicon-pulse"})):"",e.onCourseStats?rp("span",{onClick:()=>e.onCourseStats(t.user_id),className:"tip",title:window.wplms_course_data.translations.user_stats},rp("i",{className:"vicon vicon-pie-chart"})):"",e.onRemove?rp("span",{onClick:()=>e.onRemove(t.user_id),className:"tip",title:window.wplms_course_data.translations.remove_user}," ",rp("i",{className:"vicon vicon-close"})):"",e.onCourseStructure?rp("span",{onClick:()=>e.onCourseStructure(t.user_id)},"   ",rp("i",{className:"vicon vicon-bar-chart"})," "):"",e.onQuizReset?rp("span",{onClick:()=>e.onQuizReset(t.user_id)}," ",rp("i",{className:"vicon vicon-reload"})):"",e.onQuizStructure?rp("span",{onClick:()=>e.onQuizStructure(t.user_id)}," ",rp("i",{className:"vicon vicon-medall"})):""):"")):""};const{createElement:vp,render:hp,useState:fp,useEffect:gp,useContext:yp,Fragment:bp,RawHTML:kp}=wp.element;const{createElement:xp,render:Np,useState:Ip,useEffect:Cp,useContext:Op,Fragment:Sp,RawHTML:qp,useRef:Pp}=wp.element,{dispatch:Ep,select:zp}=wp.data;var Tp=e=>{let t=zp("vibebp").getUser();t.token=zp("vibebp").getToken();Pp();const a=Pp(null),s=window.wplms_course_data.api_url,[n,i]=Ip(!1),[o,r]=Ip(!1),[l,c]=Ip(""),[d,u]=Ip(!1),[m,p]=Ip(!1),[v,h]=Ip(!1),[w,f]=Ip([]),[g,y]=Ip(),[b,k]=Ip(!1),[x,N]=Ip(!1),[I,C]=Ip({paged:1,order:"alphabetical",course_status:"",search_terms:"",per_page:20}),[O,S]=Ip(!1),[q,P]=Ip(),[E,z]=Ip(""),T=e.course,[M,j]=Ip(),[L,H]=Ip(!1),[A,F]=Ip(!1),[D,R]=Ip(!1),[J,B]=Ip([]),[$,U]=Ip([]),[V,W]=Ip(""),[Y,X]=Ip(0),[Q,K]=Ip(""),[G,Z]=Ip(0),[ee,te]=Ip(""),[ae,se]=Ip(),[ne,ie]=Ip(""),[oe,re]=Ip(!1),[le,ce]=Ip({subject:"",message:"",all:!1});Cp(()=>{P(I)},[]),_(()=>{u(!0);let e={method:"POST",body:JSON.stringify({course_id:T,filter:I,token:t.token})};fetch(s+"/instructor/courses/members",e).then(e=>e.json()).then(e=>{if(u(!1),e){if(b){let t=[...g,...e.data];y(t),t.length<e.total?S(!0):S(!1),k(!1)}else y([...e.data]),e.data.length<e.total?S(!0):S(!1);e.hasOwnProperty("is_instructor")&&N(e.is_instructor)}})},500,[I]);const de=e=>{let t=M?[...M]:[],a=t.indexOf(e);a>=0?t.splice(a,1):t.push(e),j(t)},ue=e=>!!M&&M.includes(e);_(()=>{if(ne&&ne.length){R(!0);let e={method:"POST",body:JSON.stringify({course_id:T,student_name:ne,token:t.token})};fetch(s+"/instructor/courses/search_students_to_add",e).then(e=>e.json()).then(e=>{R(!1),e&&(e.status?B(e.data):e.hasOwnProperty("message")&&Ep("vibebp").addNotification({text:e.message}))})}},500,[ne]);const me=e=>{let t=$?[...$]:[],a=[...J],s=t.indexOf(e);s>=0?(t.splice(s,1),a.unshift(e)):(t.push(e),a.splice(a.indexOf(e),1)),U(t),B(a)};return xp("div",{className:"course_admin_wrapper"},xp("div",{className:"course_admin"},xp("div",{className:"students_filter vibebp_form"},xp("div",{className:"vibebp_form_field"},xp("input",{type:"text",onChange:e=>{((e,t)=>{let a={...I,search_terms:e,paged:1};C(a)})(e.target.value)},placeholder:window.wplms_course_data.translations.search_student})),xp("select",{onChange:e=>{(e=>{let t={...I,order:e,paged:1};C(t)})(e.target.value)}},Object.keys(window.wplms_course_data.course.admin.student_orderby).map(e=>xp("option",{value:e},window.wplms_course_data.course.admin.student_orderby[e]))),xp("select",{onChange:e=>{(e=>{let t={...I,active_status:e,paged:1};C(t)})(e.target.value)}},Object.keys(window.wplms_course_data.course.admin.access).map(e=>xp("option",{value:e},window.wplms_course_data.course.admin.access[e]))),xp("select",{onChange:e=>{(e=>{let t={...I,course_status:e,paged:1};C(t)})(e.target.value)}},Object.keys(window.wplms_course_data.course.admin.status).map(e=>xp("option",{value:e},window.wplms_course_data.course.admin.status[e])))),d?xp(tl,null):null,g&&g.length?xp("div",{className:"course_students"},g.map(a=>xp("div",{className:ue(a.user_id)?"selected course_student":"course_student"},ue(a.user_id)?xp("div",{onClick:()=>de(a.user_id)},xp("i",{className:"vicon vicon-check-box"})):"",ue(a.user_id)?"":xp("div",{onClick:()=>de(a.user_id)},xp("i",{className:"vicon vicon-layout-width-full"})),xp(_p,{member:a,is_instructor:x,onReset:e=>(e=>{u(!0);let a={method:"POST",body:JSON.stringify({course_id:T,member_id:e,token:t.token})};fetch(s+"/instructor/courses/reset_course",a).then(e=>e.json()).then(e=>{if(u(!1),e)if(e.status){let t=[...g];t.findIndex(t=>t.user_id==e.data)>-1&&(t[t.findIndex(t=>t.user_id==e.data)].progress=0,y(t)),z(e.message),p(!0),e.hasOwnProperty("rtm")&&Ep("vibebp").sendRealTimeNotification(e.rtm.user_id,e.rtm.message)}else z(e.message),p(!0)})})(e),onRemove:e=>(e=>{u(!0);let a={method:"POST",body:JSON.stringify({course_id:T,member_id:e,token:t.token})};fetch(s+"/instructor/courses/remove_member",a).then(e=>e.json()).then(e=>{if(u(!1),e)if(e.status){if(e.data){let t=[...g];if(t.length){let a=t.findIndex(t=>e.data==t.user_id);a>=0&&(t.splice(a,1),y(t))}}e.hasOwnProperty("rtm")&&Ep("vibebp").sendRealTimeNotification(e.rtm.user_id,e.rtm.message),Ep("vibebp").addNotification({text:e.message})}else Ep("vibebp").addNotification({text:e.message})})})(e),onMemberActivity:t=>{return a=t,void e.update(a,"setactivityuser");var a},onCourseStats:e=>(e=>{u(!0);let a={method:"POST",body:JSON.stringify({course_id:T,user_id:e,token:t.token})};fetch(s+"/instructor/courses/get_course_user_stats",a).then(e=>e.json()).then(t=>{u(!1),t&&(t.status?t.data&&se({...t.data,id:e}):Ep("vibebp").addNotification({text:t.message}))})})(e)}),ae&&ae.hasOwnProperty("user_id")&&ae.user_id==a.user_id?ae.hasOwnProperty("curriculum")&&ae.curriculum.length?xp("div",{className:"user_course_stat"},ae.hasOwnProperty("curriculum")&&ae.curriculum.length?ae.curriculum.map((e,a)=>xp(Sp,null,"section"==e.type?xp(Sp,null,xp("div",{className:e.type},e.title?xp("span",{dangerouslySetInnerHTML:{__html:e.title}}):"")):xp("div",{className:e.type},xp("span",null,void 0!==e.icon?xp("span",{className:e.icon}):"",e.title?xp("span",{dangerouslySetInnerHTML:{__html:e.title}}):""),null!=typeof e.completed?1==e.completed?xp("span",{className:"completed"},e.hasOwnProperty("marks")?xp("span",null,window.wplms_course_data.translations.total_marks," ",e.marks,e.hasOwnProperty("max")?"/"+e.max:""):"",xp("span",{onClick:()=>((e,a)=>{u(!0);let n={method:"POST",body:JSON.stringify({course_id:T,user_id:ae.user_id,item_id:e,token:t.token})};fetch(s+"/instructor/courses/uncomplete_course_curriculum",n).then(e=>e.json()).then(e=>{if(u(!1),e)if(e.status){let t={...ae};t.curriculum[a].completed=!1,se(t),e.hasOwnProperty("rtm")&&Ep("vibebp").sendRealTimeNotification(e.rtm.user_id,e.rtm.message)}else Ep("vibebp").addNotification({text:e.message})})})(e.id,a),className:"vicon vicon-check-box"})):xp("span",{onClick:()=>((e,a)=>{u(!0);let n={method:"POST",body:JSON.stringify({course_id:T,user_id:ae.user_id,item_id:e,token:t.token})};fetch(s+"/instructor/courses/complete_course_curriculum",n).then(e=>e.json()).then(e=>{if(u(!1),e)if(e.status){let t={...ae};t.curriculum[a].completed=!0,se(t),e.hasOwnProperty("rtm")&&Ep("vibebp").sendRealTimeNotification(e.rtm.user_id,e.rtm.message)}else Ep("vibebp").addNotification({text:e.message})})})(e.id,a),className:"vicon vicon-timer"}):""))):""):xp("div",{className:"vbp_message"},window.wplms_course_data.translations.no):""))):xp("div",{className:"vbp_message"},window.wplms_course_data.translations.members_not_found),O?xp("a",{className:"link",expand:"block",fill:"outline",onClick:()=>(()=>{let e={...I,paged:I.paged+1};C(e),k(!0)})()},window.wplms_course_data.translations.load_more):"",d?"":xp("div",null,x?xp("div",{className:"bulk_action"},e.hasOwnProperty("permissions")&&e.permissions.hasOwnProperty("instructor_add_students")&&e.permissions.instructor_add_students||t.caps.hasOwnProperty("manage_options")?xp("span",{onClick:()=>H("add_student"),className:"add_student"==L?"tip active":"tip",title:window.wplms_course_data.translations.add_students_to_course}," ",xp("i",{className:"vicon vicon-user"})):"",e.hasOwnProperty("permissions")&&e.permissions.hasOwnProperty("instructor_assign_badges")&&e.permissions.instructor_assign_badges||t.caps.hasOwnProperty("manage_options")?xp("span",{onClick:()=>H("badge_certificate"),className:"badge_certificate"==L?"tip active":"tip",title:window.wplms_course_data.translations.assign_certificate}," ",xp("i",{className:"vicon vicon-key"})):"",e.hasOwnProperty("permissions")&&e.permissions.hasOwnProperty("instructor_extend_subscription")&&e.permissions.instructor_extend_subscription||t.caps.hasOwnProperty("manage_options")?xp("span",{onClick:()=>H("extend_subscription"),className:"extend_subscription"==L?"tip active":"tip",title:window.wplms_course_data.translations.extend_subscription}," ",xp("i",{className:"vicon vicon-shift-right"})):"",e.hasOwnProperty("permissions")&&e.permissions.hasOwnProperty("instructor_change_status")&&e.permissions.instructor_change_status||t.caps.hasOwnProperty("manage_options")?xp("span",{onClick:()=>H("change_status"),className:"change_status"==L?"tip active":"tip",title:window.wplms_course_data.translations.change_status}," ",xp("i",{className:"vicon vicon-panel"})):"",e.hasOwnProperty("permissions")&&e.permissions.hasOwnProperty("instructor_add_students")&&e.permissions.instructor_add_students||t.caps.hasOwnProperty("manage_options")?xp("span",{onClick:()=>H("bulk_message_students"),className:"bulk_message_students"==L?"tip active":"tip",title:window.wplms_course_data.translations.bulk_message_students}," ",xp("i",{className:"vicon vicon-email"})):"",e.hasOwnProperty("permissions")&&e.permissions.hasOwnProperty("instructor_add_students")&&e.permissions.instructor_add_students||t.caps.hasOwnProperty("manage_options")?xp("span",{onClick:()=>H("upload_csv_to_add_students"),className:"add_students_csv"==L?"tip active":"tip",title:window.wplms_course_data.translations.upload_csv_to_add_students}," ",xp("i",{className:"vicon vicon-export"})):"","badge_certificate"==L?xp("div",{className:"bulk_action_single"},xp(Sp,null,xp("label",null,window.wplms_course_data.translations.select_badge_certificate_assign),xp("select",{onChange:e=>{te(e.target.value)}},xp("option",{value:"add_badge"},window.wplms_course_data.translations.add_badge),xp("option",{value:"add_certificate"},window.wplms_course_data.translations.add_certificate),xp("option",{value:"remove_badge"},window.wplms_course_data.translations.remove_badge),xp("option",{value:"remove_certificate"},window.wplms_course_data.translations.remove_certificate))),xp("div",{className:"bulk_action_button"},xp("a",{className:A?"button is-primary is-loading":"button is-primary",onClick:()=>(()=>{if(M&&M.length&&ee){F(!0);let e={method:"POST",body:JSON.stringify({course_id:T,members:M,assign_action:ee,token:t.token})};fetch(s+"/instructor/courses/assign_badge_certificate",e).then(e=>e.json()).then(e=>{F(!1),e&&(e.status?(Ep("vibebp").addNotification({text:e.message}),e.hasOwnProperty("rtm")&&e.rtm.length&&e.rtm.map(e=>{Ep("vibebp").sendRealTimeNotification(e.user_id,e.message)})):Ep("vibebp").addNotification({text:e.message}))})}})()},window.wplms_course_data.translations.assign_badge_certificate),xp("a",{className:"link",onClick:()=>H(!1)},window.wplms_course_data.translations.cancel))):"change_status"==L?xp("div",{className:"bulk_action_single"},xp(Sp,null,xp("label",null,window.wplms_course_data.translations.select_course_status),xp("select",{onChange:e=>{K(e.target.value)}},window.wplms_course_data.course.admin.status.map((e,t)=>xp("option",{value:t},e)))),Q&&4==Q?xp("input",{type:"number",placeholder:window.wplms_course_data.translations.enter_marks,onChange:e=>{Z(e.target.value)}}):"",xp("div",{className:"bulk_action_button"},xp("a",{className:A?"button is-primary is-loading":"button is-primary",onClick:()=>(()=>{if(M&&M.length&&Q){F(!0);let e={method:"POST",body:JSON.stringify({course_id:T,members:M,status_action:Q,data:G,token:t.token})};fetch(s+"/instructor/courses/update_course_status",e).then(e=>e.json()).then(e=>{F(!1),e&&(e.status?(Ep("vibebp").addNotification({text:e.message}),e.hasOwnProperty("rtm")&&e.rtm.length&&e.rtm.map(e=>{Ep("vibebp").sendRealTimeNotification(e.user_id,e.message)})):Ep("vibebp").addNotification({text:e.message}))})}else Ep("vibebp").addNotification({text:window.wplms_course_data.translations.select_members})})()},window.wplms_course_data.translations.change_course_status),xp("a",{className:"link",onClick:()=>H(!1)},window.wplms_course_data.translations.cancel))):"extend_subscription"==L?xp("div",{className:"bulk_action_single"},xp(Sp,null,xp("label",null,window.wplms_course_data.translations.select_extend_subscription),xp("select",{onChange:e=>{W(e.target.value)}},window.wplms_create_course_data.duration.map(e=>xp("option",{value:e.value},e.label)))),xp("input",{type:"number",placeholder:"enter_time_amount",onChange:e=>{X(e.target.value)}}),xp("div",{className:"bulk_action_button"},xp("a",{className:A?"button is-primary is-loading":"button is-primary",onClick:()=>(()=>{if(M&&M.length&&V&&Y){F(!0);let e={method:"POST",body:JSON.stringify({course_id:T,members:M,course_duration_parameter_type:V,extend_amount:Y,token:t.token})};fetch(s+"/instructor/courses/extend_course_subscription",e).then(e=>e.json()).then(e=>{F(!1),e&&(e.status?(Ep("vibebp").addNotification({text:e.message}),e.hasOwnProperty("rtm")&&e.rtm.length&&e.rtm.map(e=>{Ep("vibebp").sendRealTimeNotification(e.user_id,e.message)})):Ep("vibebp").addNotification({text:e.message}))})}else Ep("vibebp").addNotification({text:window.wplms_course_data.translations.select_members})})()},window.wplms_course_data.translations.extend_subscription),xp("a",{className:"link",onClick:()=>H(!1)},window.wplms_course_data.translations.cancel))):"upload_csv_to_add_students"==L?xp("div",{className:"change_data_wrapper"},xp("div",{className:"change_data_content"},xp("div",{className:"heading_area"},xp("span",{className:"vicon vicon-close close",onClick:()=>{H(!1)}}),xp("h3",null,window.wplms_course_data.translations.upload_csv_to_add_students)),xp("div",{className:"upload_csv_area"},xp("input",{type:"file",id:"import_students",ref:a,type:"file",onChange:e=>{a.current.files[0].size<window.vibebp.settings.upload_limit?(c(a.current.files[0]),i(!0)):Ep("vibebp").addNotification({text:window.vibebp.translations.image_size_error})}}),xp("label",{for:"import_students"},l?l.name?l.name:window.wplms_course_data.translations.uploaded:window.wplms_course_data.translations.click_to_upload)),xp("div",{className:"upload_csv_actions"},xp("a",n?{className:o?"button is-primary is-loading":"button is-primary",onClick:()=>{r(!0);let e={token:zp("vibebp").getToken(),course_id:T};var t=new FormData;t.append("body",JSON.stringify(e)),t.append("file",l),fetch(window.wplms_course_data.api_url+"/instructor/import_students",{method:"post",body:t}).then(e=>e.json()).then(e=>{r(!1),e.status&&(H(!1),C({paged:1,order:"alphabetical",course_status:"",search_terms:"",per_page:per_page})),e.hasOwnProperty("message")&&Ep("vibebp").addNotification({text:e.message})})}}:{className:"button is-primary is-disabled"},window.wplms_course_data.translations.upload),xp("a",{className:"button is-primary",href:window.wplms_course_data.course.admin.sample_import_students_file,target:"_blank",download:"download"},window.wplms_course_data.translations.download_sample)))):"bulk_message_students"==L?xp("div",{className:"bulk_action_single"},xp("label",null,window.wplms_course_data.translations.bulk_message_students),xp("div",{className:"checkbox"},xp("input",{type:"checkbox",id:"all_students",checked:le.all,onClick:()=>ce({...le,all:!le.all})}),xp("label",{for:"all_students"},window.wplms_course_data.translations.all_students)),xp("input",{type:"text",placeholder:window.wplms_course_data.translations.message_subject,value:le.subject,onChange:e=>ce({...le,subject:e.target.value})}),xp("textarea",{value:le.message,placeholder:window.wplms_course_data.translations.message_content,onChange:e=>ce({...le,message:e.target.value})}),xp("div",{className:"bulk_action_button"},xp("a",{className:oe?"button is-primary is-loading":"button is-primary",onClick:()=>(()=>{if(M&&M.length||le.all){if(!(le.message.length>5&&le.subject.length>5))return void Ep("vibebp").addNotification({text:window.wplms_course_data.translations.message_length_error});re(!0);let e={method:"POST",body:JSON.stringify({course_id:T,members:M&&M.length?M:0,all:le.all?1:0,...le,token:t.token})};fetch(s+"/instructor/courses/send_bulk_message",e).then(e=>e.json()).then(e=>{re(!1),e&&(e.status?(Ep("vibebp").addNotification({text:e.message}),e.hasOwnProperty("rtm")&&e.rtm.length&&e.rtm.map(e=>{Ep("vibebp").sendRealTimeNotification(e.user_id,e.message)}),H(!1)):Ep("vibebp").addNotification({text:e.message}))})}else Ep("vibebp").addNotification({text:window.wplms_course_data.translations.select_members})})()},window.wplms_course_data.translations.send_message),xp("a",{className:"link",onClick:()=>H(!1)},window.wplms_course_data.translations.cancel))):""):""),"add_student"==L?xp("div",{className:"add_student"},xp("div",{className:"bulk_action_single vibebp_form"},$.length?xp("div",{className:"search_student_results selected_students"},$.map(e=>xp("div",{className:"search_student",onClick:()=>me(e)},xp("img",{className:"searched_image",width:"32",src:e.image}),xp("span",{className:"searched_nickname"},e.nickname)))):"",xp("div",{className:D?"control is-loading vibebp_form_field":"control vibebp_form_field"},xp("input",{type:"text",placeholder:window.wplms_course_data.translations.search_student_to_add,onChange:e=>{ie(e.target.value)}})),J&&J.length?xp("div",{className:"search_student_results"},J.map(e=>xp("div",{className:"search_student",onClick:()=>me(e)},xp("img",{className:"searched_image",width:"32",src:e.image}),xp("span",{className:"searched_nickname"},e.nickname)))):"",xp("div",{className:"bulk_action_button"},xp("a",{className:A?"button is-primary is-loading":"button is-primary",expand:"block",fill:"outline",onClick:()=>(()=>{if($&&$.length){F(!0);let e={method:"POST",body:JSON.stringify({course_id:T,members:$.map(e=>e.user_id),token:t.token})};fetch(s+"/instructor/courses/add_members",e).then(e=>e.json()).then(e=>{if(F(!1),e)if(e.status){if(j([]),B([]),U([]),e.data&&Array.isArray(e.data)&&e.data.length){let t=[...g];e.data.map(e=>{t.push(e)}),y(t)}e.hasOwnProperty("rtm")&&e.rtm.length&&e.rtm.map(e=>{Ep("vibebp").sendRealTimeNotification(e.user_id,e.message)}),Ep("vibebp").addNotification({text:e.message})}else Ep("vibebp").addNotification({text:e.message})})}})()},window.wplms_course_data.translations.add_students_to_course),xp("a",{className:"link",onClick:()=>H(!1)},window.wplms_course_data.translations.cancel)))):""))};const{createElement:Mp,render:jp,useState:Lp,useEffect:Hp,useContext:Ap,Fragment:Fp,RawHTML:Dp}=wp.element,{dispatch:Rp,select:Jp}=wp.data;var Bp=e=>{const[t,a]=Lp(e.note),[s,n]=Lp(!1),[i,o]=Lp(!1);return Mp("div",{className:"comment_wrapper"},Mp("span",null,t.course?t.course.title:""),Mp("h3",{className:"unit_title"},Mp("span",null,t.unit.icon.length>100?Mp("span",{dangerouslySetInnerHTML:{__html:t.unit.icon}}):Mp("span",{className:t.unit.icon}),Mp("strong",{dangerouslySetInnerHTML:{__html:t.unit.title}})),Mp("span",null,s?Mp("span",{className:"vicon vicon-close",onClick:()=>n(!1)}):Mp(Fp,null,Mp("span",{className:"vicon vicon-pencil-alt",onClick:()=>n(!0)}),Mp("span",{className:"vicon vicon-trash",onClick:()=>{fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${t.unit.id}/edit/${t.id}`,{method:"post",body:JSON.stringify({...t,token:Jp("vibebp").getToken()})}).then(e=>e.json()).then(t=>{e.remove()})}})))),Mp("div",{className:"comments_comment_content"},Mp(Ct,{timestamp:t.comment_date}),s?Mp("textarea",{value:t.comment_content,onChange:e=>a({...t,comment_content:e.target.value})}):Mp("div",{dangerouslySetInnerHTML:{__html:t.comment_content}}),s?Mp("div",{className:"comment_actions"},Mp("a",{className:i?"button is-primary is-loading":"button is-primary",onClick:()=>{o(!0),fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${t.unit.id}/edit/${t.id}`,{method:"post",body:JSON.stringify({...t,token:Jp("vibebp").getToken()})}).then(e=>e.json()).then(e=>{o(!1),e.hasOwnProperty("message")&&Rp("vibebp").addNotification({text:e.message})})}},window.wplms_course_data.translations.edit),Mp("a",{className:"link",onClick:()=>n(!1)},window.wplms_course_data.translations.cancel)):""))};const{createElement:$p,useState:Up,useEffect:Vp,Fragment:Wp,render:Yp}=wp.element,{dispatch:Xp,select:Qp}=wp.data;var Kp=e=>{const[t,a]=Up("");return Vp(()=>{let t="",s="";switch(e.type){case"friends":s="user",t=e.id.item_id;break;case"group":s="group",t=e.id.item_id;break;case"activity":s="user",t=e.id.secondary_item_id;break;case"member":case"name":case"user_tip":case"user":s="user",t=e.id.user_id;break;default:s=e.type,t=e.id.item_id}localforage.getItem(s+"_"+t).then(t=>{null!==t?a(JSON.parse(t)):fetch(window.vibebp.api.url+"/avatar",{method:"post",body:JSON.stringify({type:e.type,ids:e.id,token:Qp("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.status&&(localforage.setItem(e.key,JSON.stringify(e.value)),a(e.value))})})},[]),"member"==e.type?$p("span",{className:"vibebp_member"},$p("img",{src:t.avatar,className:"vibebp_avatar",onClick:e.click,alt:t.name,title:t.name}),$p("span",null,t.name)):"user_tip"==e.type?$p("span",{className:"vibebp_member tip",title:t.name},$p("img",{src:t.avatar,className:"vibebp_avatar",onClick:e.click,alt:t.name,title:t.name})):"name"==e.type?$p("span",null,t.name):$p("img",{src:t.avatar,className:"vibebp_avatar",onClick:e.click,alt:t.name,title:t.name})};const{createElement:Gp,render:Zp,useState:e_,useEffect:t_,useContext:a_,Fragment:s_,RawHTML:n_}=wp.element,{dispatch:i_,select:o_}=wp.data;var r_=e=>{const[t,a]=e_(e.discussion),[s,n]=e_(!1),[i,o]=e_(!1);return Gp("div",{className:"comment_wrapper"},Gp("span",null,t.course?t.course.title:""),Gp("h3",{className:"unit_title"},Gp("span",null,t.unit.icon.length>100?Gp("span",{dangerouslySetInnerHTML:{__html:t.unit.icon}}):Gp("span",{className:t.unit.icon}),Gp("strong",{dangerouslySetInnerHTML:{__html:t.unit.title}})),Gp("span",null,s?Gp("span",{className:"vicon vicon-close",onClick:()=>n(!1)}):Gp(s_,null,Gp("span",{className:"vicon vicon-pencil-alt",onClick:()=>n(!0)}),Gp("span",{className:"vicon vicon-trash",onClick:()=>{fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${t.unit.id}/edit/${t.id}`,{method:"post",body:JSON.stringify({...t,token:o_("vibebp").getToken()})}).then(e=>e.json()).then(t=>{e.remove()})}})))),Gp("div",{className:"comments_parent"},Gp("div",{className:"comments_comment"},Gp(Kp,{id:{user_id:t.user_id},type:"user"}),Gp("div",{className:"comments_comment_content"},Gp(Ct,{timestamp:t.comment_date}),s?Gp("textarea",{value:t.comment_content,onChange:e=>a({...t,comment_content:e.target.value})}):Gp("div",{dangerouslySetInnerHTML:{__html:t.comment_content}}),s?Gp("div",{className:"comment_actions"},Gp("a",{className:i?"button is-primary is-loading":"button is-primary",onClick:()=>{o(!0),fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${t.unit.id}/edit/${t.id}`,{method:"post",body:JSON.stringify({...t,token:o_("vibebp").getToken()})}).then(e=>e.json()).then(e=>{o(!1),e.hasOwnProperty("message")&&i_("vibebp").addNotification({text:e.message})})}},window.wplms_course_data.translations.edit),Gp("a",{className:"link",onClick:()=>n(!1)},window.wplms_course_data.translations.cancel)):"")),t.hasOwnProperty("chain")?Gp("div",{className:"comments_children"},t.chain.map(e=>Gp("div",{className:"comments_comment"},Gp(Kp,{id:{user_id:e.user_id},type:"user"}),Gp("div",{className:"comments_comment_content"},Gp(Ct,{timestamp:e.comment_date}),Gp("div",{dangerouslySetInnerHTML:{__html:e.comment_content}}))))):""))};const{createElement:l_,render:c_,useState:d_,useEffect:u_,useContext:m_,Fragment:p_,RawHTML:__}=wp.element;var v_=e=>{const[t,a]=d_([]),[s,n]=d_(()=>{let t=e.maxstars?e.maxstars-1:4,a=[];for(;t>=0;)a.unshift(t),t--;return a});u_(()=>{let t=e.rating?e.rating-1:-1,s=[];for(;t>=0;)s.unshift(t),t--;a(s)},[e.rating]);return t&&t.length>=0?l_("div",{className:"wplms-course-star-rating"},s.map((s,n)=>{let i=0;return t.includes(n)&&(i=1),l_("span",{className:"vicon vicon-star "+(i?"golden":""),onClick:t=>{(t=>{let s=[];for(;t>=0;)s.unshift(t),t--;a(s),e.update(s,"ratingchanged")})(n)}})})):""};const{createElement:h_,render:w_,useState:f_,useEffect:g_,useContext:y_,Fragment:b_,RawHTML:k_}=wp.element,{dispatch:x_,select:N_}=wp.data;var I_=e=>{const[t,a]=f_(e.review),[s,n]=f_(!1),[i,o]=f_(!1);return h_("div",{className:"comment_wrapper"},h_("span",null,h_("span",null,t.course?t.course.title:""),h_("span",null,h_("span",i?{className:"vicon vicon-close",onClick:()=>o(!1)}:{className:"vicon vicon-pencil-alt",onClick:()=>o(!0)}))),h_("div",{className:"review_main"},h_("div",{className:"comments_comment"},h_(Kp,{id:{user_id:t.user_id},type:"user"}),h_("div",{className:"comments_comment_content"},i?h_(b_,null,h_("input",{type:"text",value:t.review_title,onChange:e=>{a({...t,review_title:e.target.value})}}),h_("span",null,h_("span",null,h_(v_,{rating:t.review_rating,maxstars:"5",update:(e,s)=>{if("ratingchanged"==s){let s=0;e&&(s=e.length),a({...t,review_rating:s})}}}),t.review_rating),h_(Ct,{timestamp:t.comment_date})),h_("textarea",{value:t.comment_content,onChange:e=>{a({...t,comment_content:e.target.value})}})):h_(b_,null,h_("h3",{className:"creview_title"},t.review_title),h_("span",null,h_("span",null,h_(v_,{rating:t.review_rating,maxstars:"5"}),t.review_rating),h_(Ct,{timestamp:t.comment_date})),h_("div",{dangerouslySetInnerHTML:{__html:t.comment_content}})),i?h_("div",{className:"comment_actions"},h_("a",{className:s?"button is-primary is-loading":"button is-primary",onClick:()=>{n(!0),fetch(window.wplms_course_data.api_url+"/updatecourse/addreview",{method:"post",body:JSON.stringify({review:t.comment_content,title:t.review_title,rating:t.review_rating,course_id:t.course.id,token:N_("vibebp").getToken()})}).then(e=>e.json()).then(e=>{n(!1),e.hasOwnProperty("message")&&x_("vibebp").addNotification({text:e.message}),o(!1)})}},window.wplms_course_data.translations.edit),h_("a",{className:"link",onClick:()=>o(!1)},window.wplms_course_data.translations.cancel)):"")),t.hasOwnProperty("chain")?h_("div",{className:"discussion_children"},t.chain.map(e=>h_("div",{className:"comments_comment"},h_(Kp,{id:{user_id:e.user_id},type:"user"}),h_("div",{className:"comments_comment_content"},h_(Ct,{timestamp:e.comment_date}),h_("div",{dangerouslySetInnerHTML:{__html:e.comment_content}}))))):""))};const{createElement:C_,render:O_,useState:S_,useEffect:q_,useContext:P_,Fragment:E_,RawHTML:z_}=wp.element,{dispatch:T_,select:M_}=wp.data;var j_=e=>{const[t,a]=S_(!1),[s,n]=S_({type:window.wplms_course_data.notes.tabs[0].key,s:"",page:1,orderby:"",order:"",post_author:"",type:"notes",user_id:""}),[i,o]=S_(!1),[r,l]=S_(!1),[c,d]=S_(!1),[u,m]=S_(""),[p,v]=S_(null);q_(()=>{let t={...s};e.hasOwnProperty("tabs")&&(t.type=e.tabs[0]),e.hasOwnProperty("course")&&("object"==typeof e.course?t.course=e.course.id:t.course=e.course),t.user_id=M_("vibebp").getUser().id,n(t)},[]),_(()=>{a(!0),p&&p.abort();let e={},t=new AbortController;p&&(e={signal:t.signal}),v(t);let n={...s};"notes"==n.type?n.type="notes":"discussions"==n.type?n.type="discussions":"reviews"==n.type?(n.type="reviews",n.fetch_meta=["review_title","review_rating"]):n.type="public",fetch(window.wplms_course_data.api_url+"/student/comments",{method:"post",...e,body:JSON.stringify({...n,token:M_("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(v(null),l(!1),e.status)if(i){let t=[...notes,e.comments];t.length<e.total?l(!0):l(!1),d(t),o(!1)}else d([]),e.comments.length<e.total?l(!0):l(!1),d(e.comments);else d([]),e.hasOwnProperty("message")&&m(e.message);a(!1)}).catch(e=>{"AbortError"===e.name?console.log("Fetch aborted"):console.error("Uh oh, an error!",e)})},500,[s]);return C_("div",{className:"all_comments_wrapper"},C_("div",{className:"mycourses_header vibebp_form"},e.hasOwnProperty("tabs")?"":C_("div",{className:"header_tabs"},window.wplms_course_data.notes.tabs.map(t=>{if(!e.hasOwnProperty("tabs")||e.tabs.indexOf(t))return t.key==s.type?C_("a",{className:"button is-primary"},t.label):C_("a",{className:"link",onClick:()=>{n({...s,type:t.key}),d([])}},t.label)})),C_("div",{className:"flex2"},C_("div",{className:"control vibebp_form_field"},C_("input",{type:"text",placeholder:window.wplms_course_data.translations.search,value:s.s,onChange:e=>{n({...s,s:e.target.value})}}),C_("span",{className:"vicon vicon-search"})),C_("span",null,C_("select",{value:s.orderby},Object.keys(window.wplms_course_data.notes.orderby).map(e=>C_("option",{value:e},window.wplms_course_data.notes.orderby[e]))),C_("span",null,C_("span",{className:"DESC"==s.order?"active vicon vicon-angle-down":"vicon vicon-angle-down",onClick:()=>n({...s,order:"DESC"})}),C_("span",{className:"ASC"==s.order?"active vicon vicon-angle-up":"vicon vicon-angle-up",onClick:()=>n({...s,order:"ASC"})}))))),C_("div",{className:"comments_wrapper"},t?C_(tl,null):c.length?c.map((e,t)=>{switch(s.type){case"notes":return C_(Bp,{note:e,update:e=>updateComment(t,e),remove:()=>{let e=[...c];e.splice(t,1),d(e)}});case"discussions":return C_(r_,{discussion:e,update:e=>updateComment(t,e),remove:()=>{let e=[...c];e.splice(t,1),d(e)}});case"reviews":return C_(I_,{review:e,update:e=>updateComment(t,e),remove:()=>{let e=[...c];e.splice(t,1),d(e)}})}}):u.length?C_("div",{className:"vbp_message"},u):""))};const{createElement:L_,render:H_,useState:A_,useEffect:F_,useContext:D_,Fragment:R_,RawHTML:J_}=wp.element,{dispatch:B_,select:$_}=wp.data;var U_=e=>{const[t,a]=A_(e.question),[s,n]=A_(!1),[i,o]=A_(!1);F_(()=>{a(e.question)},[e.question]);return L_("div",{className:"comment_wrapper"},L_("h3",null,L_("span",null,L_("span",{className:t.unit.icon}),t.unit.title)," ",L_("span",null,t.course.title)),L_("div",{className:"question_main"},L_("div",{className:"comments_comment"},L_(Kp,{id:{user_id:t.user_id},type:"user"}),L_("div",{className:"comments_comment_content"},L_("span",null,L_(Ct,{timestamp:t.comment_date})),L_("div",{dangerouslySetInnerHTML:{__html:t.comment_content}}))),t.hasOwnProperty("chain")?L_("div",{className:"discussion_children"},t.chain.map(e=>L_("div",{className:"comments_comment"},L_(Kp,{id:{user_id:e.user_id},type:"user"}),L_("div",{className:"comments_comment_content"},L_(Ct,{timestamp:e.comment_date}),L_("div",{dangerouslySetInnerHTML:{__html:e.comment_content}})),e.user_id==$_("vibebp").getUser().id?L_("span",{className:"vicon vicon-pencil",onClick:()=>n({id:e.id,ctype:"edit",comment_content:e.comment_content,comment_author:$_("vibebp").getUser().id,comment_post_ID:t.unit.id,comment_parent:t.id})}):""))):"",L_("div",{className:"comments_actions"},s?L_("div",{className:"add_answer"},L_(Ds,{field:{id:"comment_"+s.id,value:s.comment_content},update:(e,t,a)=>{n({...s,comment_content:e.value})}}),L_("div",{className:"answer_actions"},L_("a",{className:i?"button is-primary -is-loading":"button is-primary",onClick:()=>{if(!(s.comment_content&&s.comment_content.length>3))return B_("vibebp").addNotification({text:window.wplms_course_data.translations.add_more_content}),!1;{s.comment_post_ID||(s.comment_post_ID=e.question.unit.id);let i={...t};switch(s.ctype){case"new":i.chain.push(s),fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${e.question.unit.id}/new/0`,{method:"post",body:JSON.stringify({...s,token:$_("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e&&(e.comment_data?a(i):B_("vibebp").addNotification({text:e.message}))});break;case"edit":if(!s.comment_content||s.comment_content.length<4)return void B_("vibebp").addNotification({text:window.wplms_course_data.translations.add_more_content});o(!0),i.chain.splice(i.chain.findIndex(e=>e.comment_ID==s.comment_ID),1,s);s.comment_content;fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${e.question.unit.id}/edit/${comment_id}`,{method:"post",body:JSON.stringify({...s,token:$_("vibebp").getToken()})}).then(e=>e.json()).then(e=>{o(!1),e&&(e.comment_data?a(i):B_("vibebp").addNotification({text:window.wplms_course_data.translations.error}))});break;case"reply":if(o("reply"),!s.comment_content||s.comment_content.length<4)return void B_("vibebp").addNotification({text:window.wplms_course_data.translations.add_more_content});i.chain.push(s),fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${e.question.unit.id}/reply/${s.comment_parent}`,{method:"post",body:JSON.stringify({...s,token:$_("vibebp").getToken()})}).then(e=>e.json()).then(e=>{o(!1),e&&(e.comment_data?a(i):B_("vibebp").addNotification({text:window.wplms_course_data.translations.error}))})}n(!1)}}},window.wplms_course_data.translations.answer_question),L_("a",{className:"link",onClick:()=>n(!1)},window.wplms_course_data.translations.cancel))):$_("vibebp").getUser().id==t.user_id||$_("vibebp").getUser().caps.hasOwnProperty("edit_posts")?L_(R_,null,L_("a",{className:i&&"reply"==i?"button is-primary is-loading":"button is-primary",onClick:()=>n({id:0,ctype:"reply",comment_content:"",comment_author:$_("vibebp").getUser().id,comment_post_ID:t.unit.id,comment_parent:t.id})},window.wplms_course_data.translations.answer),"pending"==e.args.type?L_("a",{className:i&&"answered"==i?"button is-link is-loading":"button is-link",onClick:()=>{o("answered"),fetch(window.wplms_course_data.api_url+"/instructor/mark_question_answered",{method:"post",body:JSON.stringify({id:t.id,token:$_("vibebp").getToken()})}).then(e=>e.json()).then(a=>{o(!1),a&&a.status&&e.update(t.id,"answered")})}},window.wplms_course_data.translations.mark_answered):""):L_("a",{className:"button is-primary",onClick:()=>n({id:0,ctype:"reply",comment_content:"",comment_author:$_("vibebp").getUser().id,comment_post_ID:t.unit.id,comment_parent:t.id})},window.wplms_course_data.translations.reply))))};const{createElement:V_,render:W_,useState:Y_,useEffect:X_,useContext:Q_,Fragment:K_,RawHTML:G_}=wp.element,{dispatch:Z_,select:ev}=wp.data;var tv=e=>{const[t,a]=Y_(!1),[s,n]=Y_({type:window.wplms_course_data.qna.tabs[0].key,s:"",page:1,orderby:"",order:""}),[i,o]=Y_(!1),[r,l]=Y_(!1),[c,d]=Y_(!1),[u,m]=Y_(""),[p,v]=Y_({}),[h,w]=Y_(null);_(()=>{a(!0),h&&h.abort();let t={},n=new AbortController;h&&(t={signal:n.signal}),w(n),e.hasOwnProperty("course")&&("object"==typeof e.course?s.course=e.course.id:s.course=e.course),fetch(window.wplms_course_data.api_url+"/instructor/comments",{method:"post",...t,body:JSON.stringify({...s,token:ev("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(a(!1),w(null),l(!1),e.status)if(i){let t=[...c,e.comments];t.length<e.total?l(!0):l(!1),d(t),o(!1)}else e.comments.length<e.total?l(!0):l(!1),d(e.comments);else d([]),e.hasOwnProperty("message")&&m(e.message)}).catch(e=>{"AbortError"===e.name?a(!0):console.error("Uh oh, an error!",e)})},500,[s,e.course]);const f=(e,t)=>{if("answered"==t){let t=[...c],a=t.findIndex(t=>t.id==e);a>-1&&(t.splice(a,1),d(t))}};return V_("div",{className:"questionanswers_wrapper"},V_("div",{className:"mycourses_header vibebp_form"},V_("div",{className:"header_tabs"},window.wplms_course_data.qna.tabs.map(e=>e.key==s.type?V_("a",{className:"button is-primary"},e.label):V_("a",{className:"link",onClick:()=>{n({...s,type:e.key}),d([])}},e.label))),V_("div",null,V_("div",{className:"control vibebp_form_field"},V_("input",{type:"text",placeholder:window.wplms_course_data.translations.search,value:s.s,onChange:e=>{n({...s,s:e.target.value})}}),V_("span",{className:"vicon vicon-search"})),V_("span",null,V_("select",{value:s.orderby},Object.keys(window.wplms_course_data.qna.orderby).map(e=>V_("option",{value:e},window.wplms_course_data.notes.orderby[e]))),V_("span",null,V_("span",{className:"DESC"==s.order?"active vicon vicon-angle-down":"vicon vicon-angle-down",onClick:()=>n({...s,order:"DESC"})}),V_("span",{className:"ASC"==s.order?"active vicon vicon-angle-up":"vicon vicon-angle-up",onClick:()=>n({...s,order:"ASC"})}))))),V_("div",{className:"questions_answers"},t?V_(tl,null):V_("div",{className:"comments_wrapper"},c.length?c.map(e=>V_(U_,{question:e,update:f,args:s})):u.length?V_("div",{className:"vbp_message"},u):"")))};const{createElement:av,render:sv,useState:nv,useEffect:iv,Fragment:ov,useContext:rv}=wp.element,{dispatch:lv,select:cv}=wp.data;var dv=e=>{const[t,a]=nv(!1),[s,n]=nv([]),[i,o]=nv([]),[r,l]=nv(!1),[c,d]=nv(!1),[u,m]=nv("media"),[p,v]=nv(()=>{let t={posts_per_page:20,paged:1,search_terms:"",orderby:""};if(e.hasOwnProperty("type")&&void 0!==e.type){let a=e.type;!1!==e.type.indexOf(",")&&(a=e.type.split(",")),t.post_mime_type=a}return t});_(()=>{a(!0),fetch(window.vibebp.api.url+"/user/fetch_media",{method:"post",body:JSON.stringify({...p,token:cv("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(a(!1),e.status)if(c){let t=[...s];e.data.map(e=>{t.push(e)}),n(t),d(!1),t.length<parseInt(e.total)?l(!0):l(!1)}else n(e.data),e.data.length<parseInt(e.total)?l(!0):l(!1)})},500,[p]);const h=t=>{e.share(t)},w=e=>{switch(e.type){case"image":return av("img",{src:e.url,className:"content_to_html_image"});case"video":return av("div",{className:"video_wrapper"},av("video",{className:"content_to_html_video",ref:e=>{e&&new Plyr(e)}},av("source",{src:e.url,type:"video/mp4"})));case"audio":return av("div",{className:"video_wrapper"},av("audio",{className:"content_to_html_audio audio",ref:e=>{e&&new Plyr(e)}},av("source",{src:e.url,type:"audio/mp3"})))}};return av("div",{className:"vibe_editor_modal"},av("div",{className:"ve_modal-content"},av("div",{className:"ve_modal-header"},av("div",null,av("a",{className:"media"==u?"active":"",onClick:()=>{"media"!=u&&m("media")}},window.vibebp.translations.select_media),av("a",{className:"upload"==u?"active":"",onClick:()=>{"upload"!=u&&m("upload")}},window.vibebp.translations.upload_media)),av("span",{className:"vicon vicon-close",onClick:t=>{e.close(!1)}})),av("div",{className:"ve_modal-body"},"media"==u?av(ov,null,av("div",{className:"vibebp_form"},av("div",{className:"vibebp_form_field"},av("input",{type:"text",placeholder:window.vibebp.translations.search_text,onChange:e=>v({...p,search_terms:e.target.value})})),av("div",{className:"vibebp_form_field"},av("select",{onChange:e=>{v({...p,order:e.target.value})}},Object.keys(window.vibeEditor.media_order).map(e=>av("option",{value:e},window.vibeEditor.media_order[e]))))),t?av("div",{className:"loading-roller"},av("div",null),av("div",null),av("div",null),av("div",null),av("div",null),av("div",null),av("div",null),av("div",null)):s&&s.length?av("div",{className:"allMedia"},s.map((t,a)=>av("div",{className:"single_media",onClick:a=>{h(t),e.close(!1)}},w(t)))):av("div",{className:"vbp_message"},window.vibebp.translations.no_media),r?av("a",{className:"link",onClick:()=>{v({...p,paged:p.paged+1}),d(!0)}},window.vibebp.translations.more):""):"upload"===u?av(ov,null,av("div",{className:"upload_media"},av("label",{for:"vibe_editor_upload_media"},window.vibebp.translations.upload_media),av("input",{type:"file",id:"vibe_editor_upload_media",onChange:e=>(e=>{if(e.target.files[0]){let t=new FormData;t.append("file",e.target.files[0]),t.append("body",JSON.stringify({token:cv("vibebp").getToken()})),fetch(window.vibebp.api.url+"/user/upload_media",{method:"post",body:t}).then(e=>e.json()).then(e=>{if(e.status){let t=[...s];t.unshift(e.data),n(t),m("media")}else e.hasOwnProperty("message")&&lv("vibebp").addNotification({text:e.message})})}})(e)}),i&&i.length?av("div",{className:"uploaded"},av("strong",null,window.vibebp.translations.uploaded_media),av("div",{className:"uploaded_files"},i.map((e,t)=>av("div",{className:"single_media",onClick:t=>{h(e)}},w(e))))):"")):"")))};const{createElement:uv,render:mv,useState:pv,useEffect:_v,Fragment:vv,useContext:hv,useRef:wv}=wp.element,{dispatch:fv,select:gv}=wp.data;var yv=e=>{const[t,a]=pv(!1),[s,n]=pv({}),[i,o]=pv(!1),[r,l]=pv(!1),[c,d]=pv([]),[u,m]=pv(null),[p,_]=pv(null);_v(()=>{e.hasOwnProperty("media")&&(e.field.value=e.media),e.field.hasOwnProperty("type")&&n(e.field)},[e.field]);_v(()=>{if(s.hasOwnProperty("value")&&s.value&&s.value.hasOwnProperty("type")){if("audio"==s.value.type||"video"==s.value.type){let e=new Plyr(ref);_(e)}if("youtube"==s.value.type){let e=new Plyr(u);_(e)}if("vimeo"==s.value.type){let e=new Plyr(u);_(e)}return()=>{p&&p.destroy()}}},[u,s]);return uv("div",{className:"media_wrapper"},uv("div",{className:"vicon vicon-plus",onClick:()=>{a(!0)}}),t?uv(dv,{type:e.type,close:()=>{a(!1)},share:t=>{(t=>{let a={...s};a.value=t,n(a),e.update(a,e.fieldIndex,"fieldvaluechanged")})(t)}}):"")};const{createElement:bv,render:kv,useState:xv,useEffect:Nv,useContext:Iv,Fragment:Cv,RawHTML:Ov}=wp.element,{dispatch:Sv,select:qv}=wp.data;var Pv=e=>{qv("vibebp").getUser();const t=qv("vibebp").getToken(),[a,s]=xv([]),[n,i]=xv({}),[o,r]=xv(!1),[l,c]=xv(""),[d,u]=xv([]),[m,p]=xv(!0),[_,v]=xv(!1),[h,w]=xv([]),[f,g]=xv(0),[y,b]=xv(0),[k,x]=xv(!1),[N,I]=xv(!1),[C,O]=xv(-1);Nv(()=>{s(e.statuses),u([]),w([]),p(!1),i({type:e.type,parentId:e.hasOwnProperty("parentId")?e.parentId:0,id:e.id,status:e.statuses[0].value,paged:1,orderby:"meta_id",order:"DESC"}),p(!0)},[e.id,e.type]),Nv(()=>{n.hasOwnProperty("type")&&("course"==n.type||n.id)&&(r(!0),w([]),fetch(window.wplms_course_data.api_url+"/instructor/getSubmissions",{method:"POST",body:JSON.stringify({...n,token:t})}).then(e=>e.json()).then(e=>{if(r(!1),e.status)if(_){let t=[...d,...e.data];t.length<e.total?p(!0):p(!1),u(t),v(!1)}else u(e.data),e.data.length<e.total?p(!0):p(!1);else u([]),c(e.message),p(!1)}))},[n]);return bv("div",{className:"course_submissions_wrapper"},n.hasOwnProperty("type")&&e.id?bv("div",{className:"mycourses_header"},bv("div",{className:"mycourses_access_tabs"},a.map((e,t)=>bv("a",{value:e.value,className:n.status==e.value?"button is-primary":"link",onClick:t=>{i({...n,status:e.value})}},e.label," "))),"assignment"!==e.type?bv("div",null,bv("div",{class:"vibebp_form_field"},bv("input",{type:"text",value:n.s,onChange:e=>{i({...n,s:e.target.value})},placeholder:window.wplms_course_data.translations.search_student}),bv("span",{className:"vicon vicon-search"})),bv("div",null,bv("select",{value:n.orderby,onChange:e=>{i({...n,orderby:e.target.value})}},Object.keys(window.wplms_course_data.course.admin.submission_orderby).map(e=>bv("option",{value:e},window.wplms_course_data.course.admin.submission_orderby[e]))),bv("span",null,bv("span",{className:"ASC"==n.order?"vicon vicon-angle-up active":"vicon vicon-angle-up",onClick:()=>{i({...n,order:"ASC"})}}),bv("span",{className:"DESC"==n.order?"vicon vicon-angle-down active":"vicon vicon-angle-down",onClick:()=>{i({...n,order:"DESC"})}})))):""):"",o?bv(tl,null):h.hasOwnProperty("questions")&&"quiz"==n.type?bv("div",{className:"question_list"},bv("span",{className:"vicon vicon-arrow-left",onClick:()=>w([])}),bv("h3",null,window.wplms_course_data.translations.submission_by," ",f.nickname),h.hasOwnProperty("questions")&&h.questions.length?bv(Cv,null,h.questions.map((e,t)=>bv("div",{className:"question_container"},bv(Cv,null,bv("div",{className:"question"},bv("div",{className:"question_content",dangerouslySetInnerHTML:{__html:e.content?e.content:""}}),e.marked_answer?bv("div",{className:"marked_answer"},bv("span",null,window.wplms_course_data.translations.marked_answer),bv("div",{className:"marked_asnwer",dangerouslySetInnerHTML:{__html:e.marked_answer?e.marked_answer:""}})):"",e.correct_answer?bv("div",{className:"question_correct_answer"},bv("span",null,window.wplms_course_data.translations.correct_answer),bv("div",{className:"correct_answer",dangerouslySetInnerHTML:{__html:e.correct_answer?e.correct_answer:""}})):"",e.explaination?bv("div",{className:"question_explanation"},bv("span",null,window.wplms_course_data.translations.question_explanation),bv("div",{dangerouslySetInnerHTML:{__html:e.explaination?e.explaination:""}})):""),bv("div",{className:"question_score"},bv("span",null,bv("span",null,window.wplms_course_data.translations.total_marks),bv("span",{dangerouslySetInnerHTML:{__html:e.max_marks?e.max_marks:0}})),bv("input",{type:"number",placeholder:e.marks?e.marks:0,onChange:a=>{if(a.target.value<=parseInt(e.max_marks)){let e={...h};e.questions[t].marks=a.target.value,w(e);let s=0;e.questions.map(e=>{s+=parseInt(e.marks)}),b(s)}},value:h.questions[t].marks}))))),bv("div",{className:"total_marks"},bv("span",null,window.wplms_course_data.translations.total_marks),bv("span",null,y," ",bv("span",{className:k?"vicon vicon-close":"vicon vicon-pencil",onClick:()=>x(!k)}))),bv("div",{className:"remarks_wrapper"},bv("div",null),bv("div",{className:"remarks"},k?bv("input",{type:"number",placeholder:y,onChange:e=>{w({...h,user_marks:e.target.value}),b(e.target.value)}}):"",bv("span",null,window.wplms_course_data.translations.instructor_remarks),bv("textarea",{onChange:e=>{w({...h,instructor_remarks:e.target.value})}},h.instructor_remarks),bv("a",{className:N?"button is-primary is-loading":"button is-primary",fill:"outline",onClick:()=>(()=>{I(!0);h.user_marks&&h.user_marks;let e=h.activity_id?h.activity_id:"no_activity",a=h.instructor_remarks?h.instructor_remarks:"";if(f){let s={method:"POST",body:JSON.stringify({course_id:n.parentId,quiz_id:n.id,user_id:f.user_id,user_marks:y,instructor_remarks:a,activity:e,token:t,questions:h.questions})};fetch(window.wplms_course_data.api_url+"/instructor/courses/update_user_marks_remarks",s).then(e=>e.json()).then(e=>{if(e){if(e.status){w([]);let t=[...d];t.splice(d.findIndex(e=>e.user_id==f.user_id),1),u(t),g(!1),Sv("vibebp").addNotification({text:e.message})}else Sv("vibebp").addNotification({text:e.message});I(!1)}})}})()},window.wplms_course_data.translations.update_submission)))):""):h.hasOwnProperty("curriculum_data")&&"course"==n.type?bv("div",{className:"course_structure"},h.curriculum_data.length?bv(Cv,null,bv("span",{className:"vicon vicon-arrow-left",onClick:()=>w([])}),bv("h3",null,window.wplms_course_data.translations.submission_by," ",f.nickname),h.curriculum_data.map(e=>bv("div",{className:"curriculum_item"},"unit"==e.type?bv(Cv,null,bv("span",null,bv("span",{className:e.icon})," ",e.title?e.title:""),bv("span",null,bv("span",{className:e.status?"vicon vicon-check-box":"vicon vicon-check"}))):"","quiz"==e.type?bv(Cv,null,bv("span",null,bv("span",{className:e.icon})," ",e.title?e.title:""),bv("span",null,bv("span",null,bv("span",null,e.marks?e.marks:"0"),"/",bv("span",null,e.max?e.max:"0")),bv("span",{className:e.status?"vicon vicon-check-box":"vicon vicon-check"}))):""))):"",bv("div",{className:"total_marks"},bv("span",null,window.wplms_course_data.translations.total_marks),bv("span",null,k?bv("div",{className:"editing_marks"},bv("input",{type:"number",placeholder:h.total_get?Math.round(h.total_get/h.total_marks*100,0):0,value:y,onChange:e=>{b(e.target.value)}})):bv("span",null,y," / 100 "),bv("span",{className:k?"vicon vicon-close":"vicon vicon-pencil",onClick:()=>x(!k)}))),bv("a",{className:N?"button is-primary is-loading":"button is-primary",onClick:()=>{I(!0),y&&f&&fetch(window.wplms_course_data.api_url+"/instructor/courses/set_complete_course_marks",{method:"POST",body:JSON.stringify({course_id:n.id,user_id:f.user_id,marks:y,token:t})}).then(e=>e.json()).then(e=>{if(I(!1),e.status){w([]);let t=[...d];t.splice(d.findIndex(e=>e.user_id==f.user_id),1),u(t),g(!1),Sv("vibebp").addNotification({text:e.message})}else Sv("vibebp").addNotification({text:e.message})})}},window.wplms_course_data.translations.complete_course)):h.hasOwnProperty("comment_content")?bv("div",{className:"assigmmnet_submission"},bv("span",{className:"vicon vicon-arrow-left",onClick:()=>w([])}),h.content.length?bv("p",{dangerouslySetInnerHTML:{__html:h.content}}):"",bv("div",{className:"submissions"},bv("h3",null,window.wplms_course_data.translations.submission),h.comment_content.length?bv("p",{dangerouslySetInnerHTML:{__html:h.comment_content}}):"",h.hasOwnProperty("attachments")&&h.attachments.length?bv("div",{className:"attachments_wrapper"},bv("h4",null,window.wplms_course_data.translations.attachments),bv("div",{className:"attachments"},h.attachments?h.attachments.map((e,t)=>bv("div",{className:"attachment"},bv("a",{href:e.url,download:e.url.substring(e.url.lastIndexOf("/")+1),target:"_blank"},window.wplms_course_data.translations.download_attachment))):"")):""),h.hasOwnProperty("permit_mime")?bv("div",{className:"add_upload"},bv("h3",null,window.wplms_course_data.translations.upload_file),bv(yv,{field:{id:"assignment_uplaod_instructor"},type:"image",update:(e,t,a)=>{if(e.value){let t={...h};t.hasOwnProperty("instructor_remarks")||(t.instructor_remarks=""),console.log(e),t.instructor_remarks=t.instructor_remarks+" "+e.value.url,console.log(t),w(t)}}})):"",bv("div",{className:"remarks_wrapper"},bv("div",null),bv("div",{className:"remarks"},bv("textarea",{onChange:e=>{w({...h,instructor_remarks:e.target.value})},value:h.hasOwnProperty("instructor_remarks")?h.instructor_remarks:""}))),bv("div",{className:"total_marks"},bv("span",null,window.wplms_course_data.translations.total_marks),bv("span",null,k?bv("div",{className:"editing_marks"},bv("input",{type:"number",placeholder:h.user_marks?h.user_marks+"/"+h.total_marks:0,onChange:e=>{w({...h,user_marks:e.target.value})}})):bv("span",null,h.user_marks," / ",h.total_marks," "),bv("span",{className:k?"vicon vicon-close":"vicon vicon-pencil",onClick:()=>x(!k)}))),bv("a",{className:N?"button is-primary is-loading":"button is-primary",onClick:()=>{I(!0),h.hasOwnProperty("user_marks")&&f&&h.hasOwnProperty("comment_ID")&&fetch(window.wplms_course_data.api_url+"/instructor/courses/set_complete_assignment_marks",{method:"POST",body:JSON.stringify({id:n.id,user_id:f.user_id,marks:h.user_marks,comment_ID:h.comment_ID,instructor_remarks:h.instructor_remarks,token:t,parentId:n.parentId})}).then(e=>e.json()).then(e=>{if(I(!1),e.status){w([]);let t=[...d];t.splice(d.findIndex(e=>e.user_id==f.user_id),1),u(t),g(!1),Sv("vibebp").addNotification({text:e.message})}else Sv("vibebp").addNotification({text:e.message})})}},window.wplms_course_data.translations.complete_assignment)):d.length?bv("div",{className:"student_list"},d.map((e,a)=>bv("div",{className:"student_item"},bv("div",{className:"user_credentials"},bv("img",{className:"user_image",src:e.image}),e.nickname?bv("span",null,e.nickname):""),bv("div",{className:"user_controls"},bv("span",{onClick:()=>{(e=>{g(e),fetch(window.wplms_course_data.api_url+"/instructor/getStructure",{method:"POST",body:JSON.stringify({...n,user_id:e.user_id,token:t})}).then(e=>e.json()).then(e=>{if(e)if(e.status){if(w(e.data),e.data.hasOwnProperty("total_get")&&b(Math.round(e.data.total_get/e.data.total_marks,0)),e.data.hasOwnProperty("user_marks")&&b(e.data.user_marks),e.data.hasOwnProperty("user_marks")&&b(e.data.user_marks),e.data.hasOwnProperty("total_marks")&&b(e.data.user_marks),e.data.hasOwnProperty("questions")&&Array.isArray(e.data.questions)&&e.data.questions.length){let t=0;e.data.questions.map(e=>{t+=parseInt(e.marks)}),b(t)}}else Sv("vibebp").addNotification({text:e.message})})})(e)},className:"tip",title:window.wplms_course_data.translations.view_submission},"   ",bv("i",{className:"vicon vicon-write"})," "),bv("span",{onClick:()=>{((e,a)=>{e&&fetch(window.wplms_course_data.api_url+"/instructor/resetSubmission",{method:"POST",body:JSON.stringify({...n,token:t,user_id:e.user_id})}).then(e=>e.json()).then(e=>{if(e)if(e.status){Sv("vibebp").addNotification({text:e.message});let t=[...d];t.splice(a,1),u(t)}else Sv("vibebp").addNotification({text:e.message})})})(e,a)},className:"tip",title:window.wplms_course_data.translations.reset_course},bv("i",{className:"vicon vicon-reload"}))))),m?bv("a",{className:"link",onClick:()=>{v(!0),i({...n,paged:n.paged+1})}},window.wplms_course_data.translations.load_more):""):l.length?bv("div",{className:"vbp_message"},l):"")};const{createElement:Ev,render:zv,useState:Tv,useEffect:Mv,useContext:jv,Fragment:Lv,RawHTML:Hv}=wp.element,{dispatch:Av,select:Fv}=wp.data;var Dv=e=>{const t=e.member;let a=Fv("vibebp").getUser();a.token=Fv("vibebp").getToken();const[s,n]=Tv(!1),i=s=>{n(s),fetch(window.wplms_course_data.api_url+"/instructor/manageapplication",{method:"POST",body:JSON.stringify({course_id:e.course,token:a.token,action:s,user_id:t.user_id})}).then(e=>e.json()).then(t=>{t.status&&e.update({index:e.index},"performed"),Av("vibebp").addNotification({text:t.message}),n(!1)})};return t?Ev("div",{className:"course_student"},Ev("div",{className:"user_credentials"},t.image?Ev("img",{className:"user_image",src:t.image}):"",t.nickname?Ev("span",null,t.nickname):"",t.hasOwnProperty("meta")?t.meta.map(e=>{Ev("span",null,e.label," ",Ev("span",null),e.value)}):""),Ev("div",null,Ev("span",{className:"approve"===s?"approve button is-loading is-primary":"approve button is-primary",onClick:()=>{i("approve")}},Ev("span",{className:"vicon vicon-plus"}),window.wplms_course_data.translations.approve),Ev("span",{className:"reject"===s?"reject button is-loading is-primary":"reject button is-primary",onClick:()=>{i("reject")}},Ev("span",{className:"vicon vicon-close"}),window.wplms_course_data.translations.reject))):""};const{createElement:Rv,render:Jv,useState:Bv,useEffect:$v,useContext:Uv,Fragment:Vv,RawHTML:Wv}=wp.element,{dispatch:Yv,select:Xv}=wp.data;var Qv=e=>{let t=Xv("vibebp").getUser();t.token=Xv("vibebp").getToken();const[a,s]=Bv(!1),[n,i]=Bv([]),[o,r]=Bv(""),[l,c]=Bv("course"),[d,u]=Bv(e.course);$v(()=>{s(!0),fetch(window.wplms_course_data.api_url+"/instructor/courses/getSubmissionTabs",{method:"POST",body:JSON.stringify({course_id:e.course,token:t.token})}).then(e=>e.json()).then(e=>{s(!1),e.status?i(e.data.tabs):r(e.message)})},[]);const m=(e,t)=>{if("performed"==t&&n[n.findIndex(e=>e.value==l)].elements&&n[n.findIndex(e=>e.value==l)].elements.length){let t=[...n];t[t.findIndex(e=>e.value==l)].elements.splice(e.index,1),i(t)}};return Rv("div",{className:"course_submissions_wrapper"},a?Rv(tl,null):n.length?Rv("div",{className:"course_submissions_tabs_wrapper"},n.map(t=>Rv("a",{className:l==t.value?"button is-primary":"link",onClick:()=>{c(t.value),"course"!=t.value?u(!1):u(e.course)}},t.label))):Rv("div",{className:"vbp_message"},o),!a&&l?Rv("div",{className:"course_submissions_tab_conetnt"},n.length&&n[n.findIndex(e=>e.value==l)].hasOwnProperty("elements")&&"applications"!==l?Rv("select",{value:d,onChange:e=>u(e.target.value)},Rv("option",null,window.wplms_course_data.translations.select_module),n[n.findIndex(e=>e.value==l)].elements.map(e=>Rv("option",{value:e.value},e.label))):"","applications"==l?Rv("div",{className:"course_admin"},Rv("div",{className:"course_students"},n[n.findIndex(e=>e.value==l)].elements.map((t,a)=>Rv(Dv,{member:t,index:a,course:e.course,update:m})))):l&&n.length?Rv(Pv,{type:l,id:d,parentId:e.course,statuses:n[n.findIndex(e=>e.value==l)].status}):""):"")};const{createElement:Kv,render:Gv,useState:Zv,useEffect:eh,useContext:th,Fragment:ah,RawHTML:sh}=wp.element,{dispatch:nh,select:ih}=wp.data;function oh(e){if(null==e)return!0;if(void 0===e)return!0;if("number"==typeof e)return!1;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var rh=e=>{var t=React.useRef();let a=ih("vibebp").getUser();a.token=ih("vibebp").getToken();const[s,n]=Zv(!1),[i,o]=Zv({}),[r,l]=Zv("all_students"),[c,d]=Zv({}),[u,m]=Zv(!1),[p,_]=Zv(null);eh(()=>{v()},[]);const v=()=>{n(!0),fetch(window.wplms_course_data.api_url+"/instructor/getcoursestats",{method:"POST",body:JSON.stringify({course_id:e.course,token:a.token})}).then(e=>e.json()).then(e=>{n(!1),e.status&&o(e.data)})};eh(()=>{if(!s&&c&&Object.keys(c).length&&"function"==typeof Tabulator&&c.hasOwnProperty("data")&&c.data.length){var e=new Tabulator(t.current,{});e=new Tabulator(t.current,{data:c.data,layout:"fitDataStretch",layoutColumnsOnNewData:!0,columns:c.columns}),_(e)}},[c]);const h=e=>{if(console.log("wplms_download_course_stats_field_changed",e.detail),e.detail.hasOwnProperty("field")&&e.detail.hasOwnProperty("courseStats")){let t=e.detail.courseStats;t.download_options[e.detail.index]=e.detail.field,o(t)}};eh(()=>{console.log(h),document.removeEventListener("wplms_download_course_stats_field_changed",h),document.addEventListener("wplms_download_course_stats_field_changed",h)},[]);const w=(e,t)=>{if(e&&e.hasOwnProperty("type"))switch(e.type){case"checkbox":return Kv("div",{className:"checkbox"},Kv("input",{id:e.id,type:"checkbox",value:e.id,onChange:e=>{((e,t)=>{if(console.log(e),"checked"==t){let t={...i};switch(e.type){case"checkbox":1==e.value.target.checked?t.download_options[e.index].value=e.value.target.value:t.download_options[e.index].value=null,o(t);break;default:oh(e.value)?t.download_options[e.index].value=null:t.download_options[e.index].value=e.value,o(t)}}})({value:e,type:"checkbox",index:t},"checked")},checked:e.value==e.id}),Kv("label",{for:e.id},e.label));default:var a=new CustomEvent("wplms_course_download_stats_list",{detail:{field:e,index:t,courseStats:i}});return document.dispatchEvent(a),Kv("div",{className:"field"},Kv("div",{className:"wplms_course_download_stats_list_"+e.id}))}};return Kv("div",{className:"course_stats_wrapper"},s?Kv(tl,null):Kv("div",{className:"course_stats"},i.hasOwnProperty("general")&&i.general.length?Kv("div",{className:"course_general_stats"},i.general.map((e,t)=>Kv("div",{className:"data",key:t},Kv("label",null,e.label),Kv("span",null,e.value))),Kv("div",{className:"data",onClick:()=>{n(!0),fetch(window.wplms_course_data.api_url+"/instructor/recalculatestats",{method:"POST",body:JSON.stringify({course_id:e.course,token:a.token})}).then(e=>e.json()).then(e=>{v()})}},Kv("a",{className:"link"},window.wplms_course_data.translations.refresh))):"",Kv("div",{className:"download_stats_wrapper"},i.hasOwnProperty("download_options")&&i.download_options.length?Kv("div",{className:"course_stats_download"},i.download_options.map((e,t)=>w(e,t))):"",Kv("div",{className:"course_stats_download_actions"},Kv("select",{onChange:e=>{let t={...r};t=e.target.value,l(t)}},i.hasOwnProperty("download_student_options")&&i.download_student_options.length?i.download_student_options.map((e,t)=>Kv("option",{value:e.value,selected:r&&r.length&&r==e.value?'selected="selected"':""},e.label)):""),Kv("a",{className:u?"button is-primary is-loading":"button is-primary",onClick:()=>{let t=[];if(i.download_options.length&&i.download_options.map((e,a)=>{oh(e.value)||t.push(e.value)}),t.length<1||r.length<1)return nh("vibebp").addNotification({text:window.wplms_course_data.translations.select_option}),!1;m(!0),fetch(window.wplms_course_data.api_url+"/instructor/generatestats",{method:"POST",body:JSON.stringify({course_id:e.course,token:a.token,stats_student_option:r,stats_options:t})}).then(e=>e.json()).then(e=>{m(!1),e.hasOwnProperty("columns")&&e.columns.length?d({columns:e.columns,data:e.data}):e.message&&nh("vibebp").addNotification({text:e.message})})}},window.wplms_course_data.translations.generate_stats),c&&Object.keys(c).length&&c.data.length>1?Kv("a",{className:"download button primary",onClick:()=>{p&&!s&&c&&Object.keys(c).length&&c.hasOwnProperty("data")&&c.data.length&&p.download("csv","data"+e.course+".csv",{delimiter:","})}},window.wplms_course_data.translations.download):"")),c?Kv("div",{ref:t}):""))};const{createElement:lh,render:ch,useState:dh,useEffect:uh,Fragment:mh}=wp.element,{dispatch:ph,select:_h}=wp.data;Math.floor((new Date).getTime()/1e3);var vh=e=>{const[t,a]=dh(!1),[s,n]=dh({post_title:"",course:e.course,post_content:"",raw:"",type:""}),[i,o]=dh({}),[r,l]=dh(!1),[c,d]=dh([]);_h("vibebp").getUser();uh(()=>{e.hasOwnProperty("news")&&"object"==typeof e.news&&n({...s,id:e.news.id,post_title:e.news.post_title,post_cotent:e.news.post_content,raw:e.news.raw,type:e.news.type})},[]),uh(()=>{var t=new CustomEvent("load_vibe_editor",{detail:{selector:".vibe_news_editor",content:"object"==typeof e.news?e.news.post_content:"",raw:"object"==typeof e.news?e.news.raw:"",components:"editor",updater:"vibe_news"}});document.dispatchEvent(t)},[]),uh(()=>{document.addEventListener("vibe_editor_content_update_vibe_news",e=>{o({post_content:e.detail.raw_html,raw:e.detail.editor_content})}),fetch(window.wplms_create_course_data.api_url+"/taxonomy/",{method:"post",body:JSON.stringify({taxonomy:"news-tag",token:_h("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.status&&d(e.posts)})},[]);return lh("div",{className:"new_news"},r?lh("div",{className:"vibebp_content_preview_wrapper"},lh("span",{onClick:()=>{l(!1)}}),lh("div",{className:"vibebp_content_preview"},lh("div",{className:"new_news_header"},lh("span",{className:"vicon vicon-arrow-left",onClick:()=>{l(!1)}})),lh("h1",{className:"title"},s.post_title),lh("div",{className:"post_content",dangerouslySetInnerHTML:{__html:i.post_content}}))):"",lh("div",{className:"new_news_header"},lh("span",{className:"vicon vicon-arrow-left",onClick:e.back})),lh("div",{className:"new_news_content vibebp_form"},lh("div",{className:"vibebp_form_field"},lh("label",null,window.wplms_course_data.translations.news_title),lh("input",{type:"text",value:s.post_title,onChange:e=>{n({...s,post_title:e.target.value})}})),lh("select",{value:s.type,onChange:e=>{n({...s,type:e.target.value})}},lh("option",null,window.wplms_course_data.translations.news_category),c.length?c.map(e=>lh("option",{value:e.id},e.text)):""),lh("div",{className:"vibebp_form_field"},lh("label",null,window.wplms_course_data.translations.news_content),lh("div",{className:"vibe_news_editor"},lh("textarea",{onChange:e=>{n({...s,post_content:e.target.value}),o({...i,post_content:e.target.value})},value:s.post_content}))),lh("div",{className:"vibebp_form_field"},lh("a",{className:"button is-info",onClick:()=>{l(!r)}},window.wplms_course_data.translations.preview),lh("a",{className:t?"button is-primary is-loading":"button is-primary",onClick:()=>{a(!0),fetch(window.wplms_course_data.api_url+"/instructor/addnews",{method:"post",body:JSON.stringify({...s,post_content:i.post_content,raw:i.raw,token:_h("vibebp").getToken(),course:e.course})}).then(e=>e.json()).then(t=>{a(!1),t.status&&("object"==typeof e.news?e.update("edit",t.news):e.update("add",t.news),e.back())})}},"object"==typeof e.news?window.wplms_course_data.translations.edit_news:window.wplms_course_data.translations.create_news))))};const{createElement:hh,render:wh,useState:fh,useEffect:gh,Fragment:yh}=wp.element,{dispatch:bh,select:kh}=wp.data;Math.floor((new Date).getTime()/1e3);var xh=e=>{const[t,a]=fh(!1),[s,n]=fh({paged:1,s:"",orderby:"",order:"DESC"}),[i,o]=fh(""),[r,l]=fh([]),[c,d]=fh(!1),[u,m]=fh(!1),[p,v]=fh(""),[h,w]=fh(""),[f,g]=fh(!1),[y,b]=fh(-1),[k,x]=fh(!1);gh(()=>{if(e.course){fetch(window.wplms_course_data.api_url+"/student/announcement",{method:"post",body:JSON.stringify({course:e.course,token:kh("vibebp").getToken()})}).then(e=>e.json()).then(e=>{a(!1),e.status&&o(e.announcement)})}},[e]),_(()=>{a(!0),fetch(window.wplms_course_data.api_url+"/student/news",{method:"post",body:JSON.stringify({...s,course:e.course,token:kh("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(a(!1),e.status)if(u){let t=[...r,...e.news];t.length<e.total?d(!0):d(!1),l(t)}else e.news.length<e.total?d(!0):d(!1),l(e.news);else v(e.message)})},500,[s]);return hh("div",{className:"announcements_news"},t?hh(tl,null):hh(yh,null,i.length?hh("div",{className:"announcement"},hh("strong",null,window.wplms_course_data.translations.annoucement),hh("div",{dangerouslySetInnerHTML:{__html:i}})):"",hh("div",{className:"news_wrapper"},f?hh(vh,{news:f,course:e.course,back:()=>g(!1),update:(e,t)=>{let a=[...r];"add"==e&&a.unshift(t),"edit"==e&&a.splice(a.findIndex(e=>e.id==t.id),1,t),"remove"==e&&a.splice(a.findIndex(e=>e.id==t.id),1),l(a)}}):e.hasOwnProperty("instructor")||kh("vibebp").getUser().id==parseInt(e.course.post_author)?hh("a",{className:"button is-primary",onClick:()=>g(!0)},hh("span",{className:"vicon vicon-plus"}),window.wplms_course_data.translations.create_news):"",r.length?r.map((t,a)=>hh("div",{className:h==a?"news active":"news"},t.img?hh("div",{className:"news_featured_image"},hh("img",{src:t.img})):"",hh("div",{className:"news_details"},hh("h3",{onClick:()=>{w(a!=h&&a)}},t.post_title," ",e.hasOwnProperty("instructor")?hh("span",{className:"actions"},hh("span",{className:"vicon vicon-pencil-alt",onClick:()=>g(t)}),hh("span",{className:"vicon vicon-trash",onClick:()=>{b(a)}})):""),hh("span",null,hh(Ct,{timestamp:t.post_date})," ",hh(Kp,{type:"user",id:{user_id:t.post_author}})),hh("div",{className:"news_details_content",onClick:()=>{w(a!=h&&a)},dangerouslySetInnerHTML:{__html:t.post_content}})))):p.length?hh("div",{className:"vbp_message"},p):"",y>-1?hh("div",{className:"reviewpopup_wrapper",onClick:e=>{e.preventDefault(),document.querySelector(".reviewpopup_wrapper")&&e.target===document.querySelector(".reviewpopup_wrapper")&&(k||b(-1))}},hh("div",{className:"",className:k?"reviewpopup_content is-loading loading":"reviewpopup_content"},hh("div",{className:"close",onClick:()=>{k||b(-1)}},hh("span",{className:"vicon vicon-close"})),window.wplms_course_data.translations.sure_delete,hh("div",{className:"popup-footer"},hh("a",{className:k?"button is-primary is-loading":"button is-primary",onClick:()=>{x(!0),fetch(`${window.wplms_course_data.api_url}/deleteElement/${r[y].id}`,{method:"post",body:JSON.stringify({course_id:e.course.id,token:kh("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(e.status){let e=[...r];e.splice(y,1),l(e),b(-1)}e.hasOwnProperty("message")&&bh("vibebp").addNotification({text:e.message}),x(!1)})}},window.wplms_course_data.translations.ok),hh("a",{className:"button",onClick:()=>{k||b(-1)}},window.wplms_course_data.translations.cancel)))):"",c?hh("a",{className:"link",onClick:()=>{m(!0),n({...s,paged:s.paged+1})}},window.vibebp.translations.load_more):"")))};const{createElement:Nh,render:Ih,useState:Ch,useEffect:Oh,useContext:Sh,Fragment:qh,RawHTML:Ph}=wp.element,{dispatch:Eh,select:zh}=wp.data;var Th=e=>{const t=window.wplms_course_data.api_url,[a,s]=Ch(!1),[n,i]=Ch(),[o,r]=Ch(""),[l,c]=Ch("admin"),[d,u]=Ch(null);let m=zh("vibebp").getUser();m.token=zh("vibebp").getToken(),Oh(()=>{let t=e.course;r(t),p(t).then(e=>{e.status&&i(e.data)})},[e.course]);const p=e=>(s(!0),new Promise(a=>{let n={method:"post",body:JSON.stringify({token:m.token})};fetch(`${t}/instructor/course/${e}`,n).then(e=>e.json()).then(e=>{e&&a(e),s(!1)})})),_=(e,t)=>{"setactivityuser"==t&&(u(e),c("activity"))},v=t=>{let a=o;JSON.stringify({course_id:a,member_id:null});switch(t){case"admin":return Nh(Tp,{course:e.course,permissions:n.instructor_permissions,update:_});case"activity":return Nh(op,{id:e.course,cpt:"course",member:d});case"members":return Nh(CourseMembers,{course:e.course});case"submissions":return Nh(Qv,{course:e.course});case"reviews":return Nh(j_,{course:e.course,tabs:["reviews"]});case"qna":return Nh(tv,{id:{type:"course",id:e.course},course:e.course});case"news":return Nh(xh,{course:e.course,instructor:!0});case"edit_course":return Nh(vm,{course:e.course,back:()=>{c("admin")}});case"statistics":return Nh(rh,{course:e.course,back:()=>{c("statistics")}});default:var s=new CustomEvent("wplms_course_admin_tab",{detail:{tab:t,course:e.course}});return document.dispatchEvent(s),Nh("div",{className:"wplms_course_admin_tab_"+t})}};return Nh(qh,null,Nh("div",{className:"vicon vicon-arrow-left",onClick:e.back}),a?Nh(tl,null):l&&"edit_course"==l?v(l):Nh("div",{className:"course_manage"},n?Nh(qh,null,Nh("div",{className:"course_information"},Nh("img",{src:n.data.featured_image}),Nh("div",null,Nh("h2",null,n.data.name),Nh("span",{className:"course_meta"},Nh("span",null,Nh("span",{className:"vicon vicon-calendar"})," ",Nh(Ct,{timestamp:n.data.date_created})),Nh("span",null,Nh(v_,{rating:n.data.average_rating,maxstars:5}),"(",n.data.rating_count,")"),Nh("span",null,Nh("span",{className:"vicon vicon-user"}),n.data.total_students)),Nh("span",null,n.data.excerpt),Nh("a",{className:"link",target:"_blank",href:n.data.link},window.wplms_course_data.translations.show_more))),Nh("div",{className:"course_tabs"},n.is_instructor?Nh("div",{className:"instructor_tabs"},n.tabs?n.tabs.map(e=>Nh("span",{className:l==e.key?"active":"",onClick:()=>c(e.key)},e.label)):""):""),Nh("div",{className:"course_tab_content"},l?v(l):"")):""))};const{createElement:Mh,useState:jh,useEffect:Lh,Fragment:Hh,render:Ah}=wp.element,{dispatch:Fh,select:Dh}=wp.data,Rh=window.wplms_course_data.api_url;var Jh=e=>{const[t,a]=jh(!1),[s,n]=jh([]),[i,o]=jh({paged:1,orderby:"recent",order:"DESC",search_terms:"",post_status:"publish"}),[r,l]=jh(!1),[c,d]=jh(""),[u,m]=jh(null),[p,v]=jh(!0),[h,w]=jh(!1);let f=Dh("vibebp").getUser();f.token=Dh("vibebp").getToken();const[g,y]=jh(null);_(()=>{a(!0),g&&g.abort();let e={},t=new AbortController;g&&(e={signal:t.signal}),y(t),fetch(Rh+"/instructor/courses",{method:"POST",...e,body:JSON.stringify({filter:i,token:f.token})}).then(e=>e.json()).then(e=>{a(!1);let t=!1;if(y(null),e.status)if(h){let a=[...s,...e.courses];a.length<parseInt(e.total)&&(t=!0),n(a),w(!1)}else n(e.courses),e.courses.length<parseInt(e.total)&&(t=!0);else h||n([]),d(e.message);console.log("mmore",t),v(t)}).catch(e=>{"AbortError"===e.name?a(!0):console.error("Uh oh, an error!",e)})},500,[i]);let b=[...s];return navigator.onLine||i.search_terms.length&&(b=b.filter(e=>e.data.name.toLowerCase().includes(i.search_terms.toLowerCase()))),u?Mh(Th,{course:u,back:()=>{m(!1)}}):Mh("div",{className:"wplms_manage_courses_wrapper"},Mh("div",{className:"wplms_courses_header"},Mh("div",{className:"vibebp_form_field"},Mh("a",{onClick:e=>{o({...i,post_status:"publish",paged:1}),v(!0)},className:"publish"==i.post_status?"active button is-primary":"link"},window.wplms_course_data.translations.published),Mh("a",{onClick:e=>{o({...i,post_status:"pending",paged:1}),v(!0)},className:"pending"==i.post_status?"active button is-primary":"link"},window.wplms_course_data.translations.pending)),Mh("div",{className:"vibebp_form_field"},Mh("input",{type:"text",value:i.search_terms,onChange:e=>{o({...i,search_terms:e.target.value,paged:1})},placeholder:window.wplms_course_data.translations.search_courses}),Mh("span",{className:"vicon vicon-search"})),Mh("div",null,Mh("select",{value:i.orderby,onChange:e=>{o({...i,orderby:e.target.value})}},Object.keys(window.wplms_course_data.orderby).map(e=>Mh("option",{value:e},window.wplms_course_data.orderby[e]))),Mh("span",null,Mh("span",{className:"ASC"==i.order?"vicon vicon-angle-up active":"vicon vicon-angle-up",onClick:()=>{o({...i,order:"ASC"})}}),Mh("span",{className:"DESC"==i.order?"vicon vicon-angle-down active":"vicon vicon-angle-down",onClick:()=>{o({...i,order:"DESC"})}})))),t?Mh(tl,null):b.length?Mh("div",{className:"course_instructor_blocks"},b.map(e=>Mh("div",{className:"course_instructor_block",onClick:()=>{m(e.data.id)}},Mh(xm,{course:e.data}))),p?Mh("a",{className:"link",onClick:()=>{o({...i,paged:i.paged+1}),w(!0)}},window.wplms_course_data.translations.load_more):""):Mh("div",{className:"vbp_message"},window.wplms_course_data.translations.no_courses_found))};const{createElement:Bh,useState:$h,useEffect:Uh,Fragment:Vh,render:Wh}=wp.element,{dispatch:Yh,select:Xh}=wp.data;var Qh=e=>{const[t,a]=$h(!1),[s,n]=$h(0),[i,o]=$h(e.types),[r,l]=$h([]),[c,d]=$h({post_title:"",post_content:"",type:"",taxonomy:[],meta:[{meta_key:"vibe_duration",meta_value:5},{meta_key:"vibe_duration_parameter",meta_value:60}]}),[u,m]=$h({post_content:"",raw:[]}),[p,_]=$h(!1);Uh(()=>{e.hasOwnProperty("type")&&n(e.type)},[]),console.log(s),Uh(()=>{e.id&&e.type&&(a(!0),fetch(window.wplms_create_course_data.api_url+"/curriculum/getElementFields/",{method:"post",body:JSON.stringify({type:"quiz",id:e.id,fields:i[i.findIndex(t=>t.id==e.type)].fields,token:Xh("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(e.status){if(Array.isArray(e.fields)){l(e.fields);let t={post_title:"",post_content:"",type:"",taxonomy:[],meta:[]};console.log("Setting up"),new Promise(a=>{console.log("inside_promise"),e.fields.map((s,n)=>{if("taxonomy"==s.type){let e=t.taxonomy.findIndex(e=>e.taxonomy==s.taxonomy);-1==e?t.taxonomy.push({taxonomy:s.taxonomy,value:s.value}):t.taxonomy[e].value=s.value}if("meta"==s.from)if(f(s.value)&&!f(s.default)&&(s.value=s.default),"duration"==s.type){let e=t.meta.findIndex(e=>e.meta_key==s.id);e>-1?t.meta[e].meta_value=s.value.value:t.meta.push({meta_key:s.id,meta_value:s.value.value});let a=t.meta.findIndex(e=>e.meta_key==s.id+"_parameter");a>-1?t.meta[a].meta_value=s.value.parameter:t.meta.push({meta_key:s.id+"_parameter",meta_value:s.value.parameter})}else{let e=t.meta.findIndex(e=>e.meta_key==s.id);e>-1?t.meta[e].meta_value=s.value:t.meta.push({meta_key:s.id,meta_value:s.value}),"editor"==s.type&&s.hasOwnProperty("raw")&&(e=t.meta.findIndex(e=>e.meta_key==s.id+"_raw"),e>-1?t.meta[e].meta_value=s.raw:t.meta.push({meta_key:s.id+"_raw",meta_value:s.raw}))}"post"==s.from&&("post_content"==s.id?m({value:s.value,raw:s.raw}):t[s.id]=s.value),n==e.fields.length-1&&a()})}).then(()=>{console.log(t),a(!1),d(t)})}}else a(!1)}))},[e.id]);const v=(e,t=null)=>{let a={...c},s={};if(s=e.hasOwnProperty("field")?e.field:e,"taxonomy"==s.type){let e=a.taxonomy.findIndex(e=>e.taxonomy==s.taxonomy);-1==e?a.taxonomy.push({taxonomy:s.taxonomy,value:s.value}):a.taxonomy[e].value=s.value}if("meta"==s.from)if("duration"==s.type){let e=a.meta.findIndex(e=>e.meta_key==s.id);e>-1?a.meta[e].meta_value=s.value.value:a.meta.push({meta_key:s.id,meta_value:s.value.value});let t=a.meta.findIndex(e=>e.meta_key==s.id+"_parameter");t>-1?a.meta[t].meta_value=s.value.parameter:a.meta.push({meta_key:s.id+"_parameter",meta_value:s.value.parameter})}else{let e=a.meta.findIndex(e=>e.meta_key==s.id);e>-1?a.meta[e].meta_value=s.value:a.meta.push({meta_key:s.id,meta_value:s.value}),"editor"==s.type&&s.hasOwnProperty("raw")&&(e=a.meta.findIndex(e=>e.meta_key==s.id+"_raw"),e>-1?a.meta[e].meta_value=s.raw:a.meta.push({meta_key:s.id+"_raw",meta_value:s.raw}))}if("post"==s.from){if("post_content"==s.id)return void m({value:s.value,raw:s.raw});a[s.id]=s.value}d(a)};return Bh("div",{className:"add_cpt_wrapper"},t?Bh(tl,null):s?Bh(Vh,null,r.map((t,a)=>Bh(Zd,{field:t,fieldIndex:a,tabIndex:e.tabIndex,update:v})),Bh("span",{className:"element_actions"},Bh("a",{className:p?"button is-primary is-loading":"button is-primary",onClick:()=>{if(!f(c)){_(!0),e.id&&(c.id=e.id);let t=c.meta.findIndex(e=>"vibe_type"==e.id);-1==t?c.meta.push({meta_key:"vibe_type",meta_value:s}):c.meta[t]={meta_key:"vibe_type",meta_value:s};let a=c.meta.findIndex(e=>"vibe_duration"==e.meta_key);-1==a&&nnewCurriculumItem.meta.push({meta_key:"vibe_duration",meta_value:"6"}),a=c.meta.findIndex(e=>"vibe_duration_parameter"==e.meta_key),-1==a&&nnewCurriculumItem.meta.push({meta_key:"vibe_duration_parameter",meta_value:"60"}),fetch(window.wplms_create_course_data.api_url+"/createElement/quiz",{method:"post",body:JSON.stringify({...c,post_content:u.value,raw:u.raw,token:Xh("vibebp").getToken()})}).then(e=>e.json()).then(t=>{_(!1),t.status?e.show(t.quiz):t.hasOwnProperty("message")&&Yh("vibebp").addNotification({text:t.message})})}}},window.wplms_create_course_data.translations.add_cpt.quiz.add),Bh("a",{className:"link",onClick:e.back},window.wplms_create_course_data.translations.cancel))):i.map(e=>Bh("div",{className:s?"add_cpt_type active":"add_cpt_type",onClick:()=>{n(e.id),l(i[i.findIndex(t=>t.id==e.id)].fields)}},Bh("span",{className:e.icon}),e.label)))};const{createElement:Kh,useState:Gh,useEffect:Zh,Fragment:ew,render:tw}=wp.element,{dispatch:aw,select:sw}=wp.data;var nw=e=>{var t=React.useRef();let a=sw("vibebp").getUser();a.token=sw("vibebp").getToken();const[s,n]=Gh(!0),[i,o]=Gh({}),[r,l]=Gh("all_students"),[c,d]=Gh({}),[u,m]=Gh(!1),[p,_]=Gh(null);Zh(()=>{fetch(window.wplms_course_data.api_url+"/instructor/getstatstabs",{method:"POST",body:JSON.stringify({token:a.token,id:e.id,cpt:"quiz"})}).then(e=>e.json()).then(e=>{n(!1),e.status&&o(e.data)})},[e.id]);const v=e=>{if(e.detail.hasOwnProperty("field")&&e.detail.hasOwnProperty("modStats")){let t=e.detail.modStats;t.download_options[e.detail.index]=e.detail.field,setmodStats(t)}};Zh(()=>{document.removeEventListener("wplms_download_mod_stats_field_changed",v),document.addEventListener("wplms_download_mod_stats_field_changed",v)},[]);Zh(()=>{if(!s&&c&&Object.keys(c).length&&"function"==typeof Tabulator&&c.hasOwnProperty("data")&&c.data.length){var e=new Tabulator(t.current,{});e=new Tabulator(t.current,{data:c.data,layout:"fitDataStretch",layoutColumnsOnNewData:!0,columns:c.columns}),_(e)}},[c]);const h=(e,t)=>{if("checked"==t){let t={...i};switch(e.type){case"checkbox":1==e.value.target.checked?t.download_options[e.index].value=e.value.target.value:t.download_options[e.index].value=null,o(t);break;default:f(e.value)?t.download_options[e.index].value=null:t.download_options[e.index].value=e.value,o(t)}}};return s?Kh(tl,null):Kh(ew,null,Kh("div",{className:"download_stats_wrapper"},i.hasOwnProperty("download_options")&&i.download_options.length?Kh("div",{className:"mod_stats_download"},i.download_options.map((e,t)=>((e,t)=>{if(e&&e.hasOwnProperty("type"))switch(e.type){case"checkbox":return Kh("div",{className:"checkbox"},Kh("input",{id:e.id,type:"checkbox",value:e.id,onChange:e=>{h({value:e,type:"checkbox",index:t},"checked")},checked:e.value==e.id}),Kh("label",{for:e.id},e.label));default:var a=new CustomEvent("wplms_mod_download_stats_list",{detail:{field:e,index:t,quizStats:i}});return document.dispatchEvent(a),Kh("div",{className:"field"},Kh("div",{className:"wplms_mod_download_stats_list_"+e.id}))}})(e,t))):"",Kh("div",{className:"mod_stats_download_actions"},Kh("select",{onChange:e=>{let t={...r};t=e.target.value,l(t)}},i.hasOwnProperty("download_student_options")&&i.download_student_options.length?i.download_student_options.map((e,t)=>Kh("option",{value:e.value,selected:r&&r.length&&r==e.value?'selected="selected"':""},e.label)):""),Kh("a",{className:u?"button is-primary is-loading":"button is-primary",onClick:()=>{let t=[];if(i.download_options.length&&i.download_options.map((e,a)=>{f(e.value)||t.push(e.value)}),t.length<1||r.length<1)return aw("vibebp").addNotification({text:window.wplms_course_data.translations.select_option}),!1;m(!0),fetch(window.wplms_course_data.api_url+"/instructor/generatemodstats",{method:"POST",body:JSON.stringify({id:e.id,token:a.token,stats_student_option:r,stats_options:t,post_type:"quiz"})}).then(e=>e.json()).then(e=>{m(!1),e.hasOwnProperty("columns")&&e.columns.length?d({columns:e.columns,data:e.data}):e.message&&aw("vibebp").addNotification({text:e.message})})}},window.wplms_course_data.translations.generate_stats),c&&Object.keys(c).length&&c.data.length>1?Kh("a",{className:"download button primary",onClick:()=>{p&&!s&&c&&Object.keys(c).length&&c.hasOwnProperty("data")&&c.data.length&&p.download("csv","data"+e.id+".csv",{delimiter:","})}},window.wplms_course_data.translations.download):"")),c?Kh("div",{ref:t}):"")};const{createElement:iw,useState:ow,useEffect:rw,Fragment:lw,render:cw}=wp.element,{dispatch:dw,select:uw}=wp.data;var mw=e=>{const[t,a]=ow("");return rw(()=>{let t="",s="";switch(e.type){case"friends":s="user",t=e.id.item_id;break;case"group":s="group",t=e.id.item_id;break;case"activity":s="user",t=e.id.secondary_item_id;break;case"member":case"name":case"user_tip":case"user":s="user",t=e.id.user_id;break;default:s=e.type,t=e.id.item_id}localforage.getItem(s+"_"+t).then(t=>{null!==t?a(JSON.parse(t)):fetch(window.vibebp.api.url+"/avatar",{method:"post",body:JSON.stringify({type:e.type,ids:e.id,token:uw("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.status&&(localforage.setItem(e.key,JSON.stringify(e.value)),a(e.value))})})},[]),"member"==e.type?iw("span",{className:"vibebp_member"},iw("img",{src:t.avatar,className:"vibebp_avatar",onClick:e.click,alt:t.name,title:t.name}),iw("span",null,t.name)):"user_tip"==e.type?iw("span",{className:"vibebp_member tip",title:t.name},iw("img",{src:t.avatar,className:"vibebp_avatar",onClick:e.click,alt:t.name,title:t.name})):"name"==e.type?iw("span",null,t.name):iw("img",{src:t.avatar,className:"vibebp_avatar",onClick:e.click,alt:t.name,title:t.name})};const{createElement:pw,useState:_w,useEffect:vw,Fragment:hw,render:ww}=wp.element,{dispatch:fw,select:gw}=wp.data;var yw=e=>{const[t,a]=_w([]),[s,n]=_w(""),[i,o]=_w([]),[r,l]=_w(!1),[c,d]=_w(!1);_(()=>{s.length>3&&(l(!0),fetch(window.vibebp.api.url+"/search",{method:"post",body:JSON.stringify({search:s,type:"user",token:gw("vibebp").getToken()})}).then(e=>e.json()).then(e=>{l(!1),e.status&&Array.isArray(e.results)&&o(e.results)}))},500,[s]);return pw("div",{className:"assigned_block"},pw("div",{className:"vibebp_form_field"},t.length?pw(hw,null,pw("label",null,window.wplms_course_data.translations.assigned),pw("div",{className:"wplms_assigned_members"},t.map(e=>pw("div",{className:"wplms_assigned_member",onClick:()=>{let s={...t};t.indexOf(e)>-1&&(s.splice(s.indexOf(e),1),a(s))}},pw(mw,{type:"member",id:{user_id:e}}))),t.length?pw("a",{className:c?"button is-loading is-primary":"button is-primary",onClick:()=>{d(!0),c||fetch(window.wplms_course_data.api_url+"/instructor/assign",{method:"POST",body:JSON.stringify({token:gw("vibebp").getToken(),id:e.id,cpt:e.cpt,users:t})}).then(e=>e.json()).then(t=>{d(!1),t.status&&(e.close(),fw("vibebp").addNotification({text:t.message}))})}},window.wplms_course_data.translations.assign):"")):""),pw("div",{className:r?"control is-loading":"control"},pw("label",null,window.wplms_course_data.translations.fullusername_or_email),pw("input",{type:"text",value:s,onChange:e=>{n(e.target.value)},placeholder:window.wplms_course_data.translations.search_student})),pw("div",{className:"wplms_assigned_members_wrapper"},Array.isArray(i)&&i.length?pw("div",{className:"wplms_assigned_members"},i.map((e,s)=>pw("div",{className:"wplms_assigned_member",onClick:()=>{let n=[...t];if(-1==n.indexOf(e.id)){n.push(e.id);let t=[...i];t.splice(s,1),o(t)}a(n)}},pw("img",{src:e.avatar}),pw("span",null,e.name)))):""))};const{createElement:bw,useState:kw,useEffect:xw,Fragment:Nw,render:Iw}=wp.element,{dispatch:Cw,select:Ow}=wp.data;var Sw=e=>{const[t,a]=kw(!1),[s,n]=kw({}),[i,o]=kw([]),[r,l]=kw(!1),[c,d]=kw(!0),[u,m]=kw({cpt:e.cpt,id:e.id,paged:1,per_page:20,s:"",orderby:"date_recorded",order:"DESC"});return _(()=>{if(a(!0),c)fetch(window.wplms_course_data.api_url+"/instructor/leaderboard",{method:"post",body:JSON.stringify({args:u,token:Ow("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(a(!1),e.status)if(r){let t=[...i,e.members];o(t),t.length<e.total?d(!0):d(!1)}else o(e.members),e.members.length<e.total?d(!0):d(!1);else d(!1)});else if(i.length){let e=[...i];u.s.length&&(e=e.filter(e=>e.name.indexOf(u.s)>-1))}},500,[u]),bw("div",{className:"leaderboard_wrapper"},bw("div",{className:"leaderboard_header"},bw("div",{className:"vibebp_form_field"},bw("input",{type:"text",value:u.s,onChange:e=>{m({...u,s:e.target.value})},placeholder:window.wplms_course_data.translations.search_student})),bw("div",null,bw("select",{value:u.orderby,onChange:e=>{m({...u,orderby:e.target.value})}},Object.keys(window.wplms_course_data.leaderboard.sorters).map(e=>bw("option",{value:e},window.wplms_course_data.leaderboard.sorters[e]))),bw("span",null,bw("span",{className:"ASC"==u.order?"active vicon vicon-arrow-up":"vicon vicon-arrow-up",onClick:()=>m({...u,order:"ASC"})}),bw("span",{className:"DESC"==u.order?"active vicon vicon-arrow-down":"vicon vicon-arrow-down",onClick:()=>m({...u,order:"DESC"})})))),bw("div",{className:"leaderboard_members"},t?bw(tl,null):i.length?i.map((e,t)=>bw("div",{className:"leaderboard_member"},bw("div",null,bw(mw,{type:"member",id:{user_id:e.user_id},update:e=>{let a=[...i];a[t].name=e,o(a)}}),bw("span",null,e.hasOwnProperty("name")?e.name:"")),bw("span",null,bw(Ct,{timestamp:e.date_recorded})),bw("div",null,e.score))):bw("div",{className:"vbp_message"},window.wplms_course_data.translations.members_not_found),c?bw("a",{className:"link",onClick:()=>{l(!0),m({...u,paged:u.paged+1})}},window.wplms_course_data.translations.load_more):""))};const{createElement:qw,useState:Pw,useEffect:Ew,Fragment:zw,render:Tw}=wp.element,{dispatch:Mw,select:jw}=wp.data;var Lw=e=>{const[t,a]=Pw(!1),[s,n]=Pw({}),[i,o]=Pw([]),[r,l]=Pw(!1),[c,d]=Pw(!1),[u,m]=Pw(!1),[p,v]=Pw(!1),[h,w]=Pw({cpt:e.cpt,id:e.id,paged:1,per_page:20,sort:"date_recorded",order:"DESC"});return Ew(()=>{if(document.getElementById("chartjs"))d(!0);else{const e=document.createElement("script");e.src=window.wplms_course_data.chartjs,e.id="chartjs",document.body.appendChild(e),e.onload=()=>{d(!0)}}},[]),Ew(()=>{c&&r&&s.hasOwnProperty("data")&&!f(s.data.data)&&new Chart(r.getContext("2d"),{type:"doughnut",data:{labels:s.data.labels,datasets:[{data:s.data.data,backgroundColor:s.data.bgs}]}})},[c,r,s]),_(()=>{a(!0),fetch(window.wplms_course_data.api_url+"/instructor/stats",{method:"post",body:JSON.stringify({args:h,token:jw("vibebp").getToken()})}).then(e=>e.json()).then(e=>{a(!1),e.status&&n(e.statistics)})},500,[h]),qw(zw,null,e.hasOwnProperty("nodownload")&&e.nodownload?"":qw(zw,null,u?qw("div",{className:"download_mod_stats_warpper"},qw("span",{className:"link is-primary",onClick:()=>m(!1)},window.wplms_course_data.translations.close),qw(nw,{id:e.id})):qw("a",{className:"button is-primary",onClick:()=>m(!0)},window.wplms_course_data.translations.download_stats),window.wplms_course_data.enable_assign_quiz?e.hasOwnProperty("cpt")&&"quiz"==e.cpt&&p?qw("div",{className:"download_mod_stats_warpper"},qw("span",{className:"link",onClick:()=>v(!1)},window.wplms_course_data.translations.close),qw(yw,{close:()=>v(!1),cpt:e.cpt,id:e.id})):qw("a",{className:"button is-primary",onClick:()=>v(!0)},window.wplms_course_data.translations.assign_student):""),qw("div",{className:"statistics_wrapper"},qw("div",{className:"statistics_marks_distribution"},qw("canvas",{ref:e=>{e&&!r&&l(e)}})),qw("div",{className:"vital_stats"},s.hasOwnProperty("vitals")?qw("ul",null,s.vitals.map(e=>qw("li",null,qw("span",null,e.label),qw("span",null,e.value)))):"")),qw(Sw,{cpt:e.cpt,id:e.id}))};const{createElement:Hw,render:Aw,useState:Fw,useEffect:Dw,useContext:Rw,Fragment:Jw,RawHTML:Bw}=wp.element,{dispatch:$w,select:Uw}=wp.data;var Vw=e=>{const[t,a]=Fw(!1),[s,n]=Fw(!1),[i,o]=Fw(),r=parseInt(e.member),[l,c]=Fw({paged:1,search_terms:"",per_page:20,action:"",order:"DESC",scope:r}),[d,u]=Fw(""),[m,p]=Fw(!1),[v,h]=Fw(!1),[w,f]=Fw(!1);let g=Uw("vibebp").getUser();g.token=Uw("vibebp").getToken();const y=window.wplms_course_data.api_url;_(()=>{a(!0);let t={method:"POST",body:JSON.stringify({id:e.id,filter:l,token:g.token})};fetch(`${y}/instructor/${e.cpt}/activity`,t).then(e=>e.json()).then(e=>{if(a(!1),e.status){if(m){let t=[...i,...e.data.activities];o(t),p(!1)}else o(e.data.activities);e.data.has_more_items?h(!0):h(!1),e.is_instructor&&f(e.is_instructor)}else e.hasOwnProperty("message")&&$w("vibebp").addNotification({text:e.message})})},500,[l]);const b=(e,t)=>{let a=[...e];if("remove"===t||"remove-favorite"==t&&"activity-favs"==args.filter){let t=[...i],a=t.findIndex(t=>t.id===e.id);-1!==a&&(t.splice(a,1),o(t))}"add"===t&&(a.unshift(e),o(a))};return Hw("div",{className:"course_activity_wrapper"},Hw("div",{className:"portal"},Hw("div",{className:"portal_header"},Hw("div",{className:"header_links"},Hw("div",{className:"searchbox active"},Hw("span",{className:"vicon vicon-search"}),Hw("input",{type:"text",placeholder:window.wplms_course_data.translations.search,value:l.search_terms,onChange:e=>{c({...l,search_terms:e.target.value})}}))),Hw("div",{className:"header_extras"},Hw("select",{value:l.scope,onChange:e=>{c({...l,scope:e.target.value})}},Hw("option",{value:"all"},"All"),Hw("option",{value:"personal"},"personal")),Hw("div",{className:"filter_by"},Hw("select",{value:l.action,onChange:e=>{c({...l,action:e.target.value})}},Hw("option",null,window.wplms_course_data.translations.filter_by),Object.keys(window.wplms_course_data.course.admin.activity_sorters).length?Object.keys(window.wplms_course_data.course.admin.activity_sorters).map(e=>Hw("option",{value:e},window.wplms_course_data.course.admin.activity_sorters[e])):""),Hw("span",null,Hw("span",{className:"ASC"==l.order?"vicon vicon-angle-up active":"vicon vicon-angle-up",onClick:()=>{c({...l,order:"ASC"})}}),Hw("span",{className:"DESC"==l.order?"vicon vicon-angle-down active":"vicon vicon-angle-down",onClick:()=>{c({...l,order:"DESC"})}}))))),Hw("div",{className:"portal_body"},t?Hw(tl,null):"",i&&i.length?Hw("div",{className:"activity_list"},i.map(e=>Hw(Qm,{activity:e,rootActivityId:e.id,update:b}))):Hw("div",{className:"vbp_message"},window.wplms_course_data.translations.no_activity),v?Hw("a",{className:"link",onClick:()=>{p(!0),c({...l,paged:l.paged+1})}},window.wplms_course_data.translations.load_more):null)))};const{createElement:Ww,useState:Yw,useEffect:Xw,Fragment:Qw,render:Kw}=wp.element,{dispatch:Gw,select:Zw}=wp.data;var ef=e=>{const[t,a]=Yw(!1),[s,n]=Yw([]),[i,o]=Yw({paged:1,orderby:"date",order:"DESC",s:""}),[r,l]=Yw(!1),[c,d]=Yw(!1),[u,m]=Yw(""),[p,v]=Yw(!1),[h,w]=Yw(!1),[f,g]=Yw([]),[y,b]=Yw("stats"),k=(Zw("vibebp").getUser(),Zw("vibebp").getToken()),[x,N]=Yw(null);_(()=>{a(!0),x&&x.abort();let e={},t=new AbortController;x&&(e={signal:t.signal}),N(t),fetch(window.wplms_course_data.api_url+"/instructor/quizzes",{method:"POST",...e,body:JSON.stringify({...i,token:k})}).then(e=>e.json()).then(e=>{if(a(!1),N(null),e.status)if(r){let t=[...s];e.quizzes.length&&(e.quizzes.map((e,a)=>{t.push(e)}),n(t)),t.length<e.total&&d(!0)}else n(e.quizzes),e.quizzes.length<e.total&&d(!0);else m(e.message)}).catch(e=>{"AbortError"===e.name?console.log("Fetch aborted"):console.error("Uh oh, an error!",e)})},500,[i]),Xw(()=>{a(!0),fetch(`${window.wplms_course_data.api_url}/gettabs/0?client_id=${window.wplms_course_data.client_id}`,{method:"POST",body:JSON.stringify({token:k})}).then(e=>e.json()).then(e=>{a(!1);let t=e[e.findIndex(e=>"course_curriculum"==e.id)].fields,s=t[t.findIndex(e=>"curriculum"==e.type)].curriculum_elements;g(s[s.findIndex(e=>"quiz"==e.type)].types)})},[]);return Ww("div",{className:"wplms_manage_quizzes_wrapper"},h?Ww(Qh,{back:()=>w(!1),show:e=>{if(w(!1),!p){let e={...i};e.paged=1,o(e)}},types:f,id:p,type:s.findIndex(e=>e.id==p)>-1?s[s.findIndex(e=>e.id==p)].type:0}):p?Ww("div",{className:"course_manage quiz_wrapper"},Ww("div",{className:"quiz_header"},Ww("span",{className:"header_links"},Ww("span",{className:"vicon vicon-arrow-left",onClick:()=>{w(!1),v(!1)}}),Ww("span",null,s[s.findIndex(e=>e.id==p)].link?Ww("span",null,Ww("a",{href:s[s.findIndex(e=>e.id==p)].link,target:"_blank",className:"vicon vicon-link"})):"",Ww("span",{className:"vicon vicon-pencil",onClick:()=>{w(p)}}),Ww("span",{className:"vicon vicon-trash",onClick:()=>{window.confirm(window.wplms_course_data.translations.confirm_delete_quiz)&&(a(!0),fetch(window.wplms_course_data.api_url+"/instructor/deleteQuiz",{method:"POST",body:JSON.stringify({quiz_id:p,token:k})}).then(e=>e.json()).then(e=>{if(a(!1),e.status){w(!1),v(!1);let e=[...s];e.splice(e.findIndex(e=>e.id==p),1),n(e)}e.hasOwnProperty("message")&&Gw("vibebp").addNotification({text:e.message})}))}}))),Ww("h2",{dangerouslySetInnerHTML:{__html:s[s.findIndex(e=>e.id==p)].title}}),Ww("div",{className:"quiz_info"},Ww("div",null,Ww("span",null,Ww("span",{className:"vicon vicon-calendar"})," ",s[s.findIndex(e=>e.id==p)].created),Ww("div",{className:"wplms_quiz-type"},s[s.findIndex(e=>e.id==p)]["quiz-type"].length?s[s.findIndex(e=>e.id==p)]["quiz-type"].map(e=>Ww("span",null,e)):"")),Ww("div",null,Ww("span",null,Ww("span",{className:"vicon vicon-user"})," ",s[s.findIndex(e=>e.id==p)].attempts),Ww("span",null,Ww("span",{className:"vicon vicon-timer"})," ",Ww(Ct,{timestamp:s[s.findIndex(e=>e.id==p)].timer})),Ww("span",null,Ww("span",{className:"vicon vicon-cup"})," ",s[s.findIndex(e=>e.id==p)].marks)))),Ww("div",{className:"course_tabs"},Ww("div",{className:"instructor_tabs"},Ww("span",{className:"stats"==y?"active":"",onClick:()=>b("stats")},window.wplms_course_data.translations.statistics),Ww("span",{className:"activity"==y?"active":"",onClick:()=>b("activity")},window.wplms_course_data.translations.activity),Ww("span",{className:"submissions"==y?"active":"",onClick:()=>b("submissions")},window.wplms_course_data.translations.submissions),Ww("span",{className:"view"==y?"active":"",onClick:()=>b("view")},window.wplms_course_data.translations.view))),Ww("div",{className:"course_tab_content"},"stats"==y?Ww(Lw,{cpt:"quiz",id:p}):"activity"==y?Ww(Vw,{id:p,cpt:"quiz"}):"submissions"==y?Ww(Pv,{id:p,type:"quiz",statuses:window.wplms_course_data.course.submission_quiz_statuses}):Ww(pl,{quizid:p,update:()=>{console.log("#")}}))):Ww(Qw,null,Ww("div",{className:"mycourses_header vibebp_form"},Ww("div",null,Ww("div",{className:"vibebp_form_field"},Ww("input",{type:"text",placeholder:window.vibebp.translations.search_text,value:i.s,onChange:e=>{o({...i,s:e.target.value})}}),Ww("span",{className:"vicon vicon-search"}))),Ww("select",{value:i.orderby,onChange:e=>{o({...i,orderby:e.target.value})}},Ww("option",null,window.vibebp.translations.select_option),Object.keys(window.wplms_course_data.orderby).map(e=>Ww("option",{value:e},window.wplms_course_data.orderby[e])))),Ww("div",{className:"vibebp_quizzes"},Ww("div",{class:"new_quiz",onClick:()=>w(!0)},Ww("i",{class:"vicon vicon-plus"})),t?Ww(tl,null):s.length?s.map(e=>Ww("div",{className:"wplms_quiz",onClick:()=>v(e.id)},Ww("div",null,Ww("h3",null,Ww("span",{className:"static"==e.type?"vicon vicon-exchange-vertical":"vicon vicon-control-shuffle"})," ",Ww("strong",{dangerouslySetInnerHTML:{__html:e.title}})),Ww("span",null,e.created),Ww("div",{className:"wplms_quiz-type"},e["quiz-type"].length?e["quiz-type"].map(e=>Ww("span",null,e)):"")),Ww("div",{className:"quiz_meta"},Ww("span",null,Ww("span",{className:"vicon vicon-user"})," ",e.attempts),Ww("span",null,Ww("span",{className:"vicon vicon-time"})," ",e.timer),Ww("span",null,Ww("span",{className:"vicon vicon-medall-alt"})," ",e.marks)))):Ww("div",{className:"vbp_message"},u),c?Ww("a",{className:"link",onClick:()=>{l(!0),d(!1),o({...i,paged:i.paged+1})}},window.wplms_course_data.translations.load_more):"")))};const{createElement:tf,useState:af,useEffect:sf,Fragment:nf,render:of,useRef:rf}=wp.element,{dispatch:lf,select:cf}=wp.data,df={ID:"",post_title:"",post_content:"",taxonomy:[{taxonomy:"question-tag",value:[]}],meta:[{meta_key:"vibe_question_type",meta_value:""}]};var uf=e=>{var t=rf();const a=rf(null),[s,n]=af(!1),[i,o]=af(!1),[r,l]=af(""),[c,d]=af(!1),[u,m]=af(!1),[p,v]=af([]),[h,w]=af({paged:1,orderby:"date",order:"DESC",s:""}),[f,g]=af([]),[y,b]=af(!1),[k,x]=af(!1),[N,I]=af(""),[C,O]=af(null),S=(cf("vibebp").getUser(),cf("vibebp").getToken()),[q,P]=af(!1),[E,z]=af(!1),[T,M]=af(!1),[j,L]=af({post_content:"",raw:[]}),[H,A]=af({meta_key:"vibe_question_explaination",meta_value:"",raw:[]}),[F,D]=af(df),[R,J]=af({}),[B,$]=af({}),[U,V]=af(!1),[W,Y]=af(null);_(()=>{d(!0),W&&W.abort();let e={},t=new AbortController;W&&(e={signal:t.signal}),Y(t),fetch(window.wplms_course_data.api_url+"/instructor/questions",{method:"POST",...e,body:JSON.stringify({...h,token:S})}).then(e=>e.json()).then(e=>{if(d(!1),Y(null),e.status)if(y){let t=p.concat(e.questions);v(t),b(!1),t.length<e.total&&x(!0)}else v(e.questions),e.questions.length<e.total&&x(!0);else I(e.message);m(e.columns)}).catch(e=>{"AbortError"===e.name?console.log("Fetch aborted"):console.error("Uh oh, an error!",e)})},500,[h]),sf(()=>{d(!0),fetch(`${window.wplms_course_data.api_url}/gettabs/0?client_id=${window.wplms_course_data.client_id}`,{method:"POST",body:JSON.stringify({token:S})}).then(e=>e.json()).then(e=>{d(!1);let t=e[e.findIndex(e=>"course_curriculum"==e.id)].fields,a=t[t.findIndex(e=>"curriculum"==e.type)].curriculum_elements,s=a[a.findIndex(e=>"quiz"==e.type)].types[0];g(s.fields[s.fields.findIndex(e=>"quiz_questions"==e.type)].buttons.question_types)})},[]);const X=(e,t)=>{if(console.log(e,t),"fieldvaluechanged"==t){let t=[...B];t[t.findIndex(t=>t.id==e.field.id)]=e.field,$(t)}},Q=(e,t)=>{if(t.hasOwnProperty("_cell")){let e=t._cell.column.field,i=t._cell.row.data.id,o=K(p,i);if(o>=0){if("edit"==e){if(t._cell.row.data.raw_type){f.findIndex(e=>e.value==t._cell.row.data.raw_type)>-1&&($(f[f.findIndex(e=>e.value==t._cell.row.data.raw_type)].fields),a=i,s=t._cell.row.data.raw_type,n=f[f.findIndex(e=>e.value==t._cell.row.data.raw_type)].fields,fetch(window.wplms_create_course_data.api_url+"/curriculum/getElementFields/",{method:"post",body:JSON.stringify({type:s,id:a,fields:n,token:S})}).then(e=>e.json()).then(e=>{e.status&&($(e.fields),z("edit"))}))}}else"delete"==e&&z("delete");J({action:e,id:i,index:o,type:t._cell.row.data.raw_type})}}var a,s,n},K=(e,t)=>{if(e.length)for(var a=e.length-1;a>=0;a--)if(e[a].id==t)return a;return-1};sf(()=>{if(!c&&p&&p.length&&u&&u.length&&"function"==typeof Tabulator&&t){let s=[...u];if(s&&u.length)for(var e=s.length-1;e>=0;e--)-1!==["edit","delete"].indexOf(s[e].field)&&(s[e].cellClick=Q,s[e].download=!1,s[e].sorter=!1);var a=new Tabulator(t.current,{});a=new Tabulator(t.current,{data:p,layout:"fitDataStretch",layoutColumnsOnNewData:!0,columns:s}),O(a)}},[p,u,c,t]);const G=(e,t,a)=>{let s=e.field,n={...F};if("taxonomy"==s.type){let e=n.taxonomy.findIndex(e=>e.taxonomy==s.taxonomy);-1==e?n.taxonomy.push({taxonomy:s.taxonomy,value:s.value}):n.taxonomy[e].value=s.value}else{if("post_content"==s.id&&s.value.length)return void L({post_content:s.value,raw:s.raw});if("vibe_question_explaination"==s.id&&s.value.length)return void A({meta_key:"vibe_question_explaination",meta_value:s.value,raw:s.raw});if("post"==s.from&&(n[s.id]=s.value),"meta"==s.from)if("duration"==s.type){let e=n.meta.findIndex(e=>e.meta_key==s.id);e>-1?n.meta[e].meta_value=s.value.value:n.meta.push({meta_key:s.id,meta_value:s.value.value});let t=n.meta.findIndex(e=>e.meta_key==s.id+"_parameter");t>-1?n.meta[t].meta_value=s.value.parameter:n.meta.push({meta_key:s.id,meta_value:s.value.parameter})}else{let e=n.meta.findIndex(e=>e.meta_key==s.id);e>-1?n.meta[e].meta_value=s.value:n.meta.push({meta_key:s.id,meta_value:s.value}),"editor"==s.type&&s.hasOwnProperty("raw")&&(e=n.meta.findIndex(e=>e.meta_key==s.id+"_raw"),e>-1?n.meta[e].meta_value=s.raw:n.meta.push({meta_key:s.id+"_raw",meta_value:s.raw}))}}D(n)};return tf("div",{className:"wplms_manage_question_wrapper"},E?tf("div",{className:"question_pop_wrapper"},tf("span",{onClick:()=>z(!1)}),tf("div",{className:"question_pop"},"create"==E?tf("div",{className:"question_wrapper"},F.meta.findIndex(e=>"vibe_question_type"==e.meta_key)>-1?tf("div",{className:"question_type_wrapper"},f.map((e,t)=>tf("div",{className:e.value==F.meta[F.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value?"question_type active":"question_type",onClick:()=>{let t={...F},a=t.meta.findIndex(e=>"vibe_question_type"==e.meta_key);t.meta[a].meta_value=e.value,D(t)}},tf("span",null,e.value==F.meta[F.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value?oa(e.value,"#00A1FF","#fff"):oa(e.value,"#fff","#222")),tf("span",null,e.label)))):"",F.meta[F.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value.length?tf(nf,null,f[f.findIndex(e=>e.value==F.meta[F.meta.findIndex(e=>"vibe_question_type"==e.meta_key)].meta_value)].fields.map((e,t)=>tf(Zd,{field:e,fieldIndex:t,update:G,tabIndex:0})),tf("div",{className:"question_actions"},tf("a",{onClick:()=>{if(F.post_title.length){M(!0);let e={...F};H.meta_value.length&&(e.meta.push({meta_key:H.meta_key,meta_value:H.meta_value}),e.meta.push({meta_key:H.meta_key+"_raw",meta_value:H.raw})),fetch(window.wplms_create_course_data.api_url+"/createElement/question",{method:"post",body:JSON.stringify({...e,...j,token:cf("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(M(!1),console.log(e),e.status){console.log(e);let t=[...p];t.push({id:e.data.id,title:e.data.text,type:e.data.type,correct_count:0,total:0,flag:0,tags:[]}),D(df),v(t),z(!1),C&&C.replaceData(t)}})}else lf("vibebp").addNotification({text:window.wplms_create_course_data.translations.missing_data})},className:T?"button is-primary is-loading":"button is-primary"},tf("i",{class:"vicon vicon-plus"}),window.wplms_create_course_data.translations.add_cpt.question.create),tf("a",{className:"link",onClick:()=>{z(!1),D(df)}},window.wplms_create_course_data.translations.cancel))):""):"edit"==E?tf("div",{className:"edit_question"},tf("div",{className:"question_wrapper"},tf("div",{className:"list-group"},B.map((e,t)=>tf("div",{className:"list-group-item"},tf(Zd,{field:e,fieldIndex:t,tabIndex:0,update:X})))),tf("div",{className:"question_actions"},tf("a",{className:U?"button is-primary is-loading":"button is-primary",onClick:()=>{V(!0);let e={post_title:"",post_content:"",meta:[],taxonomy:[]};B.map(t=>{if("post"==t.from)if("post_content"==t.id){if(e[t.id]=t.value,t.hasOwnProperty("raw")&&t.raw){let a=e.meta.findIndex(e=>"raw"==e.meta_key);a>-1?e.meta[a].meta_value=t.raw:e.meta.push({meta_key:"raw",meta_value:t.raw})}}else e[t.id]=t.value;if("meta"==t.from){let a=e.meta.findIndex(e=>e.meta_key==t.id);if(a>-1?e.meta[a].meta_value=t.value:e.meta.push({meta_key:t.id,meta_value:t.value}),"editor"==t.type&&t.hasOwnProperty("raw")){let a=e.meta.findIndex(e=>e.meta_key==t.id+"_raw");a>-1?e.meta[a].meta_value=t.raw:e.meta.push({meta_key:t.id+"_raw",meta_value:t.raw})}}if("taxonomy"==t.from){let a=e.taxonomy.findIndex(e=>e.taxonomy==t.id);a>-1?e.taxonomy[a].value=t.value:e.taxonomy.push({taxonomy:t.id,value:t.value})}}),fetch(window.wplms_create_course_data.api_url+"/createElement/question",{method:"post",body:JSON.stringify({type:R.type,id:R.id,...e,token:cf("vibebp").getToken()})}).then(e=>e.json()).then(t=>{if(V(!1),t.status){lf("vibebp").addNotification({text:t.text});let a=[...p];a[R.index].title=e.post_title,v(a)}})}},window.wplms_create_course_data.translations.save),tf("a",{className:"link",onClick:()=>{z(!1)}},window.wplms_create_course_data.translations.cancel)))):"delete"==E?tf("div",{className:"edit_question"},tf("div",{className:"question_wrapper"},window.wplms_course_data.translations.sure_delete,tf("div",{className:"question_actions"},tf("a",{className:U?"button is-primary is-loading":"button is-primary",onClick:()=>{V(!0),fetch(`${window.wplms_create_course_data.api_url}/deleteElement/${R.id}`,{method:"post",body:JSON.stringify({token:cf("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(V(!1),e.status){lf("vibebp").addNotification({text:e.text});let t=[...p];t.splice(R.index,1),v(t),z(!1)}})}},window.wplms_course_data.translations.delete),tf("a",{className:"link",onClick:()=>{z(!1)}},window.wplms_course_data.translations.cancel)))):"download"==E?tf("div",{className:"import_questions"},tf("h3",null,window.wplms_course_data.translations.select_questions_download),tf("br",null),tf("select",{value:q,onChange:e=>P(e.target.value)},tf("option",null,window.wplms_course_data.translations.select_questions_filetype),window.wplms_course_data.sample_questions.map(e=>tf("option",{value:e.value},e.label))),q?tf("a",{href:q,_target:"_blank",className:"button is-primary"},window.wplms_course_data.translations.download_questions," ",tf("span",{className:"vicon vicon-arriw-right"})):""):"import"==E?tf("div",{className:"import_questions"},tf("h3",null,window.wplms_course_data.translations.import_questions),tf("select",{value:q,onChange:e=>P(e.target.value)},tf("option",null,window.wplms_course_data.translations.select_questions_filetype),window.wplms_course_data.sample_questions.map(e=>tf("option",{value:e.value},e.label))),tf("input",{type:"file",id:"import_questions",ref:a,type:"file",onChange:e=>{a.current.files[0].size<window.vibebp.settings.upload_limit?(l(a.current.files[0]),n(!0)):lf("vibebp").addNotification({text:window.vibebp.translations.image_size_error})}}),tf("label",{for:"import_questions"},window.wplms_course_data.translations.upload_file),s?tf("span",null,tf("a",{className:i?"button is-primary is-loading":"button is-primary",onClick:()=>{o(!0);let e={token:cf("vibebp").getToken(),questionType:q};var t=new FormData;t.append("body",JSON.stringify(e)),t.append("file",r),fetch(window.wplms_course_data.api_url+"/instructor/import_questions",{method:"post",body:t}).then(e=>e.json()).then(e=>{o(!1),e.status&&(w({...df}),z(!1),D(df)),e.hasOwnProperty("message")&&lf("vibebp").addNotification({text:e.message})})}},window.wplms_course_data.translations.upload_file),tf("span",{className:"link",onClick:()=>{l("")}},window.wplms_course_data.translations.cancel)):""):"")):"",tf(nf,null,tf("div",{className:"mycourses_header vibebp_form"},tf("div",null,tf("div",{className:"vibebp_form_field"},tf("input",{type:"text",placeholder:window.vibebp.translations.search_text,value:h.s,onChange:e=>{w({...h,s:e.target.value,paged:1})}}),tf("span",{className:"vicon vicon-search"}))),tf("select",{value:h.orderby,onChange:e=>{w({...h,orderby:e.target.value,paged:1})}},tf("option",null,window.vibebp.translations.select_option),Object.keys(window.wplms_course_data.orderby).map(e=>tf("option",{value:e},window.wplms_course_data.orderby[e])))),tf("div",{className:"vibebp_questions"},tf("div",{class:"buttons has-addons"},tf("a",{class:"button is-primary",onClick:()=>z("create")},tf("span",{className:"vicon vicon-plus"}),window.wplms_course_data.translations.add_question),tf("a",{class:"button is-primary",onClick:()=>{C&&C.download("csv","questions.csv",{delimiter:","})}},tf("span",{className:"vicon vicon-cloud-down"}),window.wplms_course_data.translations.export_questions),tf("a",{class:"button is-primary",onClick:()=>z("import")},tf("span",{className:"vicon vicon-cloud-up"}),window.wplms_course_data.translations.import_questions),tf("a",{onClick:()=>z("download"),class:"button is-primary"},tf("span",{className:"vicon vicon-download"}),window.wplms_course_data.translations.download_sample)),p&&p.length?tf(nf,null,tf("div",{ref:t}),c?tf(tl,null):k?tf("a",{className:"link",onClick:()=>{b(!0),x(!1),w({...h,paged:parseInt(h.paged)+1})}},window.wplms_course_data.translations.load_more):""):tf("div",{className:"vbp_message"},N))))};const{createElement:mf,useState:pf,useEffect:_f,Fragment:vf,render:hf}=wp.element,{dispatch:wf,select:ff}=wp.data;var gf=e=>{const[t,a]=pf(!1),[s,n]=pf(0),[i,o]=pf(e.types),[r,l]=pf([]),[c,d]=pf({post_title:"",post_content:"",type:"",taxonomy:[],meta:[]}),[u,m]=pf({post_content:"",raw:[]}),[p,_]=pf(!1);_f(()=>{e.hasOwnProperty("type")&&n(e.type)},[]),_f(()=>{e.id&&e.type&&(a(!0),fetch(window.wplms_create_course_data.api_url+"/curriculum/getElementFields",{method:"post",body:JSON.stringify({type:s,id:e.id,fields:i[i.findIndex(t=>t.id==e.type)].fields,token:ff("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(e.status){if(Array.isArray(e.fields)){l(e.fields);let t={post_title:"",post_content:"",type:"",taxonomy:[],meta:[]};new Promise(a=>{e.fields.map((s,n)=>{if("taxonomy"==s.type){let e=t.taxonomy.findIndex(e=>e.taxonomy==s.taxonomy);-1==e?t.taxonomy.push({taxonomy:s.taxonomy,value:s.value}):t.taxonomy[e].value=s.value}if("meta"==s.from)if(f(s.value)&&!f(s.default)&&(s.value=s.default),"duration"==s.type){let e=t.meta.findIndex(e=>e.meta_key==s.id);e>-1?t.meta[e].meta_value=s.value.value:t.meta.push({meta_key:s.id,meta_value:s.value.value});let a=t.meta.findIndex(e=>e.meta_key==s.id+"_parameter");a>-1?t.meta[a].meta_value=s.value.parameter:t.meta.push({meta_key:s.id+"_parameter",meta_value:s.value.parameter})}else{let e=t.meta.findIndex(e=>e.meta_key==s.id);e>-1?t.meta[e].meta_value=s.value:t.meta.push({meta_key:s.id,meta_value:s.value}),"editor"==s.type&&s.hasOwnProperty("raw")&&(e=t.meta.findIndex(e=>e.meta_key==s.id+"_raw"),e>-1?t.meta[e].meta_value=s.raw:t.meta.push({meta_key:s.id+"_raw",meta_value:s.raw}))}"post"==s.from&&("post_content"==s.id?m({value:s.value,raw:s.raw}):t[s.id]=s.value),n==e.fields.length-1&&a()})}).then(()=>{console.log(t),a(!1),d(t)})}}else a(!1)}))},[e.id]);const v=(e,t=null)=>{let a={...c},s={};if(s=e.hasOwnProperty("field")?e.field:e,"taxonomy"==s.type){let e=a.taxonomy.findIndex(e=>e.taxonomy==s.taxonomy);-1==e?a.taxonomy.push({taxonomy:s.taxonomy,value:s.value}):a.taxonomy[e].value=s.value}if("meta"==s.from)if("duration"==s.type){let e=a.meta.findIndex(e=>e.meta_key==s.id);e>-1?a.meta[e].meta_value=s.value.value:a.meta.push({meta_key:s.id,meta_value:s.value.value});let t=a.meta.findIndex(e=>e.meta_key==s.id+"_parameter");t>-1?a.meta[t].meta_value=s.value.parameter:a.meta.push({meta_key:s.id+"_parameter",meta_value:s.value.parameter})}else{let e=a.meta.findIndex(e=>e.meta_key==s.id);e>-1?a.meta[e].meta_value=s.value:a.meta.push({meta_key:s.id,meta_value:s.value}),"editor"==s.type&&s.hasOwnProperty("raw")&&(e=a.meta.findIndex(e=>e.meta_key==s.id+"_raw"),e>-1?a.meta[e].meta_value=s.raw:a.meta.push({meta_key:s.id+"_raw",meta_value:s.raw}))}if("post"==s.from){if("post_content"==s.id)return void m({value:s.value,raw:s.raw});a[s.id]=s.value}console.log(a),d(a)};return mf("div",{className:"add_cpt_wrapper"},t?mf(tl,null):s?mf(vf,null,r.map((t,a)=>mf(Zd,{field:t,fieldIndex:a,tabIndex:e.tabIndex,update:v})),mf("span",{className:"element_actions"},mf("a",{className:p?"button is-primary is-loading":"button is-primary",onClick:()=>{if(!f(c)){_(!0),e.id&&(c.id=e.id);let t=c.meta.findIndex(e=>"vibe_type"==e.id);-1==t?c.meta.push({meta_key:"vibe_type",meta_value:s}):c.meta[t]={meta_key:"vibe_type",meta_value:s},fetch(window.wplms_create_course_data.api_url+"/createElement/assignment",{method:"post",body:JSON.stringify({...c,post_content:u.value,raw:u.raw,token:ff("vibebp").getToken()})}).then(e=>e.json()).then(t=>{_(!1),t.status?(a(!0),fetch(window.wplms_course_data.api_url+"/instructor/assignment",{method:"post",body:JSON.stringify({assignment_id:t.data.id,token:ff("vibebp").getToken()})}).then(e=>e.json()).then(t=>{a(!1),t.status?e.show(t.assignment):t.hasOwnProperty("message")&&wf("vibebp").addNotification({text:t.message})})):t.hasOwnProperty("message")&&wf("vibebp").addNotification({text:t.message})})}}},window.wplms_create_course_data.translations.add_cpt.assignment.add),mf("a",{className:"link",onClick:e.back},window.wplms_create_course_data.translations.cancel))):i.map(e=>mf("div",{className:s?"add_cpt_type active":"add_cpt_type",onClick:()=>{n(e.id),l(i[i.findIndex(t=>t.id==e.id)].fields)}},mf("span",{className:e.icon}),e.label)))};const{createElement:yf,useState:bf,useEffect:kf,Fragment:xf,render:Nf}=wp.element,{dispatch:If,select:Cf}=wp.data;var Of=e=>{const[t,a]=bf(!1),[s,n]=bf([]),[i,o]=bf({paged:1,orderby:"date",order:"DESC",s:""}),[r,l]=bf(!1),[c,d]=bf(!1),[u,m]=bf(""),[p,v]=bf(!1),[h,w]=bf(!1),[f,g]=bf([]),[y,b]=bf("stats"),k=(Cf("vibebp").getUser(),Cf("vibebp").getToken()),[x,N]=bf(null);_(()=>{a(!0),x&&x.abort();let e={},t=new AbortController;x&&(e={signal:t.signal}),N(t),fetch(window.wplms_course_data.api_url+"/instructor/assignments",{method:"POST",...e,body:JSON.stringify({...i,token:k})}).then(e=>e.json()).then(e=>{if(a(!1),N(null),e.status)if(r){let t=[...s];e.assignments.length&&(e.assignments.map((e,a)=>{t.push(e)}),n(t)),t.length<e.total&&d(!0)}else n(e.assignments),e.assignments.length<e.total&&d(!0);else m(e.message)}).catch(e=>{"AbortError"===e.name?a(!0):console.error("Uh oh, an error!",e)})},500,[i]),kf(()=>{a(!0),fetch(`${window.wplms_course_data.api_url}/gettabs/0?client_id=${window.wplms_course_data.client_id}`,{method:"POST",body:JSON.stringify({token:k})}).then(e=>e.json()).then(e=>{a(!1);let t=e[e.findIndex(e=>"course_curriculum"==e.id)].fields,s=t[t.findIndex(e=>"curriculum"==e.type)].curriculum_elements;g(s[s.findIndex(e=>"assignment"==e.type)].types)})},[]);return yf("div",{className:"wplms_manage_quizzes_wrapper"},h?yf(gf,{back:()=>w(!1),show:e=>{w(!1);let t=[...s],a=t.findIndex(t=>t.id==e.id);-1==a?t.unshift(e):t[a]=e,n(t)},types:f,id:p,type:s.findIndex(e=>e.id==p)>-1?s[s.findIndex(e=>e.id==p)].type:0}):p?yf("div",{className:"course_manage quiz_wrapper"},yf("div",{className:"quiz_header"},yf("span",{className:"header_links"},yf("span",{className:"vicon vicon-arrow-left",onClick:()=>{w(!1),v(!1)}}),yf("span",null,yf("span",{className:"vicon vicon-pencil",onClick:()=>{w(p)}}),yf("span",{className:"vicon vicon-trash",onClick:()=>{window.confirm(window.wplms_course_data.translations.confirm_delete_assignment)&&(a(!0),fetch(window.wplms_course_data.api_url+"/instructor/deleteAssignment",{method:"POST",body:JSON.stringify({assignment_id:p,token:k})}).then(e=>e.json()).then(e=>{if(a(!1),e.status){w(!1),v(!1);let e=[...s];e.splice(e.findIndex(e=>e.id==p),1),n(e)}e.hasOwnProperty("message")&&If("vibebp").addNotification({text:e.message})}))}}))),yf("h2",null,s[s.findIndex(e=>e.id==p)].title),yf("div",{className:"quiz_info"},yf("div",null,yf("span",null,yf("span",{className:"vicon vicon-calendar"})," ",s[s.findIndex(e=>e.id==p)].created),yf("div",{className:"wplms_quiz-type"},s[s.findIndex(e=>e.id==p)]["assignment-type"].length?s[s.findIndex(e=>e.id==p)]["assignment-type"].map(e=>yf("span",null,e)):"")),yf("div",null,yf("span",null,yf("span",{className:"vicon vicon-user"})," ",s[s.findIndex(e=>e.id==p)].attempts),yf("span",null,yf("span",{className:"vicon vicon-timer"})," ",yf(Ct,{timestamp:s[s.findIndex(e=>e.id==p)].timer})),yf("span",null,yf("span",{className:"vicon vicon-cup"})," ",s[s.findIndex(e=>e.id==p)].marks)))),yf("div",{className:"course_tabs"},yf("div",{className:"instructor_tabs"},yf("span",{className:"stats"==y?"active":"",onClick:()=>b("stats")},window.wplms_course_data.translations.statistics),yf("span",{className:"activity"==y?"active":"",onClick:()=>b("activity")},window.wplms_course_data.translations.activity),yf("span",{className:"submissions"==y?"active":"",onClick:()=>b("submissions")},window.wplms_course_data.translations.submissions),yf("span",{className:"view"==y?"active":"",onClick:()=>b("view")},window.wplms_course_data.translations.view))),yf("div",{className:"course_tab_content"},"stats"==y?yf(Lw,{cpt:"assignment",id:p}):"activity"==y?yf(Vw,{id:p,cpt:"assignment"}):"submissions"==y?yf(Pv,{id:p,type:"assignment",statuses:window.wplms_course_data.course.submission_assignment_statuses}):yf($l,{assignment:{id:p},update:()=>{}}))):yf(xf,null,yf("div",{className:"mycourses_header vibebp_form"},yf("div",null,yf("div",{className:"vibebp_form_field"},yf("input",{type:"text",placeholder:window.vibebp.translations.search_text,value:i.s,onChange:e=>{o({...i,s:e.target.value})}}),yf("span",{className:"vicon vicon-search"}))),yf("select",{value:i.orderby,onChange:e=>{o({...i,orderby:e.target.value})}},yf("option",null,window.vibebp.translations.select_option),Object.keys(window.wplms_course_data.orderby).map(e=>yf("option",{value:e},window.wplms_course_data.orderby[e])))),t?yf(tl,null):yf("div",{className:"vibebp_quizzes"},yf("div",{class:"new_quiz",onClick:()=>w(!0)},yf("i",{class:"vicon vicon-plus"})),s.length?s.map(e=>yf("div",{className:"wplms_quiz",onClick:()=>v(e.id)},yf("div",null,yf("h3",null,yf("span",{className:"static"==e.type?"vicon vicon-exchange-vertical":"vicon vicon-control-shuffle"})," ",e.title),yf("span",null,e.created),yf("div",{className:"wplms_quiz-type"},e["assignment-type"].length?e["assignment-type"].map(e=>yf("span",null,e)):"")),yf("div",{className:"quiz_meta"},yf("span",null,yf("span",{className:"vicon vicon-user"})," ",e.attempts),yf("span",null,yf("span",{className:"vicon vicon-time"})," ",e.timer),yf("span",null,yf("span",{className:"vicon vicon-medall-alt"})," ",e.marks)))):yf("div",{className:"vbp_message"},u),c?yf("a",{className:"link",onClick:()=>{l(!0),d(!1),o({...i,paged:i.paged+1})}},window.wplms_course_data.translations.load_more):"")))};const{createElement:Sf,useState:qf,useEffect:Pf,Fragment:Ef,render:zf,useRef:Tf}=wp.element,{dispatch:Mf,select:jf}=wp.data;var Lf=e=>{var t=Tf();const[a,s]=qf(!1),[n,i]=qf(!1),[o,r]=qf(!1),[l,c]=qf([]),[d,u]=qf([]),[m,p]=qf({}),[v,h]=qf({s:"",paged:1,id:"",orderby:"",order:"DESC",per_page:20}),[w,g]=qf(!0),[y,b]=qf(!1),[k,x]=qf(""),[N,I]=qf([]),[C,O]=qf(""),[S,q]=qf(null),P=jf("vibebp").getToken(),[E,z]=qf(null);Pf(()=>{s(!0),E&&E.abort();let e={},t=new AbortController;E&&(e={signal:t.signal}),z(t),fetch(window.wplms_course_data.api_url+"/instructor/manageStudents/getTabs",{method:"POST",...e,body:JSON.stringify({token:P})}).then(e=>e.json()).then(e=>{s(!1),z(null),e.status?(I(e.tabs),O(e.tabs[0].key),e.tabs[0].items.length&&h({...v,id:e.tabs[0].items[0].id})):Mf("vibebp").addNotification({text:e.message})}).catch(e=>{"AbortError"===e.name?s(!0):console.error("Uh oh, an error!",e)})},[]),Pf(()=>{if(!n&&l&&l.length&&"function"==typeof Tabulator&&d&&d.length){let s=[...d];if(s&&s.length)for(var e=s.length-1;e>=0;e--)-1!==["change_marks","change_status","remove_user"].indexOf(s[e].field)&&(s[e].cellClick=T,s[e].download=!1,s[e].sorter=!1);var a=new Tabulator(t.current,{});a=new Tabulator(t.current,{data:l,layout:"fitDataStretch",layoutColumnsOnNewData:!0,columns:s}),q(a)}},[l,d,n]);const T=(e,t)=>{if(t.hasOwnProperty("_cell")){let e=t._cell.column.field,a=window.wplms_course_data.translations[e],s=t._cell.row.data.id;console.log(l);let n=((e,t)=>{if(e.length)for(var a=e.length-1;a>=0;a--)if(e[a].id==t)return a;return-1})(l,s);console.log(n),n>=0&&p({item_id:v.id,label:a,action:e,student:s,index:n,data:t._cell.row.data})}};return _(()=>{if(!f(C)&&v.id){i(!0),E&&E.abort();let e={},t=new AbortController;E&&(e={signal:t.signal}),z(t),fetch(window.wplms_course_data.api_url+"/instructor/manageStudents/fetchTab",{method:"POST",...e,body:JSON.stringify({tab:C,args:v,token:P})}).then(e=>e.json()).then(e=>{if(z(null),e.status)if(v.paged>1){let t=[...l];e.students.length&&e.students.map((a,s)=>{e.students[s].status=window.wplms_course_data.course.admin.statuses[e.students[s].status],t.push(e.students[s])}),c(t),e.students.length<v.per_page&&g(!1)}else e.students.length&&(e.students.map((t,a)=>{e.students[a].status=window.wplms_course_data.course.admin.statuses[t.status]}),c(e.students)),e.students.length<v.per_page&&g(!1),u(e.columns);else 1==parseInt(v.paged)&&c([]),Mf("vibebp").addNotification({text:e.message}),g(!1);i(!1)}).catch(e=>{"AbortError"===e.name?i(!0):console.error("Uh oh, an error!",e)})}},500,[v,C]),Sf("div",{className:"instructor_students"},a?Sf(tl,null):Sf("div",{className:"course_manage"},Sf("div",{className:"course_tabs"},Sf("div",{className:"instructor_tabs"},N.length?N.map(e=>Sf("span",{className:C==e.key?"active":"",onClick:()=>{O(e.key),e.items.length&&(g(!0),h({...v,id:e.items[0].id}))}},e.label)):"")),Sf("div",{className:"course_tab_content_wrapper"},Sf("div",{className:"course_tab_content_header"},N.length&&N.findIndex(e=>e.key==C)>-1&&N[N.findIndex(e=>e.key==C)].items.length?Sf("select",{value:v.id,onChange:e=>{g(!0),h({...v,id:e.target.value,paged:1,s:""})}},N[N.findIndex(e=>e.key==C)].items.map(e=>Sf("option",{value:e.id},e.title))):"",Sf("div",{className:"vibebp_form_field"},Sf("input",{type:"text",value:v.s,placeholder:window.wplms_course_data.translations.search_student,onChange:e=>{g(!0),h({...v,s:e.target.value,paged:1})}})),Sf("div",{className:"sort_order"},Sf("select",{value:v.orderby,onChange:e=>{h({...v,orderby:e.target.value})}},Object.keys(window.wplms_course_data.orderby).map(e=>Sf("option",{value:e},window.wplms_course_data.orderby[e]))),Sf("span",null,Sf("span",{className:"ASC"==v.order?"active vicon vicon-angle-up":"vicon vicon-angle-up",onClick:()=>h({...v,order:"ASC"})}),Sf("span",{className:"DESC"==v.order?"active vicon vicon-angle-down":"vicon vicon-angle-down",onClick:()=>h({...v,order:"DESC"})})))),Sf("div",{className:"course_tab_content"},n?Sf(tl,null):l.length?Sf(Ef,null,Sf("div",{ref:t}),w?Sf("a",{className:" button",onClick:()=>{h({...v,paged:v.paged+1})}},window.wplms_course_data.translations.load_more):null,Sf("a",{className:"download button is-primary",onClick:()=>{S&&!a&&l&&l.length&&S.download("csv","dataStudents.csv",{delimiter:","})}},window.wplms_course_data.translations.download),m&&Object.keys(m).length?Sf("div",{className:"change_data_wrapper"},Sf("div",{className:"change_data_content"},Sf("h2",null,m.label),m.hasOwnProperty("action")&&m.action.length?(()=>{switch(console.log(m),m.action){case"change_marks":return Sf("input",{type:"number",onChange:e=>{let t={...m};t.data.marks=e.target.value,p(t)},value:m.data.marks});case"change_status":return Sf(Ef,null,Sf("select",{onChange:e=>{let t={...m};t.data.status=e.target.value,p(t)}},window.wplms_course_data.course.admin.statuses.map((e,t)=>Sf("option",{selected:m.data.status==t||window.wplms_course_data.course.admin.statuses.indexOf(m.data.status)==t,value:t},e))),4==m.data.status||4==window.wplms_course_data.course.admin.statuses.indexOf(m.data.status)?Sf("input",{type:"number",onChange:e=>{let t={...m};t.data.marks=e.target.value,p(t)},value:m.data.marks}):"");default:return""}})():"",Sf("div",{className:"popup-footer"},Sf("button",{className:"button primary",onClick:()=>{fetch(window.wplms_course_data.api_url+"/instructor/manageStudents/changedata",{method:"POST",body:JSON.stringify({...m,token:P})}).then(e=>e.json()).then(e=>{if(e.status&&e.hasOwnProperty("data")){if("remove_user"!=m.action){let t=[...l];m.data.status=window.wplms_course_data.course.admin.statuses[e.data.status],t[m.index]=m.data,c(t),S.setData(t),p({})}else{let e=[...l];e.splice(m.index,1),c(e),S.setData(e),p({})}Mf("vibebp").addNotification({text:e.message})}else Mf("vibebp").addNotification({text:e.message})})}},window.wplms_course_data.translations.ok),Sf("button",{className:"button",onClick:()=>{p({})}},window.wplms_course_data.translations.cancel)))):""):k.length?Sf("div",{className:"vbp_message"},k):""))))};const{createElement:Hf,useState:Af,useEffect:Ff,Fragment:Df,render:Rf}=wp.element,{dispatch:Jf,select:Bf}=wp.data;var $f=e=>{const[t,a]=Af({post_title:"",meta:[]}),[s,n]=Af([]),[i,o]=Af([]),[r,l]=Af(!1),[c,d]=Af(!1),[u,m]=Af(!1),[p,_]=Af({}),[v,h]=Af({start:[],end:[]}),[w,g]=Af(!1),[y,b]=Af([]);Bf("vibebp").getToken();Ff(()=>{},[e.id]);return console.log("--",y,p),Hf("div",{className:"new_report_wrapper"},Hf("span",{className:"vicon vicon-arrow-left",onClick:e.back}),Hf("div",{className:"vibebp_form"},Hf("div",{className:"vibebp_form_field"},Hf("h3",null,window.wplms_course_data.translations.report_title),Hf("input",{type:"text",value:t.post_title,placeholder:window.wplms_course_data.translations.report_title,onChange:e=>{a({...t,post_title:e.target.value})}})),Hf("h3",null,window.wplms_course_data.translations.report_steps),Hf("div",{className:"report_steps_wrapper",ref:e=>{!w&&e&&g(e.getBoundingClientRect())}},s.length?s.map((e,t)=>{let a={};return e.hasOwnProperty("filterParent")&&(a=window.wplms_course_data.reports.properties[e.filterParent]),Hf(Df,null,t>0&&void 0!==v.end[t-1]&&void 0!==v.start[t]?Hf("svg",{width:"100%",height:"100%"},Hf("line",{x1:v.end[t-1].x-w.x+12,y1:v.end[t-1].y-w.y+12,x2:v.start[t].x-w.x,y2:v.start[t].y-w.y,stroke:"black"})):"",Hf("div",{className:"wplms_reports_block"},r||t!=s.length-1?"":Hf("span",{className:"vicon vicon-close",onClick:()=>{let e=[...s];e.splice(t,1),n(e)}}),t>0?Hf("span",{ref:e=>{if(e&&void 0===v.start[t]){let a={...v};a.start[t]=e.getBoundingClientRect(),h(a)}},className:"start_connector_dot"}):"",Hf("h4",null,Hf("span",null,window.wplms_course_data.translations.step," ",t+1),e.hasOwnProperty("filterParent")?window.wplms_course_data.reports.module[e.filterParent]+" "+a[a.findIndex(t=>t.key==e.id)].label:e.hasOwnProperty("sortParent")?window.wplms_course_data.reports.module[e.filterParent]+" "+window.wplms_course_data.translations[e.sort]:window.wplms_course_data.reports.module[e.id]),e.items.length?Hf("div",{className:"selected_items"},e.items.map(t=>e.hasOwnProperty("filterParent")?Hf("span",null,a[a.findIndex(t=>t.key==e.id)].values[t]):Hf("span",null,window.wplms_course_data.reports.properties[e.id][window.wplms_course_data.reports.properties[e.id].findIndex(e=>e.key==t)].label))):"",t<s.length?Hf("span",{ref:e=>{if(e&&void 0===v.end[t]){let a={...v};a.end[t]=e.getBoundingClientRect(),h(a)}},className:"end_connector_dot"}):""))}):"",r?Hf("div",{className:"wplms_reports_block"},Hf("span",{className:"vicon vicon-close",onClick:()=>{l(!1),_({})}}),!p.hasOwnProperty("type")&&s.length?Hf("select",{onChange:e=>{_({id:0,type:e.target.value,items:[]})}},Hf("option",null,window.wplms_course_data.translations.select_option),Hf("option",{value:"module"},window.wplms_course_data.translations.module),Hf("option",{value:"filter"},window.wplms_course_data.translations.filter),Hf("option",{value:"sorter"},window.wplms_course_data.translations.sorter)):Hf(Df,null,s.length&&"module"==p.type?Hf("select",{value:f(p)?"":p.module,onChange:e=>{_({id:e.target.value,type:"module",items:[]})}},Hf("option",null,window.wplms_course_data.translations.select_option),Object.keys(window.wplms_course_data.reports.secondary).map(e=>Hf("option",{value:e},window.wplms_course_data.reports.module[e]))):"module"!=p.type&&s.length?"filter"==p.type?Hf("div",{className:"report_filter"},Hf("select",{onChange:e=>{let t=e.target.value.split("--"),a=window.wplms_course_data.reports.properties[t[0]][window.wplms_course_data.reports.properties[t[0]].findIndex(e=>e.key==t[1])];_({...p,id:a.key,filterParent:t[0],max:a.multiple}),a.hasOwnProperty("values")&&"fetch"!=a.values?b(a.values):fetch(window.wplms_create_course_data.api_url+"/instructor/getReportFilters",{method:"post",body:JSON.stringify({item:a,token:Bf("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.status&&b(e.values)})}},Hf("option",null,window.wplms_course_data.translations.select_option),s.map(e=>{if(e.hasOwnProperty("items")&&e.items.length&&!e.hasOwnProperty("filterParent"))return e.items.map((t,a)=>{let s=window.wplms_course_data.reports.properties[e.id][window.wplms_course_data.reports.properties[e.id].findIndex(e=>e.key==t)];if(s.hasOwnProperty("filterable")&&s.filterable)return Hf("option",{value:e.id+"--"+s.key},window.wplms_course_data.reports[e.type][e.id],s.label)})})),y.length?Hf("div",{className:"addItems"},Hf("div",{className:"selected_items"},p.hasOwnProperty("items")&&p.items.length?p.items.map((e,t)=>Hf("span",{onClick:()=>{let e={...p};e.items.splice(t,1),_(e)}},y[e])):"",p.id?Hf("span",{className:c?"vicon vicon-close":"vicon vicon-plus",onClick:()=>d(!c)}):""),c?Hf("select",{onChange:e=>{let t={...p};-1==t.items.indexOf(e.target.value)&&p.items.length<=t.max&&(t.items.push(e.target.value),_(t),d(!1))}},Hf("option",null,window.wplms_course_data.translations.select_option),Array.isArray(y)?y.map((e,t)=>Hf("option",{value:t},e)):"object"==typeof y?Object.keys(y).map(e=>Hf("option",{value:e},y[e])):""):""):""):"sort"==p.type?Hf("div",{className:"report_sorter"},Hf("select",{onChange:e=>{let t=e.target.value.split("-");_({...p,id:t[1],sortParent:t[0]})}},Hf("option",null,window.wplms_course_data.translations.select_option),s.map(e=>{if(e.hasOwnProperty("items")&&e.items.length&&!e.hasOwnProperty("filterParent"))return e.items.map((t,a)=>{let s=window.wplms_course_data.reports.properties[e.id][window.wplms_course_data.reports.properties[e.id].findIndex(e=>e.key==t)];if(s.hasOwnProperty("filterable")&&s.filterable)return Hf("option",{value:e.id+"--"+s.key},window.wplms_course_data.reports[e.type][e.id],s.label)})})),Hf("select",{onChange:e=>{_({...p,sort:e.target.value})}},Hf("option",null,window.wplms_course_data.translations.select_option),Hf("option",{value:"ASC"},window.wplms_course_data.translations.ASC),Hf("option",{value:"DESC"},window.wplms_course_data.translations.DESC))):"":Hf("select",{value:f(p)?"":p.module,onChange:e=>{_({id:e.target.value,type:"module",items:[]})}},Hf("option",null,window.wplms_course_data.translations.select_option),Object.keys(window.wplms_course_data.reports.module).map(e=>Hf("option",{value:e},window.wplms_course_data.reports.module[e]))),f(p)?"":"module"==p.type?Hf("div",{className:"addItems"},Hf("div",{className:"selected_items"},p.hasOwnProperty("items")&&p.items.length?p.items.map((e,t)=>Hf("span",{onClick:()=>{let e={...p};e.items.splice(t,1),_(e)}},window.wplms_course_data.reports.properties[p.id][window.wplms_course_data.reports.properties[p.id].findIndex(t=>t.key==e)].label)):"",p.id?Hf("span",{className:c?"vicon vicon-close":"vicon vicon-plus",onClick:()=>d(!c)}):""),c?Hf("select",{onChange:e=>{let t={...p};-1==t.items.indexOf(e.target.value)&&(t.items.push(e.target.value),_(t),d(!1))}},Hf("option",null,window.wplms_course_data.translations.select_option),window.wplms_course_data.reports.properties[p.id].map(e=>Hf("option",{value:e.key},e.label))):""):"",Hf("a",{className:"button is-primary",onClick:()=>{if(p.hasOwnProperty("id")&&p.id){let e=[...s];e.push(p),n(e),_({}),l(!1)}}},window.wplms_course_data.translations.add_module))):Hf("a",{className:"add_step",onClick:()=>{l(!0)}},Hf("span",{className:"vicon vicon-plus"})))))};const{createElement:Uf,useState:Vf,useEffect:Wf,Fragment:Yf,render:Xf}=wp.element,{dispatch:Qf,select:Kf}=wp.data;const{createElement:Gf,useState:Zf,useEffect:eg,Fragment:tg,render:ag}=wp.element,{dispatch:sg,select:ng}=wp.data;var ig=e=>{const[t,a]=Zf(!1),[s,n]=Zf([]),[i,o]=Zf({s:"",paged:1,orderby:"",order:"DESC"}),[r,l]=Zf(!1),[c,d]=Zf(!1),[u,m]=Zf(""),[p,v]=Zf(!0),[h,w]=Zf(!1),f=ng("vibebp").getToken();return _(()=>{a(!0),fetch(window.wplms_course_data.api_url+"/instructor/getReports",{method:"POST",body:JSON.stringify({...i,token:f})}).then(e=>e.json()).then(e=>{if(a(!1),e.status)if(h){let t=[...s,...e.reports];n(t),t.length<e.total&&v(!0)}else n(e.reports),e.reports.length<e.total&&v(!0);else m(e.message)})},500,[i]),Gf("div",{className:"instructor_reports"},t?Gf(tl,null):c?Gf($f,{back:()=>d(!1)}):r?Gf(ShowReport,{back:()=>l(!1)}):Gf(tg,null,Gf("div",{className:"mycourses_header"},Gf("div",null,Gf("div",{className:"search vibebp_form_field"},Gf("input",{type:"text",placeholder:window.wplms_course_data.translations.search,value:i.s,onChange:e=>o({...i,s:e.target.value})}),Gf("span",{className:"vicon vicon-search"}))),Gf("div",{className:"orderby"},Gf("select",{value:i.orderby,onChange:e=>{o({...i,orderby:e.target.value})}},Object.keys(window.wplms_course_data.orderby).map(e=>Gf("option",{value:e},window.wplms_course_data.orderby[e]))),Gf("span",null,Gf("span",{className:"ASC"==i.order?"active vicon vicon-angle-up":"vicon vicon-angle-up",onClick:()=>o({...i,order:"ASC"})}),Gf("span",{className:"DESC"==i.order?"active vicon vicon-angle-down":"vicon vicon-angle-down",onClick:()=>o({...i,order:"DESC"})})))),Gf("div",{className:"reports_list"},Gf("div",{className:"new_report",onClick:()=>{d(!0)}},Gf("span",{className:"vicon vicon-plus"})),s.length?Gf(tg,null,retports.map(e=>Gf("div",{className:"report",onClick:()=>l(e)},Gf("h3",null,e.title),Gf(Ct,{timestamp:e.date}))),p?Gf("a",{className:"link",onClick:()=>{o({...i,paged:i.paged+1}),w(!0)}}):""):u.length?Gf("div",{className:"vbp_message"},u):"")))};const{createElement:og,useState:rg,useEffect:lg,Fragment:cg,render:dg}=wp.element,{dispatch:ug,select:mg}=wp.data;var pg=e=>{const[t,a]=rg(!0),[s,n]=rg({paged:1,orderby:"recent",order:"DESC",search_terms:"",per_page:99999}),[i,o]=rg([]),[r,l]=rg(!1),c=window.wplms_course_data.api_url;let d=mg("vibebp").getUser();return d.token=mg("vibebp").getToken(),lg(()=>{a(!0),fetch(c+"/instructor/get_posts/course",{method:"POST",body:JSON.stringify({token:d.token})}).then(e=>e.json()).then(e=>{a(!1),e.hasOwnProperty("posts")&&e.posts&&e.posts.length&&(o(e.posts),l(e.posts[0].id))})},[]),t?og(tl,null):og(cg,null,i.length?og("div",{className:"mycourses_header vibebp_form"},og("select",{className:"courses",onChange:e=>{l(e.target.value)}},i.map((e,t)=>og("option",{value:e.id,selected:r==e.id},e.title)))):og("div",{className:"vbp_message"},window.wplms_course_data.translations.no_courses_found),r?og(tv,{course:r}):"")};const{createElement:_g,useState:vg,useEffect:hg,Fragment:wg,render:fg,useContext:gg}=wp.element,{dispatch:yg,select:bg}=wp.data;var kg=e=>{const t=gg(Ml),[a,s]=vg([]),[n,i]=vg(0);hg(()=>{if(Array.isArray(t.courseStatus.courseitems)&&t.courseStatus.courseitems.length){let e=[...t.courseStatus.courseitems];e=t.courseStatus&&t.courseStatus.filtered_items&&t.courseStatus.filtered_items.length?t.courseStatus.filtered_items:t.courseStatus.courseitems;let a=-1;e.map((e,s)=>{"section"==e.type?a=s:a>-1&&t.current_unit_key==s&&i(a)}),a<0&&i(a),s(e)}},[t.courseStatus.courseitems,t.current_unit_key,t.courseStatus.filtered_items]),hg(()=>{if(Array.isArray(t.courseStatus.courseitems)&&t.courseStatus.courseitems.length){let e=-1,a=[...t.courseStatus.courseitems];a.map((s,n)=>{"section"==s.type?(e=n,a[e].lesson_count=0,a[e].duration=0):e>-1&&(a[e].duration=parseInt(a[e].duration)+parseInt(s.duration),a[e].lesson_count++,a[n].section=e,t.current_unit_key==n&&i(e))}),e<0&&i(e),s(a)}},[t.courseStatus.courseitems]);let o=-1;return _g(wg,null,a?_g("ul",null,a.map((e,s)=>{let r=Math.round(e.duration/60);"section"==e.type&&(o=s);let l=e.type+" "+(e.status?"done":"")+" "+(t.current_unit_key==s?"active":"")+" ";return"section"!=e.type&&n>-1&&(l+=n===o?" open_lesson":" collapsed_lesson"),_g("li",{className:l},_g("p",{onClick:()=>{((e,a)=>{"section"==e.type?i(a):0!=e.id&&(document.querySelector(".course_status").scrollTo({top:0,left:0,behavior:"smooth"}),t.update({index:a},"loadunit"))})(e,e.key)}},e.icon&&e.icon.length>200?_g("span",{dangerouslySetInnerHTML:{__html:e.icon}}):_g("span",{className:e.icon}),_g("span",{className:"lesson_title",dangerouslySetInnerHTML:{__html:e.title}}),"section"==e.type?_g("span",null,_g("span",{className:"lesson_count"},e.lesson_count+" "+window.wplms_course_data.translations.lesson_count),_g("span",{className:"lesson_duration"},r<180?r+" "+window.wplms_course_data.time_labels.minute.symbol:r>999?_g("span",{className:"vicon vicon-infinite"}):Math.round(r/60)+" "+window.wplms_course_data.time_labels.hour.symbol)):_g("span",{className:"lesson_duration"},r>=9999?_g("i",{className:"vicon vicon-infinite"}):r<180?r+" "+window.wplms_course_data.time_labels.minute.symbol:Math.round(r/60)+" "+window.wplms_course_data.time_labels.hour.symbol)),"section"==e.type?_g("i",s===n?{className:"vicon vicon-minus",onClick:()=>i(!1)}:{className:"vicon vicon-plus",onClick:()=>i(s)}):"","section"!=e.type?"unit"===e.type?_g("div",{className:"unit_progress_wrapper",onClick:()=>{((e,a)=>{0==e.id||t.courseStatus.lock||e.status||t.courseStatus.unit_media_lock&&(e.meta.hasOwnProperty("video")&&Array.isArray(e.meta.video)&&e.meta.video.length||"video"==e.unit_type)||t.update({index:a},"directmarkcomplete")})(e,s)}},t.courseStatus.hasOwnProperty("lock")&&t.courseStatus.lock&&!t.courseStatus.courseitems[s].status&&s!=t.current_unit_key?_g("span",{className:"vicon vicon-lock"}):_g(fi,{progress:a[s]&&"unit"==a[s].type&&a[s].hasOwnProperty("progressbar")?a[s].progressbar:0,size:"xs"})):_g("div",{className:"unit_progress_wrapper"},t.courseStatus.hasOwnProperty("lock")&&t.courseStatus.lock&&!t.courseStatus.courseitems[s].status&&s!=t.current_unit_key?_g("span",{className:"vicon vicon-lock"}):_g(fi,{progress:100,size:"xs"})):"")})):_g("div",{class:"message"},window.wplms_course_data.translations.no_content_found))};const{createContext:xg}=wp.element;var Ng=xg({comments:{},update:e=>{}});const{createElement:Ig,useState:Cg,useEffect:Og,Fragment:Sg,render:qg,useContext:Pg}=wp.element,{dispatch:Eg,select:zg}=wp.data,Tg=e=>{const[t,a]=Cg({}),s=Pg(Ng);Og(()=>{a(e.comment)},[e.comment]);const n=e=>{s.update({comment:t},e)},i=zg("vibebp").getUser();return t&&Object.keys(t).length?Ig("li",{className:"unit_comment_wrapper "+(e.disable==t.comment_ID?"disabled":"")},Ig("div",{className:"unit_comment"},t.user?Ig("div",{className:"comment_user"},t.user.avatar?Ig("img",{src:t.user.avatar}):"",t.user.name?Ig("span",{className:"username"},t.user.name):t.user.displayname?Ig("span",{className:"username"},t.user.displayname):Ig("span",{className:"username"},window.wplms_course_data.translations.anonymous)):"",Ig("div",{className:"unit_comment_content"},Ig("div",{className:"unit_comment_header"},Ig("span",null,Ig(Ct,{timestamp:parseInt(t.comment_date)})),e.disable!=t.comment_ID?Ig("div",{className:"comment_actions"},i.id==t.user_id||t.hasOwnProperty("user")&&t.user.id==i.id||Object.keys(i.caps).indexOf("manage_options")>-1?Ig("span",{className:"vicon vicon-pencil",onClick:()=>{n("edit")}}):"","note"!=t.type?Ig("span",{className:"vicon vicon-share",onClick:()=>{n("reply")}}):"",i.id==t.user_id||t.hasOwnProperty("user")&&t.user.id==i.id?Ig(Sg,null,parseInt(t.comment_parent)||"note"==t.type?"":t.question?Ig("span",{className:"vicon vicon-user active tip",title:window.wplms_course_data.translations.instructor_question}):Ig("span",{className:"vicon vicon-user tip",title:window.wplms_course_data.translations.ask_instructor,onClick:()=>{fetch(window.wplms_course_data.api_url+"/student/askQuestion/",{method:"post",body:JSON.stringify({comment:t,unit_id:s.unit_id,course_id:s.course_id,token:zg("vibebp").getToken()})}).then(e=>e.json()).then(e=>{a({...t,question:!0}),e?e.hasOwnProperty("message")&&Eg("vibebp").addNotification({icon:"vicon vicon-user",text:e.message}):e.hasOwnProperty("message")&&Eg("vibebp").addNotification({text:e.message})})}}),i.id==t.user_id||t.hasOwnProperty("user")&&t.user.id==i.id?Ig("span",{className:"vicon vicon-trash",onClick:()=>{n("delete")}}):""):""):""),Ig("div",{dangerouslySetInnerHTML:{__html:t.comment_content}}))),t.child&&t.child.length?Ig("ul",null,t.child.map((t,a)=>Ig(Tg,{comment:t,disable:e.disable}))):""):""};var Mg=Tg;const{createElement:jg,useState:Lg,useEffect:Hg,Fragment:Ag,render:Fg}=wp.element,{dispatch:Dg,select:Rg}=wp.data;var Jg=e=>{const[t,a]=Lg([]),[s,n]=Lg(!1),[i,o]=Lg(0),[r,l]=Lg(!1),[c,d]=Lg(!1),[u,m]=Lg({}),[p,_]=Lg(!0);const v=Rg("vibebp").getUser(),h=Rg("vibebp").getToken(),w={type:e.type,unit_id:e.unit_id,course_id:e.course_id};Hg(()=>{m(w),f()},[e.unit_id]);const f=()=>{i||n(!0),fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${e.unit_id}?page=${i}&per_page=20`,{method:"post",body:JSON.stringify({token:h,type:e.type})}).then(e=>e.json()).then(e=>{if(e){let s=[...t];e.length?(e.map((t,a)=>{s.findIndex(e=>e.comment_ID===t.comment_ID)<0&&s.push(k(t,e))}),a(s),n(!1),o(i+1)):(_(!0),n(!1))}})},g=(e,t,a)=>{for(let s=0;s<e.length;s++)e[s].comment_ID==t&&(e[s].child&&e[s].child.length?e[s].child.unshift(a):(e[s].child=[],e[s].child.push(a))),e[s].child&&e[s].child.length&&g(e[s].child,t,a);return e},y=(e,t,a)=>{for(let s=0;s<e.length;s++)e[s].comment_ID==t&&(e[s]=a),e[s].child&&e[s].child.length&&y(e[s].child,t,a);return e},b=(e,t,a)=>{for(let s=0;s<e.length;s++)e[s].comment_ID==t&&(e[s].comment_content=a.comment_content),e[s].child&&e[s].child.length&&y(e[s].child,t,a);return e},k=(e,t)=>(t.map((a,s)=>{parseInt(e.comment_ID)===parseInt(a.comment_parent)&&(e.hasOwnProperty("child")||(e.child=[]),t.splice(s,1),e.child.push(k(a,t)))}),e),x=()=>Math.floor(1e9*Math.random()+1),N=s=>{s.user.id&&fetch(`${window.wplms_course_data.api_url}/user/unitcomments/delete/${s.comment_ID}`,{method:"post",body:JSON.stringify({comment:s,token:Rg("vibebp").getToken(),course_id:e.course_id})}).then(e=>e.json()).then(e=>{if(e){if(e.status){let e=I(s,[...t]);a(e)}e.hasOwnProperty("message")&&e.message.length&&Dg("vibebp").addNotification({text:e.message})}})},I=(e,t)=>{if(e.comment_ID&&t.length)for(var a=t.length-1;a>=0;a--){if(t[a].comment_ID==e.comment_ID){t.splice(a,1);break}t[a].hasOwnProperty("child")&&t[a].child.length&&(t[a].child=I(e,t[a].child))}return t},C=()=>{switch(u.ctype){case"new":return window.wplms_course_data.translations.add_comment;case"new_question":return window.wplms_course_data.translations.ask_question;case"reply":return window.wplms_course_data.translations.reply;case"edit":return window.wplms_course_data.translations.edit_comment;default:return window.wplms_course_data.translations.add_comment}};let O="";if(t.length&&c){let e=t.findIndex(e=>e.comment_ID===c);O=e>-1?t[e].ctype:""}return jg(Ng.Provider,{value:{comments:t,unit_id:e.unit_id,course_id:e.course_id,update:(e,t)=>{switch(t){case"edit":l(!0),e.comment.ctype=t,e.comment.user_id||(e.comment.user_id=v.id),e.comment.user||(e.comment.user=v),m(e.comment);break;case"reply":l(!0),m({user_id:v.id,user:v,comment_ID:x(),comment_parent:e.comment.comment_ID,ctype:t});break;case"delete":N(e.comment)}}}},jg("div",{className:"unit_comments_enclosure"},jg("div",{className:r?"unit_comments_wrapper active":"unit_comments_wrapper"},jg("span",null,jg("span",{onClick:e.back},jg("span",{className:"vicon vicon-arrow-left"})),jg("strong",null,window.wplms_course_data.translations[e.type]),jg("span",{onClick:e.expand},jg("span",{className:"vicon vicon-align-right"}))),s?jg(tl,null):jg(Ag,null,jg("div",{className:"unit_comments"},t&&t.length?jg("ul",null,t.map((e,t)=>jg(Mg,{comment:e,disable:c}))):jg("div",{className:"vbp_message"},window.wplms_course_data.translations.no_comments),jg("div",{className:"loadmore_wrapper"},p?"":jg("a",{className:"link",onClick:()=>{f()}},window.wplms_course_data.translations.load_more))),jg("div",{className:"unit_comments_action"},r?jg("div",{className:"addcomment"},jg("textarea",{value:u.comment_content,onChange:e=>{let t={...u};t.comment_content=e.target.value,m(t)}},u.comment_content),jg("div",{className:"addcomment_buttons"},jg("a",{className:c?"button is-primary is-loading":"button is-primary",onClick:()=>{if(!u.ctype)return Dg("vibebp").addNotification({text:window.wplms_course_data.translations.insufficientdata}),!1;if(!(u.comment_content&&u.comment_content.length>3))return Dg("vibebp").addNotification({text:window.wplms_course_data.translations.add_more_content}),!1;{u.comment_ID||(u.comment_ID=x()),d(u.comment_ID),u.comment_post_ID||(u.comment_post_ID=e.unit_id);let s=u.comment_ID,n=[...t];switch(u.ctype){case"new":case"new_question":n.unshift(u),a(n),fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${e.unit_id}/new/0`,{method:"post",body:JSON.stringify({...u,token:Rg("vibebp").getToken(),course_id:e.course_id})}).then(e=>e.json()).then(e=>{if(e)if(e.comment_data){let t=n.findIndex(e=>parseInt(e.comment_ID)==u.comment_ID);t>=0&&(e.comment_data.user=v,n.splice(t,1,e.comment_data),a(n))}else Dg("vibebp").addNotification({text:e.message});d(!1)});break;case"edit":if(!u.comment_content||u.comment_content.length<4)return void Dg("vibebp").addNotification({text:window.wplms_course_data.translations.add_more_content});let t=b(n,s,u);a(t);u.comment_content;fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${e.unit_id}/edit/${s}`,{method:"post",body:JSON.stringify({...u,token:Rg("vibebp").getToken(),course_id:e.course_id})}).then(e=>e.json()).then(e=>{e&&(e.comment_data?(e.comment_data.hasOwnProperty("user")||(e.comment_data.user=v),t=b(n,s,e.comment_data),a(t)):Dg("vibebp").addNotification({text:window.wplms_course_data.translations.error})),d(!1)});break;case"reply":if(!u.comment_content||u.comment_content.length<4)return void Dg("vibebp").addNotification({text:window.wplms_course_data.translations.add_more_content});let i=g(n,u.comment_parent,u);a(i),fetch(`${window.wplms_course_data.api_url}/user/unitcomments/${e.unit_id}/reply/${u.comment_parent}`,{method:"post",body:JSON.stringify({...u,token:Rg("vibebp").getToken(),course_id:e.course_id})}).then(e=>e.json()).then(e=>{e&&(e.comment_data?(e.comment_data.hasOwnProperty("user")||(e.comment_data.user=v),i=y(n,s,e.comment_data),a(i)):Dg("vibebp").addNotification({text:window.wplms_course_data.translations.error})),d(!1)})}m(w),l(!1)}}},C()),jg("a",{className:"link",onClick:()=>{m(w),l(!1)}},window.wplms_course_data.translations.cancel))):jg(Ag,null,jg("a",{className:"new"==O&&c?"button is-primary is-loading":"button is-primary",onClick:()=>{let e={...u};e.ctype="new",r&&(e={}),e.user_id=v.id,e.user=v,m(e),l(!r)}},jg("span",{className:"public"==e.type?"vicon vicon-comments":"vicon vicon-note"}),jg("span",null,C())),"public"==e.type?jg("a",{className:"new_question"==O&&c?"button is-primary is-loading":"button is-primary",onClick:()=>{let e={...u};e.ctype="new_question",r&&(e={}),e.user_id=v.id,e.user=v,m(e),l(!r)}},jg("span",{className:"vicon vicon-help"}),jg("span",null,window.wplms_course_data.translations.ask_question)):""))))))};const{createElement:Bg,useState:$g,useEffect:Ug,Fragment:Vg,render:Wg,useContext:Yg}=wp.element,{dispatch:Xg,select:Qg}=wp.data;var Kg=e=>{const[t,a]=$g(0),s=Yg(Ml),n=()=>{const e=document.querySelector(".course_content_content");if(!e)return;let t=e.clientHeight-(e.offsetTop-240)-window.innerHeight,a=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;if(document.querySelector("body").classList&&document.querySelector("body").classList.contains("course_status_fullscreen")&&document.querySelector(".course_status")&&(a=document.querySelector(".course_status").scrollTop,t=e.clientHeight-e.offsetTop-window.innerHeight),0!==a)return a>t?(s.update({progress:100},"updateprogress"),void s.update({},"progresscompleted")):void s.update({progress:a/t*100},"updateprogress");s.update({progress:0},"updateprogress")};return Ug(()=>(window.addEventListener("scroll",n),()=>window.removeEventListener("scroll",n)),[]),""},Gg=a(7);function Zg(e,t,a,s){const n=e*(Math.PI/180),i=t*(Math.PI/180);return{x:0,y:0,wobble:10*s(),wobbleSpeed:.1+.1*s(),velocity:.5*a+s()*a,angle2D:-n+(.5*i-s()*i),angle3D:-Math.PI/4+s()*(Math.PI/2),tiltAngle:s()*Math.PI,tiltAngleSpeed:.1+.3*s()}}function ey(e,t,a,s,n,i){let o;return new Promise(r=>{requestAnimationFrame((function l(c){o||(o=c);const d=c-o,u=o===c?0:(c-o)/n;t.slice(0,Math.ceil(d/i)).forEach(e=>{!function(e,t,a,s){e.physics.x+=Math.cos(e.physics.angle2D)*e.physics.velocity,e.physics.y+=Math.sin(e.physics.angle2D)*e.physics.velocity,e.physics.z+=Math.sin(e.physics.angle3D)*e.physics.velocity,e.physics.wobble+=e.physics.wobbleSpeed,s?e.physics.velocity*=s:e.physics.velocity-=e.physics.velocity*a,e.physics.y+=3,e.physics.tiltAngle+=e.physics.tiltAngleSpeed;const{x:n,y:i,tiltAngle:o,wobble:r}=e.physics,l=`translate3d(${n+10*Math.cos(r)}px, ${i+10*Math.sin(r)}px, 0) rotate3d(1, 1, 1, ${o}rad)`;e.element.style.visibility="visible",e.element.style.transform=l,e.element.style.opacity=1-t}(e,u,a,s)}),c-o<n?requestAnimationFrame(l):(t.forEach(t=>{if(e&&t.element.parentNode===e)return e.removeChild(t.element)}),r())}))})}const ty={angle:90,spread:45,startVelocity:45,elementCount:50,width:"10px",height:"10px",colors:["#a864fd","#29cdff","#78ff44","#ff718d","#fdff6a"],duration:3e3,stagger:0,dragFriction:.1,random:Math.random};function ay(e,t={}){const{elementCount:a,colors:s,width:n,height:i,angle:o,spread:r,startVelocity:l,decay:c,dragFriction:d,duration:u,stagger:m,random:p}=Object.assign({},ty,function(e){return!e.stagger&&e.delay&&(e.stagger=e.delay),e}(t)),_=function(e,t,a,s,n){return Array.from({length:t}).map((t,i)=>{const o=document.createElement("div"),r=a[i%a.length];return o.style["background-color"]=r,o.style.width=s,o.style.height=n,o.style.position="absolute",o.style.willChange="transform, opacity",o.style.visibility="hidden",e&&e.appendChild(o),o})}(e,a,s,n,i);return ey(e,_.map(e=>({element:e,physics:Zg(o,r,l,p)})),d,c,u,m)}const{createElement:sy,render:ny,useState:iy,useEffect:oy,Fragment:ry,useRef:ly}=wp.element,{dispatch:cy,select:dy}=wp.data;var uy=e=>{const[t,a]=iy(!1),[s,n]=iy(!1),i=ly(null),[o,r]=iy(""),[l,c]=iy(!1),[d,u]=iy(e.course),[m,p]=iy({}),[_,v]=iy({per_page:5,paged:1}),[h,w]=iy({prev:0,next:0}),[f,g]=iy(!1),[y,b]=iy(!1),[k,x]=iy(!1),[N,I]=iy(!1),[C,O]=iy({}),[S,q]=iy(!1),[P,E]=iy(!0),[z,T]=iy(!0),[M,j]=iy([]),[L,H]=iy(null),[A,F]=iy(!1),[D,R]=iy(null),[J,B]=iy(null);let $=dy("vibebp").getUser();$.token=dy("vibebp").getToken(),window.scorm_page_type="course",window.scorm_wplms_data={},window.scorm_wplms_data.user_email=$.email,window.scorm_wplms_data.user_name=$.username,window.scorm_wplms_data.token=$.token,window.scorm_wplms_data.course_id=e.course_id,window.is_take_course=!0,window.scorm_wplms_data.type="course",oy(()=>{u(e.course)},[e.course]),oy(()=>(window.innerWidth<480&&x(!0),document.addEventListener("wplms_change_coursestatus",e=>{let t=e.detail.coursestatus;n(!0),p(t),n(!1)}),document.addEventListener("custom_quiz_action",t=>{if(t.detail.hasOwnProperty("action")){console.log(t.detail);let a=t.detail.coursestatus;if("quizsubmitted"==t.detail.action){let t=a.current_unit_key;if(a.courseitems[t].hasOwnProperty("status")&&parseInt(a.courseitems[t].status))return a.courseitems[t].progressbar=100,!1;a.courseitems[t].status=1,a.courseitems[t].progressbar=100;let s=0,n=0,i=0;a.courseitems.map((e,t)=>{e.status&&s++,e.id&&i++}),n=s/i,n=Math.round(100*n),e.update({progress:n,index:e.index},"progresschanged"),p(a),a.courseitems[t]&&"unit"==a.courseitems[t].type?fetch(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}/item/${a.courseitems[t].id}/markcomplete`,{method:"post",body:JSON.stringify({token:$.token,progress:n})}).then(e=>e.json()).then(e=>{e.status&&(cy("vibebp").addNotification({icon:e.icon,text:e.message}),n&&n>=100&&V())}):(a.courseitems[t].status=1,p(a),n&&n>=100&&V())}if("retake_quiz"==t.detail.action){let t=a.current_unit_key;if(a.courseitems[t]&&a.courseitems[t].status){a.courseitems[t].status=0;let s=0,n=0,i=0;a.courseitems.map((e,t)=>{e.status&&s++,e.id&&i++}),n=s/i,n=Math.round(100*n),e.update({progress:n,index:e.index},"progresschanged"),p(a)}}}}),document.querySelector("body").classList.add("course_status_fullscreen"),document.querySelector("body").classList.add("wplms_course_status"),window.wplms_course_data.disable_contextmenu&&document.addEventListener("contextmenu",U,!1),()=>{document.querySelector("body").classList.remove("wplms_course_status"),document.querySelector("body").classList.remove("course_status_fullscreen"),document.querySelector("body").classList.remove("course_status_loaded"),window.wplms_course_data.disable_contextmenu&&document.removeEventListener("contextmenu",U);var t=new CustomEvent("course_status_left",{detail:{coursestatus:m,course_id:e.course_id}});document.dispatchEvent(t)}),[]);const U=e=>(console.log("You've tried to open context menu"),e.preventDefault(),!1);oy(()=>{a(!0),fetch(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}`,{method:"post",body:JSON.stringify({token:$.token})}).then(e=>e.json()).then(t=>{if(t){t.hasOwnProperty("error_code")&&(cy("vibebp").addNotification({icon:t.icon,text:t.hasOwnProperty("error_message")&&t.error_message.length?t.error_message:window.wplms_course_data.translations.error}),e.back(!0)),t.courseitems&&t.courseitems.length&&(t.courseitems.map((e,t)=>{e.status&&(e.progressbar=100,T(!1))}),document.querySelector("body").classList.contains("course_status_loaded")||document.querySelector("body").classList.add("course_status_loaded"),p(t),X(t.current_unit_key,t),K(t.current_unit_key,t)),t.package&&(p({package:t.package}),t.hasOwnProperty("package_type")&&t.package_type&&"1.1"==t.package_type&&setTimeout(()=>{var e=new CustomEvent("unit_content_loaded",{detail:{coursestatus:{package:t.package}}});document.dispatchEvent(e)},200));var s=new CustomEvent("course_status_loaded",{detail:{coursestatus:t,course_id:e.course_id}});document.dispatchEvent(s),a(!1)}})},[_]),oy(()=>{let e={...m};if(o&&o.length>3){if(e&&e.courseitems){var t=new Gg.Search("key");t.addIndex("title"),t.addIndex("content"),t.addDocuments(e.courseitems);var a=t.search(o);e.filtered_items=a,e.keyword=o,p(e),a&&a.length&&X(a[0].key,e)}}else e.filtered_items=[],e.keyword="",p(e)},[o]);const V=()=>{m.hasOwnProperty("auto_finish")&&m.auto_finish&&d.user_progress>=100&&fetch(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}/checkcomplete`,{method:"post",body:JSON.stringify({token:$.token,course:m,course_id:e.course})}).then(e=>e.json()).then(e=>{e&&e.status&&ae(!0)})},W=e=>{let t={...m};t&&t.courseitems&&t.courseitems[J]&&"unit"==t.courseitems[J].type&&(t.courseitems[J].hasOwnProperty("progressbar")||(t.courseitems[J].progressbar=0),e>100&&(e=100),t.courseitems[J].progressbar=e,p(t))},Y=(e,t)=>{let a=document.scrollingElement||document.documentElement;document.querySelector("body").classList&&document.querySelector("body").classList.length&&document.querySelector("body").classList.contains("course_status_fullscreen")&&i.current&&(e=0,a=i.current);const s=a.scrollTop,n=e-s,o=+new Date,r=function(){const i=+new Date-o;var l,c,d;a.scrollTop=parseInt((l=i,c=s,d=n,(l/=t/2)<1?d/2*l*l+c:-d/2*(--l*(l-2)-1)+c)),i<t?requestAnimationFrame(r):a.scrollTop=e};r()},X=(t,a=null)=>{if(null==a&&(a={...m}),a.hasOwnProperty("lock")&&a.lock&&a.courseitems&&a.courseitems.length)for(let e=0;e<t;e++)if("section"!=a.courseitems[e].type&&!a.courseitems[e].status)return!1;if(a.courseitems[t].id&&"unit"==a.courseitems[t].type)if(!a.courseitems[t].content||a.courseitems[t].content.length<3||!m.courseitems[t].meta.hasOwnProperty("access")||!m.courseitems[t].meta.access||a.courseitems[t].meta.hasOwnProperty("no_cache")&&a.courseitems[t].meta.no_cache){n(!0),D&&D.abort();let s={},o=new AbortController;D&&(s={signal:o.signal}),R(o),a.current_unit_key=t,p(a),B(t),K(t,a),fetch(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}/item/${a.courseitems[t].id}`,{method:"post",...s,body:JSON.stringify({token:$.token})}).then(e=>e.json()).then(s=>{if(R(null),s){a.courseitems[t].content=s.content,a.courseitems[t].meta=s.meta;let r=1;Array.isArray(s.scripts)&&s.scripts.map(e=>{if(!document.getElementById(e.key)){let t=document.createElement("script");t.src=e.src,t.id=e.key,document.body.appendChild(t),t.onload=()=>{r++,console.log("loaded"),r==s.scripts.length&&document.body.dispatchEvent(new Event("post-load"))}}}),p(a),n(!1),i.current&&window.hasOwnProperty("innerWidth")&&window.innerWidth>768&&Y(i.current.scrollTop,800),s.meta.hasOwnProperty("scorm_type")&&s.meta.scorm_type&&setTimeout(()=>{var e=new CustomEvent("unit_content_loaded",{detail:{coursestatus:a}});document.dispatchEvent(e)},200);var o=new CustomEvent("unit_loaded",{detail:{coursestatus:a,course:e.course_id}});document.dispatchEvent(o),document.dispatchEvent(new Event("VibeBP_Editor_Content"))}}).catch(e=>{"AbortError"===e.name?console.log("Fetch aborted"):console.error("Uh oh, an error!",e)})}else{B(t),p(a),K(t,a),a.hasOwnProperty("courseitems")&&a.courseitems[t].hasOwnProperty("meta")&&a.courseitems[t].meta.hasOwnProperty("scorm_type")&&a.courseitems[t].meta.scorm_type&&setTimeout(()=>{var e=new CustomEvent("unit_content_loaded",{detail:{coursestatus:a}});document.dispatchEvent(e)},200);var s=new CustomEvent("unit_loaded",{detail:{coursestatus:a,course:e.course_id}});document.dispatchEvent(s),document.dispatchEvent(new Event("VibeBP_Editor_Content")),i.current&&window.hasOwnProperty("innerWidth")&&window.innerWidth>768&&Y(i.current.scrollTop,800)}else n(!0),B(t),p(a),K(t,a),n(!1),i.current&&window.hasOwnProperty("innerWidth")&&window.innerWidth>768&&Y(i.current.scrollTop,800);g(!1)},Q=t=>{let a=J;if("prev"==t){for(let e=a-1;e>=0;e--)if(m.courseitems[e]&&0!=m.courseitems[e].id){a=m.courseitems[e].key;break}}else for(let t=a+1;t<m.courseitems.length;t++)if(m.courseitems[t]&&0!=m.courseitems[t].id){a=m.courseitems[t].key,1==e.course.user_status&&e.update({index:e.index,user_status:2},"statuschanged");break}X(a)},K=(e,t=null)=>{null===t&&(t=m);let a={prev:0,next:0};for(let s=e-1;s>=0;s--)if(t.courseitems[s]&&0!=t.courseitems[s].id){a.prev=1;break}for(let s=e+1;s<t.courseitems.length;s++)if(t.courseitems[s]&&0!=t.courseitems[s].id){a.next=1;break}w(a)},G=(t=null,a=null)=>{if("quizsubmitted"==t&&ee(),"retake_quiz"==t){let t={...m};if(t.courseitems[J]&&t.courseitems[J].status){t.courseitems[J].status=0;let a=0,s=0,n=0;t.courseitems.map((e,t)=>{e.status&&a++,e.id&&n++}),s=a/n,s=Math.round(100*s),e.update({progress:s,index:e.index},"progresschanged"),p(t)}}},Z=(e,t)=>{let a={...m};"submitassignment"==t&&(e.hasOwnProperty("unitIndex")||(a.courseitems[J].status=1,p(a))),"retookassignment"==t&&(e.hasOwnProperty("unitIndex")||(a.courseitems[J].status=0,p(a)))},ee=(t=null,a=null)=>new Promise(s=>{let n={...m};if(null==t&&(t=J),n.courseitems[t].hasOwnProperty("status")&&parseInt(n.courseitems[t].status))return n.courseitems[t].progressbar=100,s(),!1;n.courseitems[t].status=1,n.courseitems[t].progressbar=100;let i=0,o=0,r=0;n.courseitems.map((e,t)=>{e.status&&i++,e.id&&r++}),o=i/r,o=Math.round(100*o),e.update({progress:o,index:e.index},"progresschanged"),n.courseitems[t]?fetch(`${window.wplms_course_data.api_url}/user/coursestatus/${e.course_id}/item/${n.courseitems[t].id}/markcomplete`,{method:"post",body:JSON.stringify({token:$.token,progress:o})}).then(e=>e.json()).then(e=>{e.status&&(cy("vibebp").addNotification({icon:e.icon,text:e.message}),o&&o>=100&&null==a&&V(),s(),p(n))}):(n.courseitems[t].status=1,p(n),o&&o>=100&&null==a&&V(),s(),p(n))}),te=()=>{if(m.hasOwnProperty("package")&&m.package||ee(),q(!0),F(!0),!m.hasOwnProperty("comments_open")||!m.comments_open)return ae(!0),!1;C.hasOwnProperty("comment_ID")||fetch(`${window.wplms_course_data.api_url}/user/getreview/${e.course_id}`,{method:"post",body:JSON.stringify({token:$.token,course_id:e.course_id})}).then(e=>e.json()).then(e=>{e&&e.comment_ID&&O(e),E(!1)})},ae=(t=null)=>{if(!t){if(!(C&&C.hasOwnProperty("title")&&C.hasOwnProperty("review")&&C.hasOwnProperty("rating")&&C.title.length>3&&C.review.length>3&&C.rating>1))return alert(window.wplms_course_data.translations.please_check_review_form),E(!1),!1;E(!0),C.comment_post_ID=e.course_id,C.course_id=e.course_id,C.token=$.token,fetch(window.wplms_course_data.api_url+"/updatecourse/addreview",{method:"post",body:JSON.stringify(C)}).then(e=>e.json()).then(e=>{if(!e)return alert(window.wplms_course_data.translations.error_review_form),E(!1),!1;if(e.status)E(!1);else if(e.message)return alert(e.message),E(!1),!1})}E(!0),fetch(window.wplms_course_data.api_url+"/user/finishcourse",{method:"post",body:JSON.stringify({course_id:e.course_id,token:$.token})}).then(e=>e.json()).then(t=>{t?t.status&&(q(!1),E(!1),t.finished&&(H(t.finished),t.finished.hasOwnProperty("course_status")&&e.update({index:e.index,user_status:t.finished.course_status},"statuschanged"),t.finished.status&&se().then(()=>{e.update({progress:100,index:e.index},"progresschanged")}))):(cy("vibebp").addNotification({text:window.wplms_course_data.translations.error_finishing_course}),E(!1))})},se=()=>{let e=[],t={...m};return t.hasOwnProperty("courseitems")&&t.courseitems&&t.courseitems.length&&t.courseitems.map((a,s)=>{let n=new Promise((function(e){a&&a.hasOwnProperty("status")&&parseInt(a.status)?e():a&&a.hasOwnProperty("id")&&parseInt(a.id)?(t.courseitems[s].status=1,t.courseitems[s].progressbar=100,e()):e()}));e.push(n)}),p(t),Promise.all(e)},ne=(e,t)=>{if("loadunit"==t&&e.hasOwnProperty("index")&&X(e.index),m.hasOwnProperty("assignment_locking")&&m.assignment_locking&&"completeUnitAssigmnent"==t||"retakeUnitAssigmnent"==t){let a={...m},s=a.courseitems[J];if(console.log(parseInt(a.assignment_locking)>1),parseInt(a.assignment_locking)>1){if("completeUnitAssigmnent"==t&&s.meta.hasOwnProperty("assignments")&&s.meta.assignments.length&&(s.meta.assignments[e.assignmentIndex].status=1),"retakeUnitAssigmnent"==t){let t=m.courseitems[J];t.meta.hasOwnProperty("assignments")&&t.meta.assignments.length&&(t.meta.assignments[e.assignmentIndex].status=0)}let n=0;s.meta.assignments.map((e,t)=>{e.status&&n++});let i=n/s.meta.assignments.length*100;i>=100?ee():1==s.status&&(a.courseitems[J].status=0),i=Math.round(i),W(i),p(a)}}if("mediaended"==t&&ee(),"videosended"==t){let t={...m};if(t.courseitems[J]&&t.courseitems[J].hasOwnProperty("meta")&&t.courseitems[J].meta.hasOwnProperty("video")&&t.courseitems[J].meta.video.length){t.courseitems[J].meta.hasOwnProperty("completion")||(t.courseitems[J].meta.completion=[]),t.courseitems[J].meta.completion[e.index]||(t.courseitems[J].meta.completion[e.index]={url:t.courseitems[J].meta.completion[e.index],status:0}),t.courseitems[J].meta.completion[e.index].status=1;let a=0;t.courseitems[J].meta.completion.map((e,t)=>{e&&e.status&&a++});let s=Math.round(a/t.courseitems[J].meta.video.length*100);t.courseitems[J].hasOwnProperty("progressbar")||(t.courseitems[J].progressbar=0),s>=100?(s=100,ee()):(t.courseitems[J].progressbar=s,p(t))}}};return sy(ry,null,t?sy(tl,null):m?sy(Ml.Provider,{value:{courseStatus:m,current_unit_key:J,update:(e,t)=>{switch(t){case"loadunit":e.hasOwnProperty("index")&&X(e.index);break;case"updateprogress":e.hasOwnProperty("progress")&&W(e.progress);break;case"progresscompleted":ee();break;case"directmarkcomplete":e.hasOwnProperty("index")&&(m.hasOwnProperty("assignment_locking")&&m.assignment_locking&&m.courseitems[J].meta.hasOwnProperty("assignments")&&m.courseitems[J].meta.assignments.length?cy("vibebp").addNotification({icon:"vicon-bookmark-alt",text:window.wplms_course_data.translations.complete_unit_assignments}):ee(e.index))}}}},sy("div",{className:"course_status "+(k?"moveonside":""),ref:i},z&&m.hasOwnProperty("instructions")&&m.instructions.length?sy("div",{className:"course_instructions_wrapper",onClick:e=>{e.preventDefault(),document.querySelector(".course_instructions_wrapper")&&e.target===document.querySelector(".course_instructions_wrapper")&&T(!1)}},sy("div",{className:"course_instructions"},sy("div",{className:"close",onClick:()=>{T(!1)}},sy("span",{className:"vicon vicon-close"})),sy("h1",null,window.wplms_course_data.translations.course_instructions),sy("div",{dangerouslySetInnerHTML:{__html:m.instructions}}))):"",L?sy("div",{className:"reviewpopup_wrapper"},sy("div",{className:"reviewpopup_content"},sy("div",{className:"finish-course-content"},L.hasOwnProperty("percentage")?sy("span",{className:"finished_percentage",ref:e=>ay(e,{colors:["#a864fd","#29cdff","#78ff44","#ff718d","#fdff6a"],angle:90,spread:90,startVelocity:45,elementCount:100,dragFriction:.1,duration:5e3,stagger:2,width:"12px",height:"12px"})},sy("span",null,sy("span",null,sy("strong",null,L.percentage),sy("span",null,"%")),sy("span",null,L.title))):"",L.awards?sy("div",{className:"awards"},Object.keys(L.awards).map(e=>"badge"==e?sy("div",{className:"badge"},sy("img",{src:L.awards[e].url}),sy("span",null,L.awards[e].title)):"certificate"==e?sy("div",{className:"certificate"},sy("a",{href:L.awards[e].url,target:"_blank"},sy("svg",{xmlns:"http://www.w3.org/2000/svg",width:"160",height:"160",viewBox:"0 0 24 24"},sy("path",{d:"M14.969 9.547l.031.191c0 .193-.096.379-.264.496-.538.372-.467.278-.67.885-.084.253-.33.424-.605.424h-.002c-.664-.002-.549-.038-1.083.338-.112.08-.244.119-.376.119s-.264-.039-.376-.118c-.534-.376-.419-.34-1.083-.338h-.002c-.275 0-.521-.171-.605-.424-.203-.607-.133-.513-.669-.885-.169-.118-.265-.304-.265-.497l.031-.19c.207-.604.208-.488 0-1.094l-.031-.191c0-.193.096-.379.265-.497.536-.372.465-.277.669-.885.084-.253.33-.424.605-.424h.002c.662.002.544.041 1.083-.338.112-.08.244-.119.376-.119s.264.039.376.118c.534.376.419.34 1.083.338h.002c.275 0 .521.171.605.424.203.607.132.513.67.885.168.118.264.304.264.497l-.031.191c-.207.604-.208.488 0 1.094zm-1.469-1.198l-.465-.464-1.41 1.446-.66-.627-.465.464 1.125 1.091 1.875-1.91zm4.5 4.651h-12v1h12v-1zm-1 2h-10v1h10v-1zm1 2h-12v1h12v-1zm1-15h-19v20h24v-20h-5zm3 15.422c-1.151.504-2.074 1.427-2.578 2.578h-14.844c-.504-1.151-1.427-2.074-2.578-2.578v-10.844c1.151-.504 2.074-1.427 2.578-2.578h14.844c.504 1.151 1.427 2.074 2.578 2.578v10.844z"})),sy("span",null,window.wplms_course_data.translations.achievement_certificate))):"points"==e?sy("div",{className:"points"},sy("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},sy("path",{d:"M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm0 3c-4.971 0-9 4.029-9 9s4.029 9 9 9 9-4.029 9-9-4.029-9-9-9zm1 13.947v1.053h-1v-.998c-1.035-.018-2.106-.265-3-.727l.455-1.644c.956.371 2.229.765 3.225.54 1.149-.26 1.385-1.442.114-2.011-.931-.434-3.778-.805-3.778-3.243 0-1.363 1.039-2.583 2.984-2.85v-1.067h1v1.018c.725.019 1.535.145 2.442.42l-.362 1.648c-.768-.27-1.616-.515-2.442-.465-1.489.087-1.62 1.376-.581 1.916 1.711.804 3.943 1.401 3.943 3.546.002 1.718-1.344 2.632-3 2.864z"})),sy("span",null,L.awards[e].amount)):void 0)):"",sy("div",{className:"post_completion_message"},sy("div",{className:"completion_message",dangerouslySetInnerHTML:{__html:L.message}}),sy("div",{dangerouslySetInnerHTML:{__html:L.post_message}})),sy("div",{className:"popup-footer"},sy("a",{className:"link",onClick:()=>H(!1)},window.wplms_course_data.translations.cancel),sy("a",{className:"button is-primary",onClick:e.back},window.wplms_course_data.translations.back_to_my_courses,sy("span",{className:"vicon vicon-arrow-right"})))))):"",S?sy("div",{className:"reviewpopup_wrapper",onClick:e=>{e.preventDefault(),document.querySelector(".reviewpopup_wrapper")&&e.target===document.querySelector(".reviewpopup_wrapper")&&q(!1)}},sy("div",{className:"reviewpopup_content"},sy("div",{className:"close",onClick:()=>{q(!1)}},sy("span",{className:"vicon vicon-close"})),P?sy(tl,null):m.hasOwnProperty("comments_open")&&m.comments_open?sy(ry,null,sy("div",{className:"reviewform"},sy("label",null,window.wplms_course_data.translations.rating),sy(v_,{update:(e,t)=>{if("ratingchanged"==t){let t=0;e&&(t=e.length);let a={...C};a.rating=t,O(a)}},rating:C.rating}),sy("input",{type:"text",onChange:e=>{let t={...C};t.title=e.target.value,O(t)},value:C.title,placeholder:window.wplms_course_data.translations.review_title}),sy("textarea",{onChange:e=>{let t={...C};t.review=e.target.value,O(t)},value:C.review,placeholder:window.wplms_course_data.translations.your_review})),sy("div",{className:"popup-footer"},A?sy(ry,null,sy("a",{href:"#",onClick:()=>{ae(!0)}},sy("span",{className:"vicon vicon-angle-left"})," ",window.wplms_course_data.translations.skip_review_and_finish_course),sy("a",{href:"#",className:P?"button is-primary is-loading":"button is-primary",onClick:()=>{ae()}},window.wplms_course_data.translations.submit_review_and_finish_course," ",sy("span",{className:"vicon vicon-arrow-right"}))):sy(ry,null,sy("a",{className:"link",onClick:()=>q(!1)},window.wplms_course_data.translations.cancel),sy("a",{className:"button is-primary",onClick:()=>{C&&C.hasOwnProperty("title")&&C.hasOwnProperty("review")&&C.hasOwnProperty("rating")&&C.title.length>3&&C.review.length>3&&C.rating>1?(E(!0),C.comment_post_ID=e.course_id,C.course_id=e.course_id,C.token=$.token,fetch(window.wplms_course_data.api_url+"/updatecourse/addreview",{method:"post",body:JSON.stringify(C)}).then(e=>e.json()).then(e=>{e?e.status?E(!1):e.message&&(alert(e.message),E(!1)):(alert(window.wplms_course_data.translations.error_review_form),E(!1)),q(!1)})):(alert(window.wplms_course_data.translations.please_check_review_form),E(!1))}},window.wplms_course_data.translations.submit_review," ",sy("span",{className:"vicon vicon-arrow-right"}))))):"")):"",(()=>{let e=0;if(m&&m.courseitems&&m.courseitems.length&&m.courseitems[J]&&"unit"==m.courseitems[J].type&&!m.courseitems[J].status&&m.courseitems[J].hasOwnProperty("meta")&&m.courseitems[J].meta.hasOwnProperty("access")&&m.courseitems[J].meta.access&&(e=1,m.hasOwnProperty("assignment_locking")&&m.assignment_locking&&m.courseitems[J].meta.hasOwnProperty("assignments")&&m.courseitems[J].meta.assignments.length&&(e=0),m.courseitems[J].meta.hasOwnProperty("video")&&(m.courseitems[J].meta.video.hasOwnProperty("url")||Array.isArray(m.courseitems[J].meta.video)&&m.courseitems[J].meta.video.length)&&(e=0)),e)return sy(Kg,null)})(),m.package?sy("div",{className:"course_package_wrapper"},sy("div",{className:"course_package_header"},sy("div",{className:"vicon vicon-arrow-left",onClick:e.back}),sy("div",{className:"finish_course button is-primary small",onClick:()=>{te()}},window.wplms_course_data.translations.complete)),sy("div",{className:"course_package"},sy("div",{dangerouslySetInnerHTML:{__html:m.package}}))):sy(ry,null,sy("div",{className:y?"course_timeline expand "+(f||N?"comments_shown":""):"course_timeline "+(f||N?"comments_shown":"")},sy("div",{className:"course_action_points"},sy("div",{className:"action_points"},sy("a",{className:"vicon vicon-arrow-left",onClick:e.back}),!s&&!jl(m)&&m.hasOwnProperty("courseitems")&&m.courseitems.length?sy(ry,null,sy("a",{className:"vicon vicon-search",onClick:()=>{c(!0)}}),m.courseitems[J].hasOwnProperty("meta")&&m.courseitems[J].meta.hasOwnProperty("access")&&m.courseitems[J].meta.access?sy(ry,null,sy("a",{className:"vicon vicon-notepad",onClick:()=>{I(!0)}}),sy("a",{className:"vicon vicon-comments",onClick:()=>{g(!0)}})):""):"",document.querySelector("body").classList.contains("single-course")?"":sy("a",{title:document.querySelector("body").classList.contains("course_status_fullscreen")?window.wplms_course_data.translations.minimise_screen:window.wplms_course_data.translations.maximise_screen,className:"vicon vicon-fullscreen",onClick:()=>{document.querySelector("body").classList.contains("course_status_fullscreen")?document.querySelector("body").classList.remove("course_status_fullscreen"):document.querySelector("body").classList.add("course_status_fullscreen")}})),l?sy("div",{className:"search-course "+(l?"active":"")},sy("input",{type:"text",placeholder:window.wplms_course_data.translations.search_course_elements,onChange:e=>{r(e.target.value)},value:o}),sy("span",null,m.filtered_items&&o.length>3?m.filtered_items.length+" "+window.wplms_course_data.translations.results_found:""),sy("span",{onClick:()=>{c(!1),r("")},className:"vicon vicon-close"})):""),f&&m&&m.courseitems&&m.courseitems[J]&&"unit"==m.courseitems[J].type?sy(Jg,{type:"public",unit_id:m.courseitems[J].id,course_id:e.course_id,back:()=>g(!1),expand:()=>b(!y)}):"",N&&m&&m.courseitems&&m.courseitems[J]&&"unit"==m.courseitems[J].type?sy(Jg,{type:"note",unit_id:m.courseitems[J].id,course_id:e.course_id,back:()=>I(!1),expand:()=>b(!y)}):"",e.hasOwnProperty("course")?sy("div",{className:"course_heading"},sy("h2",{dangerouslySetInnerHTML:{__html:d.name}}),sy("div",{class:"course_progress_wrapper"},sy("div",{className:"course_progress"},sy("span",{style:{width:d.user_progress+"%"}})),sy("span",null,d.user_progress,"%"))):"",sy(kg,null)),sy("div",{className:"course_content"},sy("div",{className:"course_content_header"},sy("span",{className:"toggle_timeline_wrapper",onClick:()=>{x(!k)}},sy("span",{className:k?window.innerWidth<480?"vicon vicon-angle-double-down":"vicon vicon-angle-double-right":window.innerWidth<480?"vicon vicon-angle-double-up":"vicon vicon-angle-double-left"}),sy("span",null,k?window.wplms_course_data.translations.show_panel:window.wplms_course_data.translations.hide_panel)),sy("div",{className:"right_block"},m.hasOwnProperty("comments_open")?sy("span",{className:"review_block",onClick:()=>(q(!0),void(C.hasOwnProperty("comment_ID")||fetch(`${window.wplms_course_data.api_url}/user/getreview/${e.course_id}`,{method:"post",body:JSON.stringify({token:$.token,course_id:e.course_id})}).then(e=>e.json()).then(e=>{e&&e.comment_ID&&O(e),E(!1)})))},sy("span",{className:"vicon vicon-star"}),sy("span",null,window.wplms_course_data.translations.leave_rating)):"",m&&m.courseitems&&m.courseitems.length?sy("div",{className:"unit_prevnext"},sy("div",{className:"unit_prev navigate_unit",onClick:()=>{Q("prev")}},h.prev?sy(ry,null,sy("span",{className:"vicon vicon-arrow-left"}),sy("span",null,window.wplms_course_data.translations.previous_unit)):""),sy("div",{className:"unit_next navigate_unit",onClick:()=>{Q("next")}},h.next?sy(ry,null,sy("span",null,window.wplms_course_data.translations.next_unit),sy("span",{className:"vicon vicon-arrow-right"})):"")):"")),s?sy(tl,null):m&&m.courseitems&&m.courseitems.length?(()=>{let t=0,a=0;m.courseitems.map((e,s)=>{e.id&&t++,s<=J&&e.id&&a++});let s="next_curriculum_item unlocked";switch(m.hasOwnProperty("lock")&&m.lock&&!m.courseitems[J].status&&(s="next_curriculum_item locked"),m.courseitems[J].type){case"quiz":return sy("div",{className:"course_content_content_wrapper"},sy("div",{className:"course_content_content"},sy("span",{className:"lesson_info"},sy("span",null,window.wplms_course_data.reports.module.quiz," ",a+"/"+t),sy(Ct,{timestamp:m.courseitems[J].duration,notimediff:1})),sy("h2",{dangerouslySetInnerHTML:{__html:m.courseitems[J].title}}),m.courseitems[J].hasOwnProperty("quiz_type")?sy("div",null,(()=>{var t={coursestatus:m,type:m.courseitems[J].quiz_type,id:m.courseitems[J].id,course_id:e.course_id};m.courseitems[J].hasOwnProperty("content_id")&&(t.content_id=m.courseitems[J].content_id);var a=new CustomEvent("custom_quiz_type",{detail:t});return document.dispatchEvent(a),sy("div",{id:m.courseitems[J].quiz_type,quizid:m.courseitems[J].id})})()):sy(pl,{quizid:m.courseitems[J].id,update:G})),J+1<m.courseitems.length?sy("div",{className:s,onClick:()=>{Q("next")}},m.courseitems[J+1].icon?m.courseitems[J+1].icon.length>200?sy("span",null,sy("span",{dangerouslySetInnerHTML:{__html:m.courseitems[J+1].icon}}),sy("span",{dangerouslySetInnerHTML:{__html:m.courseitems[J+1].title}})):sy("span",null,sy("span",{className:m.courseitems[J+1].icon}),sy("span",{dangerouslySetInnerHTML:{__html:m.courseitems[J+1].title}})):sy("span",{dangerouslySetInnerHTML:{__html:m.courseitems[J+1].title}})):sy("div",{className:"finish_course"},sy("a",{className:"button is-primary is-fullwidth",onClick:()=>{te()}},sy("span",{className:"vicon vicon-check-box",style:{margin:"0 1rem"}}),window.wplms_course_data.translations.complete_course)));case"wplms-assignment":return sy("div",{className:"course_content_content_wrapper"},sy("div",{className:"course_content_content"},sy("span",{className:"lesson_info"},sy("span",null,window.wplms_course_data.reports.module.assignment," ",a+"/"+t),sy(Ct,{timestamp:m.courseitems[J].duration,notimediff:1})),sy("h2",{dangerouslySetInnerHTML:{__html:m.courseitems[J].title}}),sy($l,{assignment:m.courseitems[J].meta,update:Z})),J+1<m.courseitems.length?sy("div",{className:s,onClick:()=>{Q("next")}},sy("span",null,sy("span",{className:m.courseitems[J+1].icon?m.courseitems[J+1].icon:""}),sy("span",{dangerouslySetInnerHTML:{__html:m.courseitems[J+1].title}}))):sy("div",{className:"finish_course"},sy("a",{className:"button is-primary is-fullwidth",onClick:()=>{te()}},sy("span",{className:"vicon vicon-check-box",style:{margin:"0 1rem"}}),window.wplms_course_data.translations.complete_course)));case"unit":default:return sy("div",{className:"course_content_content_wrapper"},sy(Tc,{curriculumItem:m.courseitems[J],update:ne,index:J,item_number:a,total_item_count:t}),J+1<m.courseitems.length?sy("div",{className:s,onClick:()=>{Q("next");let e=0;m&&m.courseitems&&m.courseitems.length&&m.courseitems[J]&&"unit"==m.courseitems[J].type&&!m.courseitems[J].status&&m.courseitems[J].hasOwnProperty("meta")&&m.courseitems[J].meta.hasOwnProperty("access")&&m.courseitems[J].meta.access&&(e=1,m.hasOwnProperty("assignment_locking")&&m.assignment_locking&&m.courseitems[J].meta.hasOwnProperty("assignments")&&m.courseitems[J].meta.assignments.length&&(e=0)),e&&ee(J)}},m.courseitems[J+1].icon?m.courseitems[J+1].icon.length>200?sy("span",null,sy("span",{dangerouslySetInnerHTML:{__html:m.courseitems[J+1].icon}}),sy("span",{dangerouslySetInnerHTML:{__html:m.courseitems[J+1].title}})):sy("span",null,sy("span",{className:m.courseitems[J+1].icon}),sy("span",{dangerouslySetInnerHTML:{__html:m.courseitems[J+1].title}})):sy("span",{dangerouslySetInnerHTML:{__html:m.courseitems[J+1].title}})):sy("div",{className:"finish_course"},sy("a",{className:"button is-primary is-fullwidth",onClick:()=>{te()}},sy("span",{className:"vicon vicon-check-box",style:{margin:"0 1rem"}}),window.wplms_course_data.translations.complete_course)))}})():"")))):"")};const{createElement:my,useState:py,useEffect:_y,Fragment:vy,render:hy}=wp.element,{dispatch:wy,select:fy}=wp.data;var gy=e=>{const[t,a]=py([]),[s,n]=py(!0);_y(()=>{if(Array.isArray(e.curriculum)&&e.curriculum.length){e.curriculum.findIndex((e,t)=>"section"==e.type)<0&&e.curriculum.map((t,a)=>{e.curriculum[a].show=!0})}a(e.curriculum),n(!1)},[e.curriculum]);const i=(e,s)=>{if(t&&t.length){let n=[...t],i=n.findIndex((e,t)=>t>s&&"section"==e.type);i<0?i=n.length-1:i-=1;for(let t=s;t<=i;t++)n[t].show=e;a(n)}};return s?my(tl,null):t&&Array.isArray(t)&&t.length?t.map((e,t)=>"section"==e.type?my("div",{className:"curriculum_section",onClick:()=>{i(!e.hasOwnProperty("show")||!e.show,t)}},my("span",{dangerouslySetInnerHTML:{__html:e.label}}),window.wplms_course_data.curriculum_accordion?my(vy,null,e.hasOwnProperty("show")&&e.show?my("a",{className:"vicon vicon-minus",onClick:()=>{i(!1,t)}}):my("a",{className:"vicon vicon-plus",onClick:()=>{i(!0,t)}})):""):e.hasOwnProperty("show")&&e.show?my("div",{className:"curriculum_item"},my("span",null,my("strong",null,e.icon.length>200?my("span",{dangerouslySetInnerHTML:{__html:e.icon}}):my("span",{className:e.icon}),my("em",{dangerouslySetInnerHTML:{__html:e.label}})),e.hasOwnProperty("duration")&&e.duration?my(Ct,{notimediff:1,timestamp:e.duration}):""),my("span",{className:e.progress?"done":""},my(fi,{size:"xs",progress:e.progress}))):void 0):my("div",{className:"vbp_message"},window.wplms_course_data.translations.no_curriculum)};const{createElement:yy,render:by,useState:ky,useEffect:xy,Fragment:Ny}=wp.element,{dispatch:Iy,select:Cy}=wp.data;Math.floor((new Date).getTime()/1e3);var Oy=e=>{const[t,a]=ky(!1),[s,n]=ky(!1),[i,o]=ky([{key:"overview",label:window.wplms_course_data.translations.course_overview}]),[r,l]=ky("overview"),[c,d]=ky({}),[u,m]=ky(e.course.description),[p,v]=ky(e.course),[h,w]=ky("");xy(()=>{v(e.course),l("overview")},[e.course]),xy(()=>{n(!0),fetch(window.wplms_course_data.api_url+"/student/getcourseTabs",{method:"post",body:JSON.stringify({courseId:p.id,tab:r,token:Cy("vibebp").getToken()})}).then(e=>e.json()).then(e=>{n(!1),e.status&&d(e.tabs)})},[]),_(()=>{"curriculum"==r&&(n(!0),fetch(window.wplms_course_data.api_url+"/student/courseTab",{method:"post",body:JSON.stringify({courseId:p.id,tab:r,token:Cy("vibebp").getToken()})}).then(e=>e.json()).then(e=>{n(!1),e.status&&m(e.curriculum)}))},500,[r]);return yy("div",{className:"course_overview_wrapper"},yy("div",{className:"course_overview"},yy("span",null,yy("span",{className:"vicon vicon-arrow-left",onClick:e.back}),yy("span",null,yy(Ct,{timestamp:parseInt(p.user_expiry)-parseInt(window.wplms_course_data.timestamp),notimediff:1}),yy("a",{href:p.link,target:"_blank",className:"vicon vicon-link"}))),yy("div",{className:"course_header"},yy("div",{className:"course_featured"},yy("img",{src:p.featured_image,alt:p.name,width:"100%"})),yy("div",{className:"course_header_description"},yy("span",null,window.wplms_course_data.translations.course_overview),yy("h1",{dangerouslySetInnerHTML:{__html:p.name}}),yy("div",{class:"course_progress_wrapper"},yy("div",{className:"course_progress"},yy("span",{style:{width:p.user_progress+"%"}})),yy("span",null,p.user_progress,"%")),yy(Ny,null,p.hasOwnProperty("error")&&p.error.hasOwnProperty("error_message")?yy(Ny,null,p.user_expiry>(new Date).getTime()/1e3?yy("a",{className:"button is-primary"},window.wplms_course_data.course.admin.status[p.user_status]):yy("a",{href:p.link,className:"button is-primary"},window.wplms_course_data.translations.expired),yy("div",{className:"vbp_message error"},yy("span",{className:"vicon "+p.error.icon,style:{margin:"0 0.2rem"}}),yy("span",{dangerouslySetInnerHTML:{__html:p.error.error_message}}))):yy(Ny,null,p.user_expiry>(new Date).getTime()/1e3?!window.wplms_course_data.course.admin.finished_access&&parseInt(p.user_status)>3?yy("a",{className:"button is-primary"},window.wplms_course_data.course.admin.status[p.user_status]):p.hasOwnProperty("start_date")&&p.start_date>(new Date).getTime()/1e3&&parseInt(p.user_status)<=1?yy(Ny,null,yy("a",{className:"button is-primary"},window.wplms_course_data.course.admin.status[p.user_status]),yy("div",{className:"vbp_message error"},yy("span",{className:"vicon vicon-lock",style:{margin:"0 0.2rem"}}),yy("span",null,window.wplms_course_data.translations.course_starts_on," ",p.display_start_date))):yy("a",{className:"button is-primary",onClick:e.setCourseStatus},window.wplms_course_data.course.admin.status[p.user_status]):yy("a",{href:p.link,className:"button is-primary"},window.wplms_course_data.translations.expired))),yy("div",{className:"course_short_description"},p.excerpt))),yy("div",{className:"course_manage"},yy("div",{className:"course_tabs"},c&&Object.keys(c).length?yy("div",{className:"instructor_tabs"},Object.keys(c).map(e=>yy("span",{className:r==e?"active":"",onClick:()=>l(e)},c[e]))):""),yy("div",{className:"course_tab_content"},s?yy("div",{class:"widget_loader"},yy("div",null),yy("div",null),yy("div",null),yy("div",null)):"curriculum"==r?yy("div",{className:"course_curriculum_wrapper"},yy(gy,{curriculum:u})):"qna"==r?yy(tv,{course:p}):"notes"==r?yy(j_,{course:p,tabs:["notes"]}):"announcementsnews"==r?yy(xh,{course:p.id}):"overview"==r?yy(Ny,null,yy("div",{className:"course_description",dangerouslySetInnerHTML:{__html:e.course.description}}),yy("div",{className:"about_instructor"}),yy("div",null,void document.dispatchEvent(new Event("VibeBP_Editor_Content")))):r.indexOf("external__")>-1?(()=>{let e=r.split("external__")[1].split("_");Iy("vibebp").setId(e[2]),Iy("vibebp").setAction(e[1]),Iy("vibebp").setComponent(e[0])})():yy("div",null,(setTimeout(()=>{var e=new CustomEvent("fullcourse_external_tab",{detail:{tab:r,course:p}});document.dispatchEvent(e)},200),yy("div",{className:r})))))))};const{createElement:Sy,render:qy,useState:Py,useEffect:Ey,Fragment:zy}=wp.element,{dispatch:Ty,select:My}=wp.data;Math.floor((new Date).getTime()/1e3);var jy=e=>{const[t,a]=Py(!1),[s,n]=Py(!1),[i,o]=Py(!1),[r,l]=Py([]),[c,d]=Py({per_page:12,paged:1,s:"",access:"active"}),[u,m]=Py(""),[p,v]=Py(!1),[h,w]=Py(!1),[g,y]=Py(!1),[b,k]=Py(!0);let x=My("vibebp").getUser();x.token=My("vibebp").getToken();const[N,I]=Py(null);Ey(()=>{if("course"==My("vibebp").getAction()&&My("vibebp").getId()){let e=My("vibebp").getId();e&&d({...c,post__in:[e],paged:1})}},[]),_(()=>{N&&N.abort();let e={},t=new AbortController;N&&(e={signal:t.signal}),I(t),n(!0),fetch(window.wplms_course_data.api_url+"/student/courses",{method:"post",...e,body:JSON.stringify({...c,token:x.token})}).then(e=>e.json()).then(e=>{if(I(null),n(!1),k(!1),e.status&&e.courses.length)if(g){let t=[...r,...e.courses];l(t),y(!1),t.length<parseInt(e.total)&&k(!0)}else l(e.courses),c.post__in&&1==c.post__in.length&&w(e.courses[0]),e.courses.length<parseInt(e.total)&&k(!0);else l([])}).catch(e=>{"AbortError"===e.name?console.log("Fetch aborted"):console.error("Uh oh, an error!",e)})},500,[c]);let C=[...r];return!f(u)&&parseInt(u)&&(C=C.filter(e=>e.user_status==u)),b||c.s.length&&(C=C.filter(e=>e.name.toLowerCase().includes(c.s.toLowerCase()))),t?Sy(tl,null):p?Sy(uy,{course_id:p,course:r[r.findIndex(e=>e.id==p)],back:()=>{if(w(!1),v(!1),c.hasOwnProperty("post__in")){let e={...c};delete e.post__in,d(e)}Ty("vibebp").setId(!1)},exit:()=>{w(!1)},index:r.findIndex(e=>e.id==p),update:(e,t)=>{if("progresschanged"==t&&e.hasOwnProperty("index")){let t=[...r];t[e.index].user_progress=e.progress,l(t)}if("statuschanged"==t&&e.hasOwnProperty("index")){let t=[...r];t[e.index].user_status=e.user_status,l(t)}}}):Sy("div",{className:"mycourses"},h?Sy(Oy,{course:h,back:()=>{if(w(!1),c.hasOwnProperty("post__in")){let e={...c};delete e.post__in,d(e)}Ty("vibebp").setId(!1)},setCourseStatus:()=>{v(h.id)}}):"",Sy("div",{style:h?{display:"none"}:{}},Sy("div",{className:"mycourses_header"},Sy("div",{className:"mycourses_access_tabs"},Object.keys(window.wplms_course_data.course.admin.access).map(e=>{if("all"!=e)return Sy("a",{onClick:t=>{d({...c,access:e,paged:1}),k(!0)},className:c.access==e?"active button is-primary":"link"},window.wplms_course_data.course.admin.access[e])})),Sy("div",{className:"flex2"},Sy("div",{class:"vibebp_form_field"},Sy("input",{type:"text",value:c.s,onChange:e=>{d({...c,s:e.target.value,paged:1})},placeholder:window.wplms_course_data.translations.search_courses}),Sy("span",{className:"vicon vicon-search"})),Sy("select",{onChange:e=>{m(e.target.value)},value:u},Object.keys(window.wplms_course_data.course.admin.status).map(e=>Sy("option",{value:e},window.wplms_course_data.course.admin.status[e]))))),s?Sy(tl,null):Sy(zy,null,C.length?Sy("div",{className:"course_blocks"},C.map((e,t)=>Sy("div",{className:"course_block_wrap"},Sy("div",{className:"course_block"},Sy("div",{className:"course_featured_image"},Sy("img",{src:e.featured_image,alt:e.name,width:"460",height:"300",onClick:()=>{w(e),Ty("vibebp").setAction("course"),Ty("vibebp").setId(e.id)}}),Sy("div",{class:"course_featured_image_over"},Sy("div",{className:"course_label",onClick:()=>{w(e),Ty("vibebp").setAction("course"),Ty("vibebp").setId(e.id)}},e.hasOwnProperty("user_expiry")?parseInt(e.user_expiry)>=parseInt(window.wplms_course_data.timestamp)?Sy("span",{className:"active"},window.wplms_course_data.course.admin.access.active):Sy("span",{className:"expired"},window.wplms_course_data.course.admin.access.expired):""))),Sy("div",{className:"course_block_content_wrapper"},Sy("div",{className:"course_title_wrapper"},Sy("div",{className:"course_title",onClick:()=>{w(e),Ty("vibebp").setAction("course"),Ty("vibebp").setId(e.id)}},Sy("h3",{dangerouslySetInnerHTML:{__html:e.name}})),Sy("div",{className:"course_info"},Sy("div",{className:"course_instructor"},e.instructor.map(e=>Sy(Kp,{type:"member",id:{user_id:e}}))),Sy("span",{className:"joined_date"},Sy(Ct,{timestamp:parseInt(e.user_expiry)-parseInt(e.duration)})))),Sy("div",{className:"course_meta_data"},Sy("div",{class:"course_progress_wrapper"},Sy("div",{className:"course_progress"},Sy("span",{style:{width:e.user_progress+"%"}})),Sy("span",null,e.user_progress,"%")),e.hasOwnProperty("user_status")?Sy(zy,null,Sy("a",{className:"button is-primary small",onClick:()=>{w(e),Ty("vibebp").setAction("course"),Ty("vibebp").setId(e.id)}},window.wplms_course_data.course.admin.status[e.user_status]),e&&e.user_status>=4&&e.hasOwnProperty("course_retakes")&&e.hasOwnProperty("user_retakes")&&e.course_retakes-e.user_retakes>0?Sy("div",{className:"course_retake"},Sy("a",{className:i?"button is-primary small is-loading":"button is-primary small",onClick:()=>{((e,t)=>{e.hasOwnProperty("id")&&e.id&&(o(!0),fetch(`${window.wplms_course_data.api_url}/user/retake_course/${e.id}`,{method:"post",body:JSON.stringify({token:x.token})}).then(e=>e.json()).then(a=>{if(o(!1),a.status){let a=[...r];a[t].user_retakes=e.user_retakes+1,a[t].user_status=1,a[t].user_progress=0,l(a)}Ty("vibebp").addNotification({icon:a.icon,text:a.hasOwnProperty("message")&&a.message.length?a.message:window.wplms_course_data.translations.error})}))})(e,t)}},window.wplms_course_data.translations.retake_course," "),Sy("span",{className:"course_retakes"},Sy("span",null,e.user_retakes),"/",e.course_retakes)):""):"")))))):Sy("div",{className:"vbp_message"},window.wplms_course_data.translations.no_courses_found),b?Sy("a",{className:"link",onClick:()=>{y(!0),d({...c,paged:c.paged+1})}},window.wplms_course_data.translations.load_more):"")))};const{createElement:Ly,useState:Hy,useEffect:Ay,Fragment:Fy,render:Dy}=wp.element,{dispatch:Ry,select:Jy}=wp.data;var By=e=>{const[t,a]=Hy(!1),[s,n]=Hy(e.course),[i,o]=Hy([]),[r,l]=Hy([]),[c,d]=Hy(!1),[u,m]=Hy(!1),[p,v]=Hy([]),[h,w]=Hy(0),[f,g]=Hy({filter:"course",primary_id:e.course.id,search:"",sorter:"",page:1}),[y,b]=Hy(!1),[k,x]=Hy(!1),N=(Jy("vibebp").getUser(),Jy("vibebp").getToken());Ay(()=>{n(e.course),fetch(window.wplms_course_data.api_url+"/student/finishedCourseDetails",{method:"post",body:JSON.stringify({token:N,course_id:e.course.id})}).then(e=>e.json()).then(e=>{e.status?(l(e.curriculum),e.hasOwnProperty("retakes")&&d(e.retakes)):e.hasOwnProperty("message")&&Ry("vibebp").addNotification({text:e.message})})},[e.course]),_(()=>{fetch(`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}`,{method:"post",body:JSON.stringify({token:N,...f})}).then(e=>e.json()).then(e=>{if(e.status){let t=[];k?(t=[...activities],e.data.activities.map(e=>{t.push(e)}),x(!1)):t=e.data.activities,b(e.data.has_more_items),v(t)}})},500,[f]);let I=0;return Ly("div",{className:"fullcoursereport portal"},Ly("span",{onClick:()=>e.close(),className:"vicon vicon-close"}),t?Ly(tl,null):Ly(Fy,null,Ly("div",{className:"student_vitals"},Ly("img",{src:s.img}),Ly("div",{className:"course_vitals"},Ly("h2",null,s.title),Ly("ul",null,Ly("li",null,Ly("label",null,window.wplms_course_data.translations.total_marks),Ly("strong",null,Ly("span",{className:"grade "+s.grade.key},Ly("span",null,s.grade.value,"%"),s.grade.label?Ly("span",null,s.grade.label):""))),c?Ly("li",null,Ly("label",null,window.wplms_course_data.translations.retake_course),Ly("strong",null,c.total>c.consumed?Ly("a",{onClick:()=>{m(!0),fetch(`${window.wplms_course_data.api_url}/user/retake_course/${e.course.id}`,{method:"post",body:JSON.stringify({token:N})}).then(e=>e.json()).then(t=>{m(!1),t.status&&(e.remove(),e.close())})},className:u?"button is-primary is-loading":"button is-primary"},window.wplms_course_data.translations.retake_course):"",window.wplms_course_data.translations.remaining_retakes,c.total-c.consumed,"/",c.total)):""))),Ly("div",{className:"student_course_timeline"},r.length?Ly("ul",{className:"courseCurriculum"},r.map((e,t)=>{"section"==e.type&&(I=t);let a=e.type+" "+(e.status?"done":"");return"section"!=e.type&&h>-1&&(a+=h==I?" open_lesson":" collapsed_lesson"),Ly("li",{className:a},Ly("p",null,e.icon&&e.icon.length>200?Ly("span",{dangerouslySetInnerHTML:{__html:e.icon}}):Ly("span",{className:e.icon}),Ly("span",{className:"lesson_title",dangerouslySetInnerHTML:{__html:e.title},onClick:()=>w(t)})),"section"==e.type?Ly("i",t==h?{className:"vicon vicon-minus",onClick:()=>w(t)}:{className:"vicon vicon-plus",onClick:()=>w(t)}):"","section"!=e.type?"unit"===e.type?Ly("div",{className:"unit_progress_wrapper"},Ly(fi,{progress:r[t]&&"unit"==r[t].type&&r[t].hasOwnProperty("progressbar")?r[t].progressbar:0,size:"xs"})):Ly("div",{className:"unit_progress_wrapper"},e.max?e.marks+"/"+e.max:""):"")})):""),Ly("div",{className:"course_activity portal_body"},p.length?Ly("div",{className:"activity_list"},p.map(e=>Ly("div",{className:"activity_item","data-activity-id":e.id},Ly("div",{className:"activity_avatar"},Ly("img",{src:e.avatar})),Ly("div",{className:"activity_body"},Ly("div",{className:"activity_header"},Ly("span",{dangerouslySetInnerHTML:{__html:e.action}})),e.hasOwnProperty("content")&&e.content.length?Ly("div",{className:"activity_content"},Ly("span",{dangerouslySetInnerHTML:{__html:e.content}}),Ly("div",{className:"activity_attachments"},e.hasOwnProperty("meta")&&Object.keys(e.meta).length?Object.keys(e.meta).map(t=>Ly(Fy,null,e.meta[t].map(e=>{if(e.length>3){if("image"==t)return Ly("img",{src:e,className:"activity_meta image"});if("video"==t)return Ly("div",{className:"video_wrapper"},Ly("video",{className:"activity_meta video",ref:e=>{e&&new Plyr(e)}},Ly("source",{src:e,type:"video/mp4"})));if("audio"==t)return Ly("audio",{className:"activity_meta audio",ref:e=>{e&&new Plyr(e)}},Ly("source",{src:e,type:"audio/mp3"}));if("attachment"==t)return Ly("a",{href:e,target:"_blank",className:"vicon vicon-clip activity_meta"})}}))):"")):"",Ly(Ct,{timestamp:e.date_recorded})))),y?Ly("a",{className:"link",onClick:()=>{let e={...f};e.page=f.page+1,x(!0),g(e)}},window.vibebp.translations.more):""):"")))};const{createElement:$y,useState:Uy,useEffect:Vy,Fragment:Wy,render:Yy}=wp.element,{dispatch:Xy,select:Qy}=wp.data;var Ky=e=>{const[t,a]=Uy(!1),[s,n]=Uy([]),[i,o]=Uy([]),[r,l]=Uy([]),[c,d]=Uy({s:"",orderby:"",order:"",paged:1,per_page:12}),[u,m]=Uy(""),[p,v]=Uy(!1),[h,f]=Uy(!1),[g,y]=Uy(!1),[b,k]=Uy(!1);Qy("vibebp").getUser();let x=Qy("vibebp").getToken();const[N,I]=Uy(null);return Vy(()=>{a(!0),fetch(window.wplms_course_data.api_url+"/student/badges",{method:"post",body:JSON.stringify({token:x})}).then(e=>e.json()).then(e=>{a(!1),e.status&&n(e.badges)}),a(!0),fetch(window.wplms_course_data.api_url+"/student/certificates",{method:"post",body:JSON.stringify({token:x})}).then(e=>e.json()).then(e=>{a(!1),e.status&&o(e.certificates)})},[]),_(()=>{a(!0),N&&N.abort();let e={},t=new AbortController;N&&(e={signal:t.signal}),I(t),fetch(window.wplms_course_data.api_url+"/student/finishedCourses",{method:"post",...e,body:JSON.stringify({...c,token:x})}).then(e=>e.json()).then(e=>{if(a(!1),I(null),e.status)if(p){let t=[...r,...e.courses];l(t),v(!1),t.length<e.total?f(!0):f(!1)}else e.hasOwnProperty("courses")&&e.courses.length?(l(e.courses),e.courses.length<e.total?f(!0):f(!1)):m(e.message);else e.hasOwnProperty("message")&&(m(e.message),Xy("vibebp").addNotification({text:e.message}))}).catch(e=>{"AbortError"===e.name?console.log("Fetch aborted"):console.error("Uh oh, an error!",e)})},500,[c]),$y("div",{className:"my_achievements_wrapper"},s.length?$y("div",{className:"my_badges_wrapper"},$y("h3",null,window.wplms_course_data.translations.my_badges),$y("div",{className:"my_badges course_blocks"},s.map(e=>$y("div",{className:"my_badge"},$y("img",{src:e.value}),$y("span",null,e.label))))):"",i.length?$y("div",{className:"my_certificates_wrapper"},$y("h3",null,window.wplms_course_data.translations.my_certificates),$y("div",{className:"my_certificates course_blocks"},i.map(e=>$y("div",{className:"my_certificate",onClick:()=>window.open(e.value,"_blank")},$y("svg",{xmlns:"http://www.w3.org/2000/svg",width:"160",height:"160",viewBox:"0 0 24 24"},$y("path",{d:"M14.969 9.547l.031.191c0 .193-.096.379-.264.496-.538.372-.467.278-.67.885-.084.253-.33.424-.605.424h-.002c-.664-.002-.549-.038-1.083.338-.112.08-.244.119-.376.119s-.264-.039-.376-.118c-.534-.376-.419-.34-1.083-.338h-.002c-.275 0-.521-.171-.605-.424-.203-.607-.133-.513-.669-.885-.169-.118-.265-.304-.265-.497l.031-.19c.207-.604.208-.488 0-1.094l-.031-.191c0-.193.096-.379.265-.497.536-.372.465-.277.669-.885.084-.253.33-.424.605-.424h.002c.662.002.544.041 1.083-.338.112-.08.244-.119.376-.119s.264.039.376.118c.534.376.419.34 1.083.338h.002c.275 0 .521.171.605.424.203.607.132.513.67.885.168.118.264.304.264.497l-.031.191c-.207.604-.208.488 0 1.094zm-1.469-1.198l-.465-.464-1.41 1.446-.66-.627-.465.464 1.125 1.091 1.875-1.91zm4.5 4.651h-12v1h12v-1zm-1 2h-10v1h10v-1zm1 2h-12v1h12v-1zm1-15h-19v20h24v-20h-5zm3 15.422c-1.151.504-2.074 1.427-2.578 2.578h-14.844c-.504-1.151-1.427-2.074-2.578-2.578v-10.844c1.151-.504 2.074-1.427 2.578-2.578h14.844c.504 1.151 1.427 2.074 2.578 2.578v10.844z"})),$y("strong",{dangerouslySetInnerHTML:{__html:e.label}}))))):"",r.length?$y("div",{className:"my_achievements_wrapper"},b?$y(By,{course:b,close:()=>k(!1),remove:()=>{let e=[...r];e.splice(e.findIndex(e=>e.id==b.id),1),l(e)}}):$y(Wy,null,$y("h3",null,window.wplms_course_data.translations.my_courses),$y("div",{class:"mycourses_header vibebp_form"},$y("div",null,$y("div",{class:"vibebp_form_field"},$y("input",{type:"text",value:c.s,onChange:e=>{d({...c,s:e.target.value})},placeholder:window.wplms_course_data.translations.search_courses}),$y("span",{className:"vicon vicon-search"}))),$y("select",{onChange:e=>{d({...c,orderby:e.target.value})},value:c.orderby},Object.keys(window.wplms_course_data.orderby).map(e=>$y("option",{value:e},window.wplms_course_data.orderby[e])))),$y("div",{className:"course_blocks"},r.map(e=>$y("div",{className:"finished_course",onClick:()=>k(e)},$y("img",{src:e.img}),$y("div",{className:"finished_course_content"},$y("h3",null,e.title,$y(w,{type:"user",id:{user_id:e.instructor}})),$y("div",{className:"course_meta"},e.certificate?$y("span",{className:"course_certificate"},$y("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},$y("path",{d:"M14.969 13.547l.031.191c0 .193-.096.379-.264.496-.538.372-.467.278-.67.885-.084.253-.33.424-.605.424h-.002c-.664-.002-.549-.038-1.083.338-.112.08-.244.119-.376.119s-.264-.039-.376-.118c-.534-.376-.419-.34-1.083-.338h-.002c-.275 0-.521-.171-.605-.424-.203-.607-.133-.513-.669-.885-.169-.118-.265-.304-.265-.497l.031-.19c.207-.604.208-.488 0-1.094l-.031-.191c0-.193.096-.379.265-.497.536-.372.466-.277.669-.885.084-.253.33-.424.605-.424h.002c.662.002.544.041 1.083-.338.112-.08.244-.119.376-.119s.264.039.376.118c.534.376.419.34 1.083.338h.002c.275 0 .521.171.605.424.203.607.132.513.67.885.168.118.264.304.264.497l-.031.191c-.207.604-.208.488 0 1.094zm-1.469-1.198l-.465-.464-1.41 1.446-.66-.627-.465.464 1.125 1.091 1.875-1.91zm8.5-4.349v14h-20v-14h20zm2-2h-24v18h24v-18zm-5 11h-14v1h14v-1zm0 2h-14v1h14v-1zm-7-19c-.828 0-1.5.671-1.5 1.5s.672 1.5 1.5 1.5 1.5-.671 1.5-1.5-.672-1.5-1.5-1.5zm-4.74 5l2.771-1.979c-.206-.267-.36-.574-.446-.91l-4.045 2.889h1.72zm11.2 0l-4.044-2.889c-.086.336-.24.643-.446.91l2.77 1.979h1.72z"}))):"",$y("div",{className:"course_grade "+e.grade.key},$y(fi,{size:"xs",progress:e.grade.value}),$y("span",{className:"grade "+e.grade.key},$y("span",null,e.grade.value,"%"),e.grade.label?$y("span",null,e.grade.label):"")),e.badge?$y("span",{className:"course_badge"},$y("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},$y("path",{d:"M11.25 9.541l-2.25-2.182.929-.929 1.321 1.253 2.821-2.892.929.93-3.75 3.82zm7.676-3.819c-.482 1.41-.484 1.139 0 2.555.05.147.074.297.074.445 0 .449-.222.883-.615 1.156-1.256.87-1.09.651-1.562 2.067-.198.591-.77.99-1.415.99h-.003c-1.549-.005-1.28-.088-2.528.789-.262.184-.569.276-.877.276s-.615-.092-.876-.275c-1.249-.878-.98-.794-2.528-.789h-.004c-.645 0-1.216-.399-1.413-.99-.473-1.417-.311-1.198-1.562-2.067-.395-.274-.617-.708-.617-1.157 0-.148.024-.298.074-.444.483-1.411.484-1.139 0-2.555-.05-.147-.074-.297-.074-.445 0-.45.222-.883.616-1.157 1.251-.868 1.089-.648 1.562-2.067.197-.591.769-.99 1.413-.99h.004c1.545.005 1.271.095 2.528-.79.262-.183.569-.274.877-.274s.615.091.876.274c1.248.878.98.795 2.528.79h.003c.646 0 1.217.399 1.415.99.473 1.416.307 1.197 1.562 2.067.394.273.616.707.616 1.156 0 .148-.024.299-.074.445zm-2.176 1.278c0-2.623-2.127-4.75-4.75-4.75s-4.75 2.127-4.75 4.75 2.127 4.75 4.75 4.75 4.75-2.128 4.75-4.75zm-7.385 7.931c-.766 0-1.371-.074-1.873-.213-.308 3.068-1.359 5.37-3.492 7.592.854.107 1.95-.094 2.833-.56.317.636.65 1.43.767 2.25 2.009-2.299 3.266-5.054 3.734-8.071-.943-.181-1.234-.496-1.969-.998zm5.27 0c-.737.507-1.043.82-1.968.998.47 3.017 1.726 5.772 3.733 8.071.116-.82.449-1.614.767-2.25.883.465 1.979.667 2.833.56-2.13-2.219-3.168-4.531-3.479-7.595-.503.141-1.112.216-1.886.216z"}))):""))))))):$y("div",{className:"vbp_message"},window.wplms_course_data.translations.no_finished_courses))};const{createElement:Gy,useState:Zy,useEffect:eb,Fragment:tb,render:ab}=wp.element,{dispatch:sb,select:nb}=wp.data;var ib=e=>{const[t,a]=Zy(!1),[s,n]=Zy([]),[i,o]=Zy({s:"",orderby:"",order:"",paged:1,per_page:12,quiz_status:"attempted"}),[r,l]=Zy(""),[c,d]=Zy(!1),[u,m]=Zy(!0),[p,v]=Zy("view"),[h,w]=Zy(!1),[f,g]=Zy(0);let y=nb("vibebp").getUser(),b=nb("vibebp").getToken();const[k,x]=Zy(null);return _(()=>{a(!0),k&&k.abort();let e={},t=new AbortController;k&&(e={signal:t.signal}),x(t),fetch(window.wplms_course_data.api_url+"/student/quiz",{method:"POST",...e,body:JSON.stringify({...i,token:b})}).then(e=>e.json()).then(e=>{if(a(!1),x(null),e.status){if(c){let t=[...s];e.hasOwnProperty("quizzes")&&e.quizzes&&e.quizzes.length&&(e.quizzes.map((e,a)=>{t.push(e)}),n(t)),t.length<e.total&&m(!0)}else Array.isArray(e.quizzes)?(n(e.quizzes),e.quizzes.length<e.total&&m(!0)):c||n([]);e.hasOwnProperty("assigned_quizzes")&&g(e.assigned_quizzes)}else l(e.message)}).catch(e=>{"AbortError"===e.name?console.log("Fetch aborted"):console.error("Uh oh, an error!",e)})},500,[i]),Gy("div",{className:"wplms_manage_quizzes_wrapper"},h?Gy("div",{className:"quiz_wrapper"},Gy("div",{className:"quiz_header"},Gy("span",{className:"header_links"},Gy("span",{className:"vicon vicon-arrow-left",onClick:()=>{w(!1)}})),Gy("h2",{dangerouslySetInnerHTML:{__html:h.title}}),Gy("div",{className:"quiz_info"},Gy("div",null,Gy("span",null,Gy("span",{className:"vicon vicon-calendar"}),Gy(Ct,{timestamp:h.attempted_date})),Gy("div",{className:"wplms_quiz-type"},h["quiz-type"].length?h["quiz-type"].map(e=>Gy("span",null,e)):"")),Gy("div",null,Gy("span",null,Gy("span",{className:"vicon vicon-cup"})," ",h.marks," / ",h.max),(()=>{if(y.hasOwnProperty("caps"))switch(window.wplms_course_data.course.stats_visibility){case 0:case 1:return!0;case 2:return!(!y.caps.hasOwnProperty("edit_posts")||!y.caps.edit_posts);case 3:return!(!y.caps.hasOwnProperty("manage_options")||!y.caps.manage_options);default:return!1}})()?Gy("div",{className:"myquiz_tabs buttons has-addons small"},Gy("a",{className:"view"==p?"is-focused button":"button",onClick:()=>{v("view")}},Gy("span",{className:"vicon vicon-eye"})),Gy("a",{className:"stats"==p?"is-focused button":"button",onClick:()=>{v("stats")}},Gy("span",{className:"vicon vicon-clipboard"}))):""))),"view"==p?Gy(pl,{quizid:h.id,update:()=>{}}):"stats"==p?Gy(Lw,{cpt:"quiz",id:h.id,nodownload:1}):""):Gy(tb,null,Gy("div",{className:"mycourses_header vibebp_form"},Gy("div",null,window.wplms_course_data.enable_assign_quiz?Gy("div",{className:"vibebp_form_field quizzes_tabs"},Gy("a",{onClick:e=>{o({...i,quiz_status:"attempted",paged:1}),m(!0)},className:"attempted"==i.quiz_status?"active button is-primary":"link"},window.wplms_course_data.translations.attempted),Gy("a",{onClick:e=>{o({...i,quiz_status:"assigned",paged:1}),m(!0)},className:"assigned"==i.quiz_status?"active button is-primary":"link"},window.wplms_course_data.translations.assigned,Gy("span",{className:"count"},f))):"",Gy("div",{className:"vibebp_form_field"},Gy("input",{type:"text",placeholder:window.vibebp.translations.search_text,value:i.s,onChange:e=>{o({...i,s:e.target.value})}}),Gy("span",{className:"vicon vicon-search"}))),Gy("select",{value:i.orderby,onChange:e=>{o({...i,orderby:e.target.value})}},Gy("option",null,window.vibebp.translations.select_option),Object.keys(window.wplms_course_data.orderby).map(e=>Gy("option",{value:e},window.wplms_course_data.orderby[e])))),t?Gy(tl,null):s.length?Gy(tb,null,t?Gy(tl,null):Gy("div",{className:"vibebp_quizzes"},s.map(e=>Gy("div",{className:"wplms_quiz",onClick:()=>w(e)},Gy("div",null,Gy("h3",{dangerouslySetInnerHTML:{__html:e.title}}),Gy("span",null,Gy(Ct,{timestamp:e.attempted_date})),Gy("div",{className:"wplms_quiz-type"},e["quiz-type"].length?e["quiz-type"].map(e=>Gy("span",null,e)):"")),Gy("div",{className:"quiz_meta"},Gy("span",null,Gy("span",{className:"vicon vicon-time"})," ",e.count),Gy("span",null,Gy("span",{className:"vicon vicon-medall-alt"})," ",e.marks," /",e.max)))),u?Gy("a",{className:"link",onClick:()=>{d(!0),m(!1),o({...i,paged:i.paged+1})}},window.wplms_course_data.translations.load_more):"")):r.length?Gy("div",{className:"vbp_message"},r):""))};const{createElement:ob,useState:rb,useEffect:lb,Fragment:cb,render:db}=wp.element,{dispatch:ub,select:mb}=wp.data;var pb=e=>{const[t,a]=rb(!1),[s,n]=rb([]),[i,o]=rb({s:"",orderby:"",order:"",page:"",per_page:12}),[r,l]=rb(""),[c,d]=rb(!1),[u,m]=rb(!1),[p,v]=rb(!1);mb("vibebp").getUser();let h=mb("vibebp").getToken();const[w,f]=rb(null);_(()=>{a(!0),w&&w.abort();let e={},t=new AbortController;w&&(e={signal:t.signal}),f(t),fetch(window.wplms_course_data.api_url+"/student/assignments",{method:"post",...e,body:JSON.stringify({...i,token:h})}).then(e=>e.json()).then(e=>{if(a(!1),f(!1),e.status)if(c){let t=[...s,...e.assignments];n(t),d(!1),t.length<e.total?m(!0):m(!1)}else e.hasOwnProperty("assignments")&&e.assignments.length?(n(e.assignments),e.assignments.length<e.total?m(!0):m(!1)):l(e.message);else e.hasOwnProperty("message")&&ub("vibebp").addNotification({text:e.message})}).catch(e=>{"AbortError"===e.name?a(!0):console.error("Uh oh, an error!",e)})},500,[i]);return ob("div",{className:"wplms_manage_quizzes_wrapper"},t?ob(tl,null):p?ob("div",{className:"quiz_wrapper"},ob("div",{className:"quiz_header"},ob("span",{className:"header_links"},ob("span",{className:"vicon vicon-arrow-left",onClick:()=>{v(!1)}})),ob("h2",null,p.title),ob("div",{className:"quiz_info"},ob("div",null,ob("span",null,ob("span",{className:"vicon vicon-calendar"}),ob(Ct,{timestamp:p.attempted_date})),ob("div",{className:"wplms_quiz-type"},p["assignment-type"].length?p["assignment-type"].map(e=>ob("span",null,e)):"")),ob("div",null,ob("span",null,ob("span",{className:"vicon vicon-cup"})," ",p.marks," / ",p.max)))),ob($l,{assignment:p,update:()=>{}})):s.length?ob(cb,null,ob("div",{className:"mycourses_header vibebp_form"},ob("div",null,ob("div",{className:"vibebp_form_field"},ob("input",{type:"text",placeholder:window.vibebp.translations.search_text,value:i.s,onChange:e=>{o({...i,s:e.target.value})}}),ob("span",{className:"vicon vicon-search"}))),ob("select",{value:i.orderby,onChange:e=>{o({...i,orderby:e.target.value})}},ob("option",null,window.vibebp.translations.select_option),Object.keys(window.wplms_course_data.orderby).map(e=>ob("option",{value:e},window.wplms_course_data.orderby[e])))),ob("div",{className:"vibebp_quizzes"},s.map(e=>ob("div",{className:"wplms_quiz",onClick:()=>v(e)},ob("div",null,ob("h3",null,e.title),ob("span",null,e.attempted_date),ob("div",{className:"wplms_quiz-type"},e["assignment-type"].length?e["assignment-type"].map(e=>ob("span",null,e)):"")),ob("div",{className:"quiz_meta"},ob("span",null,ob("span",{className:"vicon vicon-time"})," ",e.count),ob("span",null,ob("span",{className:"vicon vicon-medall-alt"})," ",e.marks," /",e.max)))),u?ob("a",{className:"link",onClick:()=>{setPagination(!0),o({...i,page:i.paged+1})}},window.wplms_course_data.translations.load_more):"")):r.length?ob("div",{className:"vbp_message"},r):"")};a(20);const{createElement:_b,useState:vb,useEffect:hb,Fragment:wb,render:fb}=wp.element,{dispatch:gb,select:yb}=wp.data,bb=e=>{const[t,a]=vb(!1),[s,n]=vb([]),[i,o]=vb([]),[r,l]=vb(!1),[c,d]=vb(!1),u=yb("vibebp").getUser();hb(()=>{let e=yb("vibebp").getMenu().filter(e=>"course"===e.parent),t=yb("vibebp").getAction();if(l(t||e[0].css_id),"on"==window.wplms_course_data.instructor_see_student_controls&&u.caps.hasOwnProperty(window.wplms_course_data.instructor)){let t=[];e.map((e,a)=>{e.user_has_access&&e.user_has_access==window.wplms_course_data.instructor&&t.push(e)}),l("manage_courses"),e=t}e.map((a,s)=>{if(t){let a=e.findIndex(e=>e.css_id==t);a>-1&&-1==e[a].class.indexOf("current-menu-item")&&e[a].class.push("current-menu-item")}else-1==e[0].class.indexOf("current-menu-item")&&e[0].class.push("current-menu-item")}),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar"),n(e)},[]);return _b("div",{className:"vibebp_sidebars"},_b("div",{className:"vibebp_left_sidebar_wrapper"},_b("div",{className:"vibebp_left_sidebar"},_b("h3",null,window.wplms_course_data.translations.course),Array.isArray(u.caps)&&u.caps.indexOf(window.wplms_course_data.instructor)>-1||"object"==typeof u.caps&&u.caps.hasOwnProperty(window.wplms_course_data.instructor)?_b("a",{className:"button is-primary new_mail",onClick:()=>{d(!c)}},c?_b(wb,null,_b("span",{className:"vicon vicon-arrow-left"})," ",window.wplms_course_data.translations.back):window.wplms_course_data.translations.create_course):"",s.map((e,t)=>{let a=e.class.join(" ")+" "+e.css_id;if(!(t>s.findIndex(e=>"instructor_controls"==e.css_id))||Array.isArray(u.caps)&&u.caps.indexOf(window.wplms_course_data.instructor)>-1||"object"==typeof u.caps&&u.caps.hasOwnProperty(window.wplms_course_data.instructor))return"instructor_controls"==e.css_id?Array.isArray(u.caps)&&u.caps.indexOf(window.wplms_course_data.instructor)>-1||"object"==typeof u.caps&&u.caps.hasOwnProperty(window.wplms_course_data.instructor)?_b("strong",{className:a},e.name):"":_b("a",{className:a,onClick:a=>{let r={...i};r.filter=e.css_id,r.page=1,i.css_id!==r.filter&&(r.post__in="",o(r)),l(e.css_id),gb("vibebp").setAction(e.css_id);let c=[...s],d=c.findIndex(e=>e.class.indexOf("current-menu-item")>-1);if(c[d].class.splice(c[d].class.indexOf("current-menu-item"),1),-1==c[t].class.indexOf("current-menu-item")&&c[t].class.push("current-menu-item"),n(c),-1==e.css_id.indexOf(["manage_courses","manage_quizzes","manage_assignments","manage_reports","manage_students","course-stats","quiz_results","assignment_results","course"])){var u=new CustomEvent("wplms_profile_course_loaded");document.dispatchEvent(u)}},dangerouslySetInnerHTML:{__html:e.name}})}))),_b("div",{className:"vibebp_main"},c?_b(vm,{back:()=>{l("manage_courses"),d(!1)},update:(e,t)=>{"published"==t&&l("manage_courses")}}):"manage_courses"===r?_b(Jh,null):"manage_quizzes"===r?_b(ef,null):"manage_questions"===r?_b(uf,null):"manage_assignments"===r?_b(Of,null):"manage_students"===r?_b(Lf,null):"manage_reports"===r?_b(ig,null):"course-stats"===r?_b(Ky,null):"quiz_results"===r?_b(ib,null):"assignment_results"===r?_b(pb,null):"course"===r?_b(jy,null):"notes_reviews"===r?_b(j_,null):"qna"===r?_b(pg,null):_b("div",{className:r})))};document.addEventListener("component_loaded",e=>{"course"===e.detail.component&&setTimeout(()=>{fb(_b(bb,null),document.querySelector("#course_component"))},200)})}]);